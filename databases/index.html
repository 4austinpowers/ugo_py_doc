
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A Python documentation website.">
      
      
      
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.0">
    
    
      
        <title>Databases - ugo_py_doc</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8b42a75e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#ffc105">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700%7CUbuntu+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Ubuntu";--md-code-font-family:"Ubuntu Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="amber" data-md-color-accent="indigo">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sqlite3" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ugo_py_doc" class="md-header__button md-logo" aria-label="ugo_py_doc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 16 7.36-5.73L21 9l-9-7-9 7 1.63 1.27M12 18.54l-7.38-5.73L3 14.07l9 7 9-7-1.63-1.27L12 18.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ugo_py_doc
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Databases
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/ugoproto/ugo_py_doc.git/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ugo_py_doc
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ugo_py_doc" class="md-nav__button md-logo" aria-label="ugo_py_doc" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 16 7.36-5.73L21 9l-9-7-9 7 1.63 1.27M12 18.54l-7.38-5.73L3 14.07l9 7 9-7-1.63-1.27L12 18.54z"/></svg>

    </a>
    ugo_py_doc
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ugoproto/ugo_py_doc.git/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ugo_py_doc
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Basics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Basics" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Basics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../py_cs/" class="md-nav__link">
        Python Cheat Sheets
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Databases
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Databases
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sqlite3" class="md-nav__link">
    SQLite3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sqlite3-cli" class="md-nav__link">
    SQLite3 CLI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-database-gui-administration-and-management-tools" class="md-nav__link">
    SQL Database GUI, Administration, and Management Tools
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spreadsheet-data-and-sqlite" class="md-nav__link">
    Spreadsheet Data and SQLite
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#r-and-python-with-sql" class="md-nav__link">
    R and Python with SQL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-chinook-sqlite-sample-database" class="md-nav__link">
    The Chinook SQLite Sample Database
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-a-python-orm-peewee" class="md-nav__link">
    Using a Python ORM: peewee
  </a>
  
    <nav class="md-nav" aria-label="Using a Python ORM: peewee">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-peewee" class="md-nav__link">
    Install peewee
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-database-with-a-script" class="md-nav__link">
    Create a database with a script
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-read-update-and-delete-crud" class="md-nav__link">
    Create, read, update, and delete (CRUD)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-diary-app-a-case" class="md-nav__link">
    A diary app -- A Case
  </a>
  
    <nav class="md-nav" aria-label="A diary app -- A Case">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-diary-app-the-skeleton-empty-classes-and-functions" class="md-nav__link">
    A diary app -- The skeleton (empty classes and functions)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-diary-app-initialize" class="md-nav__link">
    A diary app -- Initialize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-diary-app-create-a-menu" class="md-nav__link">
    A diary app -- Create a menu
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-diary-app-data-entry" class="md-nav__link">
    A diary app -- Data entry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-diary-app-search-and-view-entries" class="md-nav__link">
    A diary app -- Search and view entries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-diary-app-delete-entries" class="md-nav__link">
    A diary app -- Delete entries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-diary-app-finalize-and-polish-up" class="md-nav__link">
    A diary app -- Finalize and polish up
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../datetime/" class="md-nav__link">
        Datetime
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../decorators/" class="md-nav__link">
        Decorators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exceptions/" class="md-nav__link">
        Exceptions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../freeze_the_code/" class="md-nav__link">
        Freeze the Code
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gedit_execute_highlighted_python_code/" class="md-nav__link">
        Gedit, Execute Highlighted Code
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python_nice_to_have/" class="md-nav__link">
        Python Nice to Have
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Scipy Stack
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Scipy Stack" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Scipy Stack
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jn_cs/" class="md-nav__link">
        Jupyter Notebook Cheat Sheets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scipy_cs/" class="md-nav__link">
        Scipy Stack Cheat Sheets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../eda_machine_learning_feature_engineering_and_kaggle/" class="md-nav__link">
        EDA, Machine Learning, Feature Engineering, and Kaggle
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exploratory_data_analysis/" class="md-nav__link">
        Exploratory Data Analysis (EDA)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../feature_selection_in_python/" class="md-nav__link">
        Feature Selection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../geospatial_data_in_python/" class="md-nav__link">
        Geospatial Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../importing_data_into_python/" class="md-nav__link">
        Importing Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../introduction_to_customer_segmentation_in_python/" class="md-nav__link">
        Introduction to Customer Segmentation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../intro_to_data_world_in_python/" class="md-nav__link">
        Introduction to data.world
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../overview_of_scikit_learn/" class="md-nav__link">
        Overview of scikit-learn
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python_and_excel/" class="md-nav__link">
        Python and Excel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scaling_centering_noise_with_knn_linear_regression_logit/" class="md-nav__link">
        Scaling, Centering, Noise with kNN, Linear Regression, Logit
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sentiment_analysis_with_twitter/" class="md-nav__link">
        Sentiment Analysis with Twitter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../time_series_analysis/" class="md-nav__link">
        Time Series Analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vectors_and_arrays_linear_algebra/" class="md-nav__link">
        Vectors and Arrays (Linear Algebra)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../viewing_3d_volumetric_data_with_matplotlib/" class="md-nav__link">
        Viewing 3D Volumetric Data with Matplotlib
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../write_idiomatic_pandas_code/" class="md-nav__link">
        Write Idiomatic Pandas Code
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Courses
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Courses" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Courses
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../apprenez_a_programmer_en_python/" class="md-nav__link">
        Apprenez à programmer en Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../automate_the_boring_stuff_with_python/" class="md-nav__link">
        Automate the Boring Stuff with Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../codecademy_python/" class="md-nav__link">
        Codecademy Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../learn_python_the_hard_way/" class="md-nav__link">
        Learn Python the Hard Way
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lpthw_python_code_snippets/" class="md-nav__link">
        LPTHW, Python Code Snippets
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Manuals
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Manuals" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Manuals
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../managing_your_biological_data_with_python/" class="md-nav__link">
        Managing Your Biological Data with Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python_for_education/" class="md-nav__link">
        Python for Education
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sqlite3" class="md-nav__link">
    SQLite3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sqlite3-cli" class="md-nav__link">
    SQLite3 CLI
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sql-database-gui-administration-and-management-tools" class="md-nav__link">
    SQL Database GUI, Administration, and Management Tools
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spreadsheet-data-and-sqlite" class="md-nav__link">
    Spreadsheet Data and SQLite
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#r-and-python-with-sql" class="md-nav__link">
    R and Python with SQL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-chinook-sqlite-sample-database" class="md-nav__link">
    The Chinook SQLite Sample Database
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-a-python-orm-peewee" class="md-nav__link">
    Using a Python ORM: peewee
  </a>
  
    <nav class="md-nav" aria-label="Using a Python ORM: peewee">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-peewee" class="md-nav__link">
    Install peewee
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-database-with-a-script" class="md-nav__link">
    Create a database with a script
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-read-update-and-delete-crud" class="md-nav__link">
    Create, read, update, and delete (CRUD)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-diary-app-a-case" class="md-nav__link">
    A diary app -- A Case
  </a>
  
    <nav class="md-nav" aria-label="A diary app -- A Case">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-diary-app-the-skeleton-empty-classes-and-functions" class="md-nav__link">
    A diary app -- The skeleton (empty classes and functions)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-diary-app-initialize" class="md-nav__link">
    A diary app -- Initialize
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-diary-app-create-a-menu" class="md-nav__link">
    A diary app -- Create a menu
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-diary-app-data-entry" class="md-nav__link">
    A diary app -- Data entry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-diary-app-search-and-view-entries" class="md-nav__link">
    A diary app -- Search and view entries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-diary-app-delete-entries" class="md-nav__link">
    A diary app -- Delete entries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-diary-app-finalize-and-polish-up" class="md-nav__link">
    A diary app -- Finalize and polish up
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ugoproto/ugo_py_doc.git/edit/master/docs/databases.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  <h1>Databases</h1>
                
                <p><strong>Foreword</strong></p>
<p>Notes. Python 3. Consult the <a href="http://docs.python-guide.org/en/latest/">Hitchicker&rsquo;s Guide to Python</a>.<br />
Although we work with SQLite, most concepts are applicable to MySQL and PostgreSQL.</p>
<hr />
<h2 id="sqlite3">SQLite3<a class="headerlink" href="#sqlite3" title="Permanent link">&para;</a></h2>
<p>Follow the tutorial on <a href="https://www.tutorialspoint.com">TutorialPoint</a>. Especially the <a href="https://www.tutorialspoint.com/sqlite/sqlite_quick_guide.htm">Quick Guide</a> for installation, basic commands, syntax, comments, SQL statement, data type, affinity type, boolean, date &amp; time, creating a database, a table, dropping a table, querying, operators, expressions, and clauses. Each topic has also a dedicated section such as unions, joins, truncated table, etc.</p>
<ul>
<li>Install.<ul>
<li>Download from the <a href="http://www.sqlite.org/download.html">SQLite website</a>.</li>
<li>Follow the Quick Guide (or find instruction online).</li>
<li>On Windows, databases are located on C:\sqlite.</li>
<li>On Linux, SQLite is in the root directory(/usr/lib/&hellip;), but databases can be stored in the Personal folder (or in a directory of choice; for example, in a new subdirectory under Documents).</li>
</ul>
</li>
</ul>
<h2 id="sqlite3-cli">SQLite3 CLI<a class="headerlink" href="#sqlite3-cli" title="Permanent link">&para;</a></h2>
<p><strong>Basics</strong></p>
<ul>
<li>In the shell/bash:<ul>
<li><code>sqlite3 test.db</code>, create a database/open the database (show the prompt); the database is located in SQLite&rsquo;s directory.</li>
</ul>
</li>
<li>Basic commands inside a database.<ul>
<li><code>.help</code>.</li>
<li><code>.databases</code>, show all databases.</li>
<li><code>create table first (a int, b string);</code>, create a table with two fields.</li>
<li><code>.schema</code>, show the last commands.</li>
<li><code>.tables</code>, show all tables in the database.</li>
<li><code>insert into first (a, b) values (1, "hello");</code>, load the table.</li>
<li><code>select * from first;</code>, extract all values from the table.</li>
<li><code>.quit</code> or <code>.exit</code>.</li>
<li><code>drop table first;</code>, delete a table (first).</li>
<li>Delete a database by deleting the database file in the directory.</li>
</ul>
</li>
<li>Intermediate commands.<ul>
<li><code>.mode insert</code>, change the view (insertions to build the database).</li>
<li><code>.dump</code>, dump data on screen.</li>
<li><code>.output .\Documents\sqlite3Files.sql</code>, create a folder in a file (Windows).</li>
<li><code>.output ./Documents/sqlite3Files.sql</code>, create a folder in a file (UNIX-based).<ul>
<li><code>.dump</code>, dump data into the above. VERY USEFUL for recreating a database/table.</li>
</ul>
</li>
<li><code>.output stdout</code>, to the screen.</li>
<li><code>.mode column</code>, change the view (flat table with fixed width).<br />
        - <code>.width 15 20</code>, define the width by column.<ul>
<li><code>.output ./Documents/sqlite3Files/table.sql</code>, prepare the dump.</li>
<li><code>select * from table;</code>, extract.</li>
<li><code>.output stdout</code>, dump the data.</li>
</ul>
</li>
<li><code>.mode line</code>, change the view (long list without commas).<ul>
<li>Idem.</li>
</ul>
</li>
<li><code>.mode html</code>, change the view (html formats ready to be dumbed).<ul>
<li><code>.output ./Documents/sqlite3Files/table.html</code>, prepare the dump.</li>
<li><code>select * from table;</code>, extract.</li>
<li><code>.output stdout</code>, dump the data.</li>
</ul>
</li>
<li><code>.mode tabs</code>, change the view (flat table separated by tabs).<ul>
<li><code>.output ./Documents/sqlite3Files/table.tsv</code>, prepare the dump.</li>
<li><code>select * from table;</code>, extract.</li>
<li><code>.output stdout</code>, dump the data.</li>
</ul>
</li>
<li><code>.mode csv</code>, change the view (flat table separated by commas or semi-colons).<ul>
<li><code>.separator ;</code>, change the separator.</li>
<li><code>.output ./Documents/sqlite3Files/table.csv</code>, prepare the dump.</li>
<li><code>select * from table;</code>, extract.</li>
<li><code>.output stdout</code>, dump the data.</li>
</ul>
</li>
<li><code>.mode tcs</code>, change the view (flat table with double-quotes).</li>
<li><code>.headers on</code>, show the headers.</li>
<li><code>.show</code>, show the (above) parameters (and change them).</li>
<li><code>.prompt 'sqlite3&gt; '</code>, change the prompt.</li>
<li><code>.read &lt;path&gt;</code>, repopulate the database with the above.</li>
</ul>
</li>
</ul>
<p><strong>Advanced</strong></p>
<p>There are plenty of resources about SQLite: books, online documents, online tutorials, etc. We can learn how to:</p>
<ul>
<li>Build a database, tables.</li>
<li>Query a database, create, alter, select, order by, limit, offset, update, delete, and other functions.</li>
<li>Joins and Triggers.</li>
<li>And more.</li>
</ul>
<h2 id="sql-database-gui-administration-and-management-tools">SQL Database GUI, Administration, and Management Tools<a class="headerlink" href="#sql-database-gui-administration-and-management-tools" title="Permanent link">&para;</a></h2>
<p>With database managers, we can create scripts to automate operations.</p>
<ul>
<li>SQLite is free, open source, and cross-platform.<ul>
<li>DB Browser for SQLite is free, for all OS.</li>
<li>Add-ons to browsers such as the SQLite Managers for Firefox.</li>
</ul>
</li>
<li>MySQL is free, open source, and cross-platform.<ul>
<li>MySQL Workbench is free, for all OS.<ul>
<li>Database Design &amp; Modeling, SQL Development (replacing MySQL Query Browser), and Database Administration (replacing MySQL Administrator). MySQL features: SQL editor, SQL code completion, SQL code formatter, SQL Syntax highlighting, server start/stop, server status/health, server logs, server/replication configuration, user management, session management, and much more.</li>
</ul>
</li>
<li>There are web-based managers.</li>
</ul>
</li>
<li>PostgreSQL is free, open source, also cross-platform.<ul>
<li>pgAdminIII.</li>
<li>There are web-based managers.</li>
</ul>
</li>
<li>SQL in general.<ul>
<li>DB Browser is free, for all OS.</li>
<li>phpMyAdmin is free, for all OS.</li>
<li>Toad is free, for Windows.</li>
<li>HeidiSQL is free, for Windows.</li>
<li>There are web-based managers.</li>
</ul>
</li>
</ul>
<h2 id="spreadsheet-data-and-sqlite">Spreadsheet Data and SQLite<a class="headerlink" href="#spreadsheet-data-and-sqlite" title="Permanent link">&para;</a></h2>
<p><strong>Import from the spreadsheet</strong></p>
<ul>
<li>Pull data from the spreadsheet into SQLite via an add-on or a database manager (automated procedure).</li>
<li>Or export data (save as) from the spreadsheet into a .csv file.</li>
<li>Import the .csv into SQLite.<ul>
<li>In can be done with a manager such as DB Browser for SQLite.</li>
<li>It can be done with a web-based manager such as SQLite Managers for Firefox.</li>
<li>Adjust the general and field parameters.</li>
<li>Create a primary key.</li>
<li>Populate a table with the .csv file.</li>
</ul>
</li>
</ul>
<p><strong>Import into a spreadsheet</strong></p>
<ul>
<li>Dump the data from the CLI or a database manager into a .csv file.</li>
<li>Or connect the spreadsheet with SQLite with built-in functionalities or add-ons to pull data into the database.</li>
<li>There are add-ons that can execute SQL queries in a cell and dump the results in other cells: Excellic, Microsoft SQL Server Data Mining, SaveToDB, Database Connection Wizard, Publish Wizard, etc.</li>
</ul>
<h2 id="r-and-python-with-sql">R and Python with SQL<a class="headerlink" href="#r-and-python-with-sql" title="Permanent link">&para;</a></h2>
<ul>
<li>R can import data from / export data to relational databases using specialized packages such as <code>DBI</code>, <code>RSQLite</code>, <code>RMySQL</code>, <code>RPostgreSQL</code>, etc.</li>
<li>Python libraries are: <code>python-sql</code>, <code>sqlalchemy</code>, <code>records</code>, <code>peewee</code>, etc.<ul>
<li><code>pip install &lt;library&gt;</code>.    </li>
</ul>
</li>
</ul>
<h2 id="the-chinook-sqlite-sample-database">The Chinook SQLite Sample Database<a class="headerlink" href="#the-chinook-sqlite-sample-database" title="Permanent link">&para;</a></h2>
<p>Learn, practice, and test commands with a fake database. </p>
<ul>
<li>Download the <a href="http://chinookdatabase.codeplex.com/">database</a>.</li>
<li>Consult the <a href="SQLite Sample Database
http://www.sqlitetutorial.net/sqlite-sample-database/">diagram</a>.<ul>
<li>We can also download the database and diagrams.</li>
</ul>
</li>
</ul>
<h2 id="using-a-python-orm-peewee">Using a Python ORM: <code>peewee</code><a class="headerlink" href="#using-a-python-orm-peewee" title="Permanent link">&para;</a></h2>
<h3 id="install-peewee">Install <code>peewee</code><a class="headerlink" href="#install-peewee" title="Permanent link">&para;</a></h3>
<p>We can run queries with SQL or use a Python wrapper: <code>peewee</code>. It is a lightweight Object Relational Mapper (ORM). <code>peewee</code> works with SQLite, MySQL, and PostgreSQL.</p>
<p>Install it with pip.</p>
<p>We can manage our databases with Python scripts.</p>
<h3 id="create-a-database-with-a-script">Create a database with a script<a class="headerlink" href="#create-a-database-with-a-script" title="Permanent link">&para;</a></h3>
<p>In <code>peewee</code>, models are Python classes. Everything in the database is an object: tables, rows, columns, entries, etc.</p>
<p>We create a new database, <code>students.db</code>, with Python. We connect to the database and create two fields with their SQL parameters. We run the script in the terminal.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">peewee</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s1">&#39;C:\sqlite\students.db&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Student</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span> <span class="c1"># use a singular name convention</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># varchar, unique value, no duplicates</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">IntegerField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># if not supplies, it inputs 0 by default</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span> <span class="c1"># a class inside a class (meta-class)</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">db</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span> <span class="c1"># for running the script directly, not import it</span>
    <span class="n">db</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">db</span><span class="o">.</span><span class="n">create_tables</span><span class="p">([</span><span class="n">Student</span><span class="p">],</span> <span class="n">safe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># safe is a mandatory convention</span>
</code></pre></div>
<p>We get no result in the terminal: a good sign. Check out the database to see the results.</p>
<p>The script runs on Windows in Python 2. In Python 3, we would need minor adjustments; they are documented along the way. In addition, in UNIX-based OS, we would need two extra lines at the top of the script.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
</code></pre></div>
<p>Or.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python 3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
</code></pre></div>
<h3 id="create-read-update-and-delete-crud">Create, read, update, and delete (CRUD)<a class="headerlink" href="#create-read-update-and-delete-crud" title="Permanent link">&para;</a></h3>
<p>Create, read, update, and delete is knows as CRUD; the backbone of ORM. Five useful methods:</p>
<ul>
<li><code>.create()</code>, add a new record to the table.</li>
<li><code>.select()</code>, pick rows out of the table.</li>
<li><code>.save()</code>, update an existing row in a table.</li>
<li><code>.get()</code>, fetch a single record from a table.</li>
<li><code>.delete_instance()</code>, delete a row from a table.</li>
</ul>
<p>Improve the script, but avoid the false start&hellip;</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">peewee</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s1">&#39;C:\sqlite\students.db&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Student</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">IntegerField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">db</span>


<span class="c1"># ADD a dictionary</span>
<span class="n">students</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;kennethliff&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">4888</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;chalkers&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">11912</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;joykesten2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">7363</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;craigsrob&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">4079</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;adammcfarland&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">14717</span><span class="p">}</span>
<span class="p">]</span>


<span class="k">def</span> <span class="nf">add_students</span><span class="p">():</span> <span class="c1"># ADD a function</span>
    <span class="k">for</span> <span class="n">student</span> <span class="ow">in</span> <span class="n">students</span><span class="p">:</span>
        <span class="n">Student</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">student</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">],</span>
                        <span class="n">points</span><span class="o">=</span><span class="n">student</span><span class="p">[</span><span class="s1">&#39;points&#39;</span><span class="p">])</span> 


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">db</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">db</span><span class="o">.</span><span class="n">create_tables</span><span class="p">([</span><span class="n">Student</span><span class="p">],</span> <span class="n">safe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">add_students</span><span class="p">()</span> <span class="c1"># ADD</span>
</code></pre></div>
<p>We can run the script once, but not twice because of the <code>unique=True</code> in the <code>class Student(Model):</code>. We get an <code>IntegrityError</code> in the terminal. </p>
<p>We need to add a <code>try</code> block. Take two.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">peewee</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s1">&#39;C:\sqlite\students.db&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Student</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">IntegerField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">db</span>


<span class="n">students</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;kennethliff&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">4888</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;chalkers&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">11912</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;joykesten2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">7363</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;craigsrob&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">4079</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;adammcfarland&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">14717</span><span class="p">}</span>
<span class="p">]</span>


<span class="k">def</span> <span class="nf">add_students</span><span class="p">():</span> <span class="c1"># CHANGE the function</span>
    <span class="k">for</span> <span class="n">student</span> <span class="ow">in</span> <span class="n">students</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Student</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">student</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">],</span>
                            <span class="n">points</span><span class="o">=</span><span class="n">student</span><span class="p">[</span><span class="s1">&#39;points&#39;</span><span class="p">])</span>
        <span class="k">except</span> <span class="n">IntegrityError</span><span class="p">:</span>
            <span class="n">student_record</span> <span class="o">=</span> <span class="n">Student</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">student</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">])</span>
            <span class="n">student_record</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="n">student</span><span class="p">[</span><span class="s1">&#39;points&#39;</span><span class="p">]</span>
            <span class="n">student_record</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">db</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">db</span><span class="o">.</span><span class="n">create_tables</span><span class="p">([</span><span class="n">Student</span><span class="p">],</span> <span class="n">safe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">add_students</span><span class="p">()</span>
</code></pre></div>
<p>We get no result in the terminal: a good sign. We can run the script at will. We can check out the results in the database.</p>
<p>Add a function to select the top students, order them in descending order (from high to low), and retrieve them.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">peewee</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s1">&#39;C:\sqlite\students.db&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Student</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">IntegerField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">db</span>


<span class="n">students</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;kennethliff&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">4888</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;chalkers&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">11912</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;joykesten2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">7363</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;craigsrob&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">4079</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;adammcfarland&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">14717</span><span class="p">}</span>
<span class="p">]</span>


<span class="k">def</span> <span class="nf">add_students</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">student</span> <span class="ow">in</span> <span class="n">students</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Student</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">student</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">],</span>
                            <span class="n">points</span><span class="o">=</span><span class="n">student</span><span class="p">[</span><span class="s1">&#39;points&#39;</span><span class="p">])</span>
        <span class="k">except</span> <span class="n">IntegrityError</span><span class="p">:</span>
            <span class="n">student_record</span> <span class="o">=</span> <span class="n">Student</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">student</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">])</span>
            <span class="n">student_record</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="n">student</span><span class="p">[</span><span class="s1">&#39;points&#39;</span><span class="p">]</span>
            <span class="n">student_record</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">top_student</span><span class="p">():</span>
    <span class="n">student</span> <span class="o">=</span> <span class="n">Student</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">Student</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="c1"># ADD</span>
    <span class="k">return</span> <span class="n">student</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">db</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">db</span><span class="o">.</span><span class="n">create_tables</span><span class="p">([</span><span class="n">Student</span><span class="p">],</span> <span class="n">safe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">add_students</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Our top student right now is: </span><span class="si">{0.username}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">top_student</span><span class="p">()))</span> <span class="c1"># ADD</span>
</code></pre></div>
<p>This time, we should get a result in the terminal.</p>
<div class="highlight"><pre><span></span><code>Our top student right now is: adammcfarland.
</code></pre></div>
<p>Change the points in the dictionary and rerun the script.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">peewee</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s1">&#39;C:\sqlite\students.db&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Student</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">IntegerField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">db</span>


<span class="n">students</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;kennethliff&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">14718</span><span class="p">},</span> <span class="c1"># CHANGE, make it the top student</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;chalkers&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">11912</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;joykesten2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">7363</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;craigsrob&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">4079</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;adammcfarland&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="mi">14717</span><span class="p">}</span>
<span class="p">]</span>


<span class="k">def</span> <span class="nf">add_students</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">student</span> <span class="ow">in</span> <span class="n">students</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Student</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">student</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">],</span>
                            <span class="n">points</span><span class="o">=</span><span class="n">student</span><span class="p">[</span><span class="s1">&#39;points&#39;</span><span class="p">])</span>
        <span class="k">except</span> <span class="n">IntegrityError</span><span class="p">:</span>
            <span class="n">student_record</span> <span class="o">=</span> <span class="n">Student</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">student</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">])</span>
            <span class="n">student_record</span><span class="o">.</span><span class="n">points</span> <span class="o">=</span> <span class="n">student</span><span class="p">[</span><span class="s1">&#39;points&#39;</span><span class="p">]</span>
            <span class="n">student_record</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">top_student</span><span class="p">():</span>
    <span class="n">student</span> <span class="o">=</span> <span class="n">Student</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">Student</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">student</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">db</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">db</span><span class="o">.</span><span class="n">create_tables</span><span class="p">([</span><span class="n">Student</span><span class="p">],</span> <span class="n">safe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">add_students</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Our top student right now is: </span><span class="si">{0.username}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">top_student</span><span class="p">()))</span>
</code></pre></div>
<p>Results in the terminal.</p>
<div class="highlight"><pre><span></span><code>Our top student right now is: kennethliff.
</code></pre></div>
<p><strong>Recap:</strong></p>
<ul>
<li><code>.create()</code>, add a new record to the table.</li>
<li><code>.select()</code>, pick rows out of the table.</li>
<li><code>.get()</code>, fetch a single record from a table.</li>
</ul>
<h2 id="a-diary-app-a-case">A diary app &ndash; A Case<a class="headerlink" href="#a-diary-app-a-case" title="Permanent link">&para;</a></h2>
<h3 id="a-diary-app-the-skeleton-empty-classes-and-functions">A diary app &ndash; The skeleton (empty classes and functions)<a class="headerlink" href="#a-diary-app-the-skeleton-empty-classes-and-functions" title="Permanent link">&para;</a></h3>
<p>Now, let&rsquo;s build a diary application using an SQLite database. Such an application can be integrated into a web framework (like Flask) or frozen as an executive file (embedding SQLite). </p>
<p>We want to be able to load data and retrieve them. </p>
<p>The more general use could be a log book: we can write stuff and retrieve it. We can classify the entries and search for a specific word.</p>
<p>We start with a skeleton, bare functions and docstrings.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">peewee</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s1">&#39;C:\sqlite\diary.db&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="c1"># content</span>
    <span class="c1"># timestamp</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">db</span>


<span class="k">def</span> <span class="nf">menu_loop</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Show the menu.&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">add_entry</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Add an entry.&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">view_entries</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;View previous entries.&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">delete_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Delete an entry.&quot;&quot;&quot;</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span> <span class="c1"># for running the script directly, not import it</span>
    <span class="n">menu_loop</span><span class="p">()</span>
</code></pre></div>
<h3 id="a-diary-app-initialize">A diary app &ndash; Initialize<a class="headerlink" href="#a-diary-app-initialize" title="Permanent link">&para;</a></h3>
<p>Let&rsquo;s add some flesh to the skeleton. Add the the <code>datetime</code> library and a new function to initialize the diary.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">datetime</span> <span class="c1"># ADD</span>
<span class="kn">from</span> <span class="nn">peewee</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s1">&#39;C:\sqlite\diary.db&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span> <span class="c1"># CHANGE</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">TextField</span><span class="p">()</span> <span class="c1"># content: TextField ia more flexible, holds any type of data; contrary to CharField, a varchar with a maximum length</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">DateTimeField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">)</span> <span class="c1"># timestamp; now does take parentheses</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">db</span>


<span class="k">def</span> <span class="nf">initialize</span><span class="p">():</span> <span class="c1"># ADD</span>
    <span class="sd">&quot;&quot;&quot;Create the database and the table if they don&#39;t exist.&quot;&quot;&quot;</span>
    <span class="n">db</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">db</span><span class="o">.</span><span class="n">create_tables</span><span class="p">([</span><span class="n">Entry</span><span class="p">],</span> <span class="n">safe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">menu_loop</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Show the menu.&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">add_entry</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Add an entry.&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">view_entries</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;View previous entries.&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">delete_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Delete an entry.&quot;&quot;&quot;</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span> <span class="c1"># for running the script directly, not import it</span>
    <span class="n">initialize</span><span class="p">()</span> <span class="c1"># INSERT</span>
    <span class="n">menu_loop</span><span class="p">()</span>
</code></pre></div>
<p>We get no result in the terminal: a good sign. We can check out the results in the db.</p>
<h3 id="a-diary-app-create-a-menu">A diary app &ndash; Create a menu<a class="headerlink" href="#a-diary-app-create-a-menu" title="Permanent link">&para;</a></h3>
<p>We add a menu using a dictionary (we need the <code>OrderedDict</code> library).</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span> <span class="c1"># ADD</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">peewee</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s1">&#39;C:\sqlite\diary.db&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">TextField</span><span class="p">()</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">DateTimeField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">db</span>


<span class="k">def</span> <span class="nf">initialize</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Create the database and the table if they don&#39;t exist.&quot;&quot;&quot;</span>
    <span class="n">db</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">db</span><span class="o">.</span><span class="n">create_tables</span><span class="p">([</span><span class="n">Entry</span><span class="p">],</span> <span class="n">safe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">menu_loop</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Show the menu.&quot;&quot;&quot;</span>
    <span class="n">choice</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># new variable with a default value</span>

    <span class="k">while</span> <span class="n">choice</span> <span class="o">!=</span> <span class="s1">&#39;q&#39;</span><span class="p">:</span> <span class="c1"># ADD</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enter &#39;q&#39; to quit.&quot;</span><span class="p">)</span> <span class="c1"># starting message</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">menu</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> <span class="c1"># loop through the dictionary</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">) </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">))</span> <span class="c1"># value from the menu variables furthur down in the script; __doc__ is the docstrings</span>
        <span class="n">choice</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;Action: &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="c1"># lowercase, remove white spaces</span>

        <span class="k">if</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">menu</span><span class="p">:</span> <span class="c1"># check if the selection is in the menu</span>
            <span class="n">menu</span><span class="p">[</span><span class="n">choice</span><span class="p">]()</span> <span class="c1"># execute the choice</span>

<span class="k">def</span> <span class="nf">add_entry</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Add an entry.&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">view_entries</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;View previous entries.&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">delete_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Delete an entry.&quot;&quot;&quot;</span>


<span class="n">menu</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([</span> <span class="c1"># ADD tuple</span>
    <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">add_entry</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">view_entries</span><span class="p">),</span>
<span class="p">])</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">initialize</span><span class="p">()</span>
    <span class="n">menu_loop</span><span class="p">()</span>
</code></pre></div>
<p>This is coded in Python 2. In Python 3, we would replace <code>raw_input</code> by <code>input</code>.</p>
<p>The result is dynamic. We can input data in the terminal and the script continues to run until we quit with <code>q</code>. We cannot do much since the functions are still empty (<code>def add_entry():</code> and <code>def view_entries():</code>). The following is a snapshot.</p>
<div class="highlight"><pre><span></span><code>Enter &#39;q&#39; to quit.
a) Add an entry.
v) View previous entries.
Actions:
</code></pre></div>
<h3 id="a-diary-app-data-entry">A diary app &ndash; Data entry<a class="headerlink" href="#a-diary-app-data-entry" title="Permanent link">&para;</a></h3>
<p>Add the <code>sys</code> library. We want to enter data and load the database.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">sys</span> <span class="c1"># ADD</span>
<span class="kn">from</span> <span class="nn">peewee</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s1">&#39;C:\sqlite\diary.db&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">TextField</span><span class="p">()</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">DateTimeField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">db</span>


<span class="k">def</span> <span class="nf">initialize</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Create the database and the table if they don&#39;t exist.&quot;&quot;&quot;</span>
    <span class="n">db</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">db</span><span class="o">.</span><span class="n">create_tables</span><span class="p">([</span><span class="n">Entry</span><span class="p">],</span> <span class="n">safe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">menu_loop</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Show the menu.&quot;&quot;&quot;</span>
    <span class="n">choice</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">while</span> <span class="n">choice</span> <span class="o">!=</span> <span class="s1">&#39;q&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enter &#39;q&#39; to quit.&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">menu</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">) </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">))</span>
        <span class="n">choice</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;Action: &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">menu</span><span class="p">:</span>
            <span class="n">menu</span><span class="p">[</span><span class="n">choice</span><span class="p">]()</span>


<span class="k">def</span> <span class="nf">add_entry</span><span class="p">():</span> <span class="c1"># IMPROVE</span>
    <span class="sd">&quot;&quot;&quot;Add an entry.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enter your entry. Press ctrl+z when finished.&quot;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;Save entry? [Yn] &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
            <span class="n">Entry</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saved successfully!&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">view_entries</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;View previous entries.&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">delete_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Delete an entry.&quot;&quot;&quot;</span>


<span class="n">menu</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">add_entry</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">view_entries</span><span class="p">),</span>
<span class="p">])</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">initialize</span><span class="p">()</span>
    <span class="n">menu_loop</span><span class="p">()</span>
</code></pre></div>
<p>The result is dynamic.</p>
<p>To the question <code>Enter your entry. Press ctrl+d when finished.</code>, write <code>Working with databases. I enjoy my day.</code>. Press enter, then press ctrl+z, then enter in Windows, ctrl+d in UNIX-based OS (for End-of-File key sequence). Save it (with a <code>y</code> input). Repeat. This time, do not save it (<code>n</code>). Check out the results in the database.</p>
<p><code>raw_input</code> in Python 2 vs. <code>input</code> in Python 3. In Python 2, we can print with <code>print " "</code> or <code>print(" ")</code>. The later is only possible in Python 3.</p>
<h3 id="a-diary-app-search-and-view-entries">A diary app &ndash; Search and view entries<a class="headerlink" href="#a-diary-app-search-and-view-entries" title="Permanent link">&para;</a></h3>
<p>We now want to read the data (query the database). We also want to search throught the entries. In SQL, we would code: <code>SELECT * FROM entry WHERE content LIKE '%search_query$' ORDER BY timestamp DESC;</code>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">peewee</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s1">&#39;C:\sqlite\diary.db&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">TextField</span><span class="p">()</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">DateTimeField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">db</span>


<span class="k">def</span> <span class="nf">initialize</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Create the database and the table if they don&#39;t exist.&quot;&quot;&quot;</span>
    <span class="n">db</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">db</span><span class="o">.</span><span class="n">create_tables</span><span class="p">([</span><span class="n">Entry</span><span class="p">],</span> <span class="n">safe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">menu_loop</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Show the menu.&quot;&quot;&quot;</span>
    <span class="n">choice</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">while</span> <span class="n">choice</span> <span class="o">!=</span> <span class="s1">&#39;q&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enter &#39;q&#39; to quit.&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">menu</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">) </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">))</span>
        <span class="n">choice</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;Action: &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">menu</span><span class="p">:</span>
            <span class="n">menu</span><span class="p">[</span><span class="n">choice</span><span class="p">]()</span>


<span class="k">def</span> <span class="nf">add_entry</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Add an entry.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enter your entry. Press ctrl+z when finished.&quot;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;Save entry? [Yn] &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
            <span class="n">Entry</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saved successfully!&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">view_entries</span><span class="p">(</span><span class="n">search_query</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span> <span class="c1"># IMPROVE</span>
    <span class="sd">&quot;&quot;&quot;View previous entries.&quot;&quot;&quot;</span>
    <span class="n">entries</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">Entry</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span> <span class="c1"># sort them</span>
    <span class="k">if</span> <span class="n">search_query</span><span class="p">:</span>
        <span class="n">entries</span> <span class="o">=</span> <span class="n">entries</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Entry</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">search_query</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%A %B </span><span class="si">%d</span><span class="s1">, %Y %I:%M%p&#39;</span><span class="p">)</span> <span class="c1"># day name, month, date, year, hour (12h), minute, am/pm</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">timestamp</span><span class="p">))</span> <span class="c1"># print the number of characters in the timestamp</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n) next entry&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;q) return to main menu&#39;</span><span class="p">)</span>

        <span class="n">next_action</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;Action: [Nq] &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">next_action</span> <span class="o">==</span> <span class="s1">&#39;q&#39;</span><span class="p">:</span>
            <span class="k">break</span>


<span class="k">def</span> <span class="nf">search_entries</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Search entries for a string.&quot;&quot;&quot;</span>
    <span class="n">view_entries</span><span class="p">(</span><span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;Search query: &#39;</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">delete_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Delete an entry.&quot;&quot;&quot;</span>


<span class="n">menu</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">add_entry</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">view_entries</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">search_entries</span><span class="p">),</span> <span class="c1"># ADD</span>
<span class="p">])</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">initialize</span><span class="p">()</span>
    <span class="n">menu_loop</span><span class="p">()</span>
</code></pre></div>
<p>The result is dynamic. Try entering stuff, save it. Back to the menu, read the entry. We should get a date, a line of <code>=</code> and the entry. Quit and go back to the menu. Try search for a word. It should find a single word among all the entry and pull out the entry where the word appears.</p>
<h3 id="a-diary-app-delete-entries">A diary app &ndash; Delete entries<a class="headerlink" href="#a-diary-app-delete-entries" title="Permanent link">&para;</a></h3>
<p>Complete the last function: <code>def delete_entry(entry):</code>.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">peewee</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s1">&#39;C:\sqlite\diary.db&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">TextField</span><span class="p">()</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">DateTimeField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">db</span>


<span class="k">def</span> <span class="nf">initialize</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Create the database and the table if they don&#39;t exist.&quot;&quot;&quot;</span>
    <span class="n">db</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">db</span><span class="o">.</span><span class="n">create_tables</span><span class="p">([</span><span class="n">Entry</span><span class="p">],</span> <span class="n">safe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">menu_loop</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Show the menu.&quot;&quot;&quot;</span>
    <span class="n">choice</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">while</span> <span class="n">choice</span> <span class="o">!=</span> <span class="s1">&#39;q&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enter &#39;q&#39; to quit.&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">menu</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">) </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">))</span>
        <span class="n">choice</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;Action: &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">menu</span><span class="p">:</span>
            <span class="n">menu</span><span class="p">[</span><span class="n">choice</span><span class="p">]()</span>


<span class="k">def</span> <span class="nf">add_entry</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Add an entry.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enter your entry. Press ctrl+z when finished.&quot;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;Save entry? [Yn] &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
            <span class="n">Entry</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saved successfully!&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">view_entries</span><span class="p">(</span><span class="n">search_query</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;View previous entries.&quot;&quot;&quot;</span>
    <span class="n">entries</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">Entry</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">search_query</span><span class="p">:</span>
        <span class="n">entries</span> <span class="o">=</span> <span class="n">entries</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Entry</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">search_query</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%A %B </span><span class="si">%d</span><span class="s1">, %Y %I:%M%p&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">timestamp</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n) next entry&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;d) delete entry&#39;</span><span class="p">)</span> <span class="c1"># ADD</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;q) return to main menu&#39;</span><span class="p">)</span>

        <span class="n">next_action</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;Action: [Ndq] &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">next_action</span> <span class="o">==</span> <span class="s1">&#39;q&#39;</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="n">next_action</span> <span class="o">==</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="c1"># ADD</span>
            <span class="n">delete_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">search_entries</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Search entries for a string.&quot;&quot;&quot;</span>
    <span class="n">view_entries</span><span class="p">(</span><span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;Search query: &#39;</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">delete_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span> <span class="c1"># IMPROVE</span>
    <span class="sd">&quot;&quot;&quot;Delete an entry.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">raw_input</span><span class="p">(</span><span class="s2">&quot;Are you sure? [yN] &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
        <span class="n">entry</span><span class="o">.</span><span class="n">delete_instance</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Entry deleted!&quot;</span><span class="p">)</span>


<span class="n">menu</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">add_entry</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">view_entries</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">search_entries</span><span class="p">),</span>
<span class="p">])</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">initialize</span><span class="p">()</span>
    <span class="n">menu_loop</span><span class="p">()</span>
</code></pre></div>
<p>The result is dynamic. Enter something. Save it. View it. Delete it (the last entry). Confirm it. Go back to the main menu. View the previous entries. The last entry was deleted and we see the previous entry.</p>
<h3 id="a-diary-app-finalize-and-polish-up">A diary app &ndash; Finalize and polish up<a class="headerlink" href="#a-diary-app-finalize-and-polish-up" title="Permanent link">&para;</a></h3>
<p>We can polish up the final result. We need to ventilate the onscreen printouts by cleaning the screen here and there. On Windows, we clear the screen with <code>cls</code>; on UNIX-based OS, with <code>clear</code>.</p>
<p>Here is the final product. It&rsquo;s not perfect, but it works.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">os</span> <span class="c1"># ADD</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">peewee</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s1">&#39;C:\sqlite\diary.db&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">TextField</span><span class="p">()</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="n">DateTimeField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">db</span>


<span class="k">def</span> <span class="nf">initialize</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Create the database and the table if they don&#39;t exist.&quot;&quot;&quot;</span>
    <span class="n">db</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">db</span><span class="o">.</span><span class="n">create_tables</span><span class="p">([</span><span class="n">Entry</span><span class="p">],</span> <span class="n">safe</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">clear</span><span class="p">():</span> <span class="c1"># ADD</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;cls&#39;</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;nt&#39;</span> <span class="k">else</span> <span class="s1">&#39;clear&#39;</span><span class="p">)</span> <span class="c1"># ADD; cls for Windows, clear for Linux or Mac OS X</span>


<span class="k">def</span> <span class="nf">menu_loop</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Show the menu.&quot;&quot;&quot;</span>
    <span class="n">choice</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">while</span> <span class="n">choice</span> <span class="o">!=</span> <span class="s1">&#39;q&#39;</span><span class="p">:</span>
        <span class="n">clear</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enter &#39;q&#39; to quit.&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">menu</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">) </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">))</span>
        <span class="n">choice</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;Action: &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">menu</span><span class="p">:</span>
            <span class="n">clear</span><span class="p">()</span>
            <span class="n">menu</span><span class="p">[</span><span class="n">choice</span><span class="p">]()</span>


<span class="k">def</span> <span class="nf">add_entry</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Add an entry.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enter your entry. Press ctrl+z when finished.&quot;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;Save entry? [Yn] &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
            <span class="n">Entry</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saved successfully!&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">view_entries</span><span class="p">(</span><span class="n">search_query</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;View previous entries.&quot;&quot;&quot;</span>
    <span class="n">entries</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">Entry</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">desc</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">search_query</span><span class="p">:</span>
        <span class="n">entries</span> <span class="o">=</span> <span class="n">entries</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Entry</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">search_query</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">timestamp</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%A %B </span><span class="si">%d</span><span class="s1">, %Y %I:%M%p&#39;</span><span class="p">)</span>
        <span class="n">clear</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">timestamp</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">timestamp</span><span class="p">))</span> <span class="c1"># ADD</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n) next entry&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;d) delete entry&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;q) return to main menu&#39;</span><span class="p">)</span>

        <span class="n">next_action</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;Action: [Ndq] &#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">next_action</span> <span class="o">==</span> <span class="s1">&#39;q&#39;</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="n">next_action</span> <span class="o">==</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span>
            <span class="n">delete_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">search_entries</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Search entries for a string.&quot;&quot;&quot;</span>
    <span class="n">view_entries</span><span class="p">(</span><span class="n">raw_input</span><span class="p">(</span><span class="s1">&#39;Search query: &#39;</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">delete_entry</span><span class="p">(</span><span class="n">entry</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Delete an entry.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">raw_input</span><span class="p">(</span><span class="s2">&quot;Are you sure? [yN] &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
        <span class="n">entry</span><span class="o">.</span><span class="n">delete_instance</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Entry deleted!&quot;</span><span class="p">)</span>


<span class="n">menu</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">add_entry</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">view_entries</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">search_entries</span><span class="p">),</span>
<span class="p">])</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">initialize</span><span class="p">()</span>
    <span class="n">menu_loop</span><span class="p">()</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../py_cs/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Python Cheat Sheets" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Python Cheat Sheets
            </div>
          </div>
        </a>
      
      
        
        <a href="../datetime/" class="md-footer__link md-footer__link--next" aria-label="Next: Datetime" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Datetime
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.f8263e09.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.4fc53ad4.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>