



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A Python documentation website.">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.2">
    
    
      
        <title>Write Idiomatic Pandas Code - ugo_py_doc</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.30686662.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#ffa000">
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../extra.css">
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-93008985-2", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="amber" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#load-and-explore-the-data" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="ugo_py_doc" class="md-header-nav__button md-logo">
          
            <i class="md-icon">layers</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              ugo_py_doc
            </span>
            <span class="md-header-nav__topic">
              
                Write Idiomatic Pandas Code
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/ugoproto/ugo_py_doc.git/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ugo_py_doc
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="ugo_py_doc" class="md-nav__button md-logo">
      
        <i class="md-icon">layers</i>
      
    </a>
    ugo_py_doc
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/ugoproto/ugo_py_doc.git/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    ugo_py_doc
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Basics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Basics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../py_cs/" title="Python Cheat Sheets" class="md-nav__link">
      Python Cheat Sheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../databases/" title="Databases" class="md-nav__link">
      Databases
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../datetime/" title="Datetime" class="md-nav__link">
      Datetime
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../decorators/" title="Decorators" class="md-nav__link">
      Decorators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../exceptions/" title="Exceptions" class="md-nav__link">
      Exceptions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../freeze_the_code/" title="Freeze the Code" class="md-nav__link">
      Freeze the Code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../gedit_execute_highlighted_python_code/" title="Gedit, Execute Highlighted Code" class="md-nav__link">
      Gedit, Execute Highlighted Code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../python_nice_to_have/" title="Python Nice to Have" class="md-nav__link">
      Python Nice to Have
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Scipy Stack
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Scipy Stack
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../jn_cs/" title="Jupyter Notebook Cheat Sheets" class="md-nav__link">
      Jupyter Notebook Cheat Sheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scipy_cs/" title="Scipy Stack Cheat Sheets" class="md-nav__link">
      Scipy Stack Cheat Sheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eda_machine_learning_feature_engineering_and_kaggle/" title="EDA, Machine Learning, Feature Engineering, and Kaggle" class="md-nav__link">
      EDA, Machine Learning, Feature Engineering, and Kaggle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../exploratory_data_analysis/" title="Exploratory Data Analysis (EDA)" class="md-nav__link">
      Exploratory Data Analysis (EDA)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../feature_selection_in_python/" title="Feature Selection" class="md-nav__link">
      Feature Selection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../geospatial_data_in_python/" title="Geospatial Data" class="md-nav__link">
      Geospatial Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../importing_data_into_python/" title="Importing Data" class="md-nav__link">
      Importing Data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../introduction_to_customer_segmentation_in_python/" title="Introduction to Customer Segmentation" class="md-nav__link">
      Introduction to Customer Segmentation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../intro_to_data_world_in_python/" title="Introduction to data.world" class="md-nav__link">
      Introduction to data.world
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../overview_of_scikit_learn/" title="Overview of scikit-learn" class="md-nav__link">
      Overview of scikit-learn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../python_and_excel/" title="Python and Excel" class="md-nav__link">
      Python and Excel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../scaling_centering_noise_with_knn_linear_regression_logit/" title="Scaling, Centering, Noise with kNN, Linear Regression, Logit" class="md-nav__link">
      Scaling, Centering, Noise with kNN, Linear Regression, Logit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sentiment_analysis_with_twitter/" title="Sentiment Analysis with Twitter" class="md-nav__link">
      Sentiment Analysis with Twitter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../time_series_analysis/" title="Time Series Analysis" class="md-nav__link">
      Time Series Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../vectors_and_arrays_linear_algebra/" title="Vectors and Arrays (Linear Algebra)" class="md-nav__link">
      Vectors and Arrays (Linear Algebra)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../viewing_3d_volumetric_data_with_matplotlib/" title="Viewing 3D Volumetric Data with Matplotlib" class="md-nav__link">
      Viewing 3D Volumetric Data with Matplotlib
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Write Idiomatic Pandas Code
      </label>
    
    <a href="./" title="Write Idiomatic Pandas Code" class="md-nav__link md-nav__link--active">
      Write Idiomatic Pandas Code
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#load-and-explore-the-data" class="md-nav__link">
    Load and Explore the Data
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-data" class="md-nav__link">
    The Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quickly-inspecting-the-data" class="md-nav__link">
    Quickly Inspecting the Data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#index-and-pull-values" class="md-nav__link">
    Index and Pull Values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#method-chaining" class="md-nav__link">
    Method Chaining
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clean-the-data" class="md-nav__link">
    Clean the Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concatenate-into-a-single-dataframe" class="md-nav__link">
    Concatenate into a single DataFrame
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memory-optimization" class="md-nav__link">
    Memory Optimization
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cast-object-types" class="md-nav__link">
    Cast Object Types
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#replace-rank-subset-groupby" class="md-nav__link">
    Replace, Rank, Subset, groupby
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#replace" class="md-nav__link">
    Replace
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rank-subset-groupby" class="md-nav__link">
    Rank, Subset, groupby
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualization" class="md-nav__link">
    Visualization
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#matplotlib" class="md-nav__link">
    Matplotlib
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-values" class="md-nav__link">
    Remove values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaborn" class="md-nav__link">
    Seaborn
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter-rows" class="md-nav__link">
    Filter rows
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#correlation" class="md-nav__link">
    Correlation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to-go-beyond" class="md-nav__link">
    To go beyond
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Courses
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Courses
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../apprenez_a_programmer_en_python/" title="Apprenez à programmer en Python" class="md-nav__link">
      Apprenez à programmer en Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../automate_the_boring_stuff_with_python/" title="Automate the Boring Stuff with Python" class="md-nav__link">
      Automate the Boring Stuff with Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../codecademy_python/" title="Codecademy Python" class="md-nav__link">
      Codecademy Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../learn_python_the_hard_way/" title="Learn Python the Hard Way" class="md-nav__link">
      Learn Python the Hard Way
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lpthw_python_code_snippets/" title="LPTHW, Python Code Snippets" class="md-nav__link">
      LPTHW, Python Code Snippets
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Manuals
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Manuals
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../managing_your_biological_data_with_python/" title="Managing Your Biological Data with Python" class="md-nav__link">
      Managing Your Biological Data with Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../python_for_education/" title="Python for Education" class="md-nav__link">
      Python for Education
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#load-and-explore-the-data" class="md-nav__link">
    Load and Explore the Data
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-data" class="md-nav__link">
    The Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quickly-inspecting-the-data" class="md-nav__link">
    Quickly Inspecting the Data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#index-and-pull-values" class="md-nav__link">
    Index and Pull Values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#method-chaining" class="md-nav__link">
    Method Chaining
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clean-the-data" class="md-nav__link">
    Clean the Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concatenate-into-a-single-dataframe" class="md-nav__link">
    Concatenate into a single DataFrame
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#memory-optimization" class="md-nav__link">
    Memory Optimization
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cast-object-types" class="md-nav__link">
    Cast Object Types
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#replace-rank-subset-groupby" class="md-nav__link">
    Replace, Rank, Subset, groupby
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#replace" class="md-nav__link">
    Replace
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rank-subset-groupby" class="md-nav__link">
    Rank, Subset, groupby
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualization" class="md-nav__link">
    Visualization
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#matplotlib" class="md-nav__link">
    Matplotlib
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-values" class="md-nav__link">
    Remove values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaborn" class="md-nav__link">
    Seaborn
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter-rows" class="md-nav__link">
    Filter rows
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#correlation" class="md-nav__link">
    Correlation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#to-go-beyond" class="md-nav__link">
    To go beyond
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ugoproto/ugo_py_doc.git/edit/master/docs/write_idiomatic_pandas_code.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Write Idiomatic Pandas Code</h1>
                
                <p><strong>Foreword</strong></p>
<p>Code snippets and excerpts from the tutorial. Python 3. From DataCamp.</p>
<hr />
<h2 id="load-and-explore-the-data">Load and Explore the Data<a class="headerlink" href="#load-and-explore-the-data" title="Permanent link">&para;</a></h2>
<h3 id="the-data">The Data<a class="headerlink" href="#the-data" title="Permanent link">&para;</a></h3>
<p>The datasets are downloadable from <a href="https://www.kaggle.com/mylesoneill/world-university-rankings">Kaggle</a>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">%</span><span class="n">pylab</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="c1"># Import Times Higher Education World University Rankings data</span>
<span class="c1"># https://www.timeshighereducation.com/world-university-rankings</span>
<span class="n">times_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;timesData.csv&#39;</span><span class="p">,</span> <span class="n">thousands</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>

<span class="c1"># Import Academic Ranking of World Universities data</span>
<span class="c1"># http://www.shanghairanking.com/</span>
<span class="n">shanghai_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;shanghaiData.csv&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">Populating</span> <span class="n">the</span> <span class="n">interactive</span> <span class="n">namespace</span> <span class="k">from</span> <span class="n">numpy</span> <span class="k">and</span> <span class="n">matplotlib</span>
</pre></div>
</td></tr></table>

<h3 id="quickly-inspecting-the-data">Quickly Inspecting the Data<a class="headerlink" href="#quickly-inspecting-the-data" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Return the first rows of `times_df`</span>
<span class="n">times_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>world_rank</th>
      <th>university_name</th>
      <th>country</th>
      <th>teaching</th>
      <th>international</th>
      <th>research</th>
      <th>citations</th>
      <th>income</th>
      <th>total_score</th>
      <th>num_students</th>
      <th>student_staff_ratio</th>
      <th>international_students</th>
      <th>female_male_ratio</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Harvard University</td>
      <td>United States of America</td>
      <td>99.7</td>
      <td>72.4</td>
      <td>98.7</td>
      <td>98.8</td>
      <td>34.5</td>
      <td>96.1</td>
      <td>20152.0</td>
      <td>8.9</td>
      <td>25%</td>
      <td>NaN</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>California Institute of Technology</td>
      <td>United States of America</td>
      <td>97.7</td>
      <td>54.6</td>
      <td>98.0</td>
      <td>99.9</td>
      <td>83.7</td>
      <td>96.0</td>
      <td>2243.0</td>
      <td>6.9</td>
      <td>27%</td>
      <td>33 : 67</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Massachusetts Institute of Technology</td>
      <td>United States of America</td>
      <td>97.8</td>
      <td>82.3</td>
      <td>91.4</td>
      <td>99.9</td>
      <td>87.5</td>
      <td>95.6</td>
      <td>11074.0</td>
      <td>9.0</td>
      <td>33%</td>
      <td>37 : 63</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Stanford University</td>
      <td>United States of America</td>
      <td>98.3</td>
      <td>29.5</td>
      <td>98.1</td>
      <td>99.2</td>
      <td>64.3</td>
      <td>94.3</td>
      <td>15596.0</td>
      <td>7.8</td>
      <td>22%</td>
      <td>42 : 58</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Princeton University</td>
      <td>United States of America</td>
      <td>90.9</td>
      <td>70.3</td>
      <td>95.4</td>
      <td>99.9</td>
      <td>-</td>
      <td>94.2</td>
      <td>7929.0</td>
      <td>8.4</td>
      <td>27%</td>
      <td>45 : 55</td>
      <td>2011</td>
    </tr>
  </tbody>
</table>
</div>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Describe `times_df`</span>
<span class="n">times_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>teaching</th>
      <th>research</th>
      <th>citations</th>
      <th>num_students</th>
      <th>student_staff_ratio</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2603.000000</td>
      <td>2603.000000</td>
      <td>2603.000000</td>
      <td>2544.000000</td>
      <td>2544.000000</td>
      <td>2603.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>37.801498</td>
      <td>35.910257</td>
      <td>60.921629</td>
      <td>23873.758648</td>
      <td>18.445283</td>
      <td>2014.075682</td>
    </tr>
    <tr>
      <th>std</th>
      <td>17.604218</td>
      <td>21.254805</td>
      <td>23.073219</td>
      <td>17675.946877</td>
      <td>11.458698</td>
      <td>1.685733</td>
    </tr>
    <tr>
      <th>min</th>
      <td>9.900000</td>
      <td>2.900000</td>
      <td>1.200000</td>
      <td>462.000000</td>
      <td>0.600000</td>
      <td>2011.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>24.700000</td>
      <td>19.600000</td>
      <td>45.500000</td>
      <td>12637.750000</td>
      <td>11.975000</td>
      <td>2013.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>33.900000</td>
      <td>30.500000</td>
      <td>62.500000</td>
      <td>20851.000000</td>
      <td>16.100000</td>
      <td>2014.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>46.400000</td>
      <td>47.250000</td>
      <td>79.050000</td>
      <td>29991.000000</td>
      <td>21.500000</td>
      <td>2016.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>99.700000</td>
      <td>99.400000</td>
      <td>100.000000</td>
      <td>379231.000000</td>
      <td>162.600000</td>
      <td>2016.000000</td>
    </tr>
  </tbody>
</table>
</div>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Return the first rows of `shanghai_df`</span>
<span class="n">shanghai_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>world_rank</th>
      <th>university_name</th>
      <th>national_rank</th>
      <th>total_score</th>
      <th>alumni</th>
      <th>award</th>
      <th>hici</th>
      <th>ns</th>
      <th>pub</th>
      <th>pcp</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Harvard University</td>
      <td>1</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>72.4</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>University of Cambridge</td>
      <td>1</td>
      <td>73.6</td>
      <td>99.8</td>
      <td>93.4</td>
      <td>53.3</td>
      <td>56.6</td>
      <td>70.9</td>
      <td>66.9</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Stanford University</td>
      <td>2</td>
      <td>73.4</td>
      <td>41.1</td>
      <td>72.2</td>
      <td>88.5</td>
      <td>70.9</td>
      <td>72.3</td>
      <td>65.0</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>University of California, Berkeley</td>
      <td>3</td>
      <td>72.8</td>
      <td>71.8</td>
      <td>76.0</td>
      <td>69.4</td>
      <td>73.9</td>
      <td>72.2</td>
      <td>52.7</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Massachusetts Institute of Technology (MIT)</td>
      <td>4</td>
      <td>70.1</td>
      <td>74.0</td>
      <td>80.6</td>
      <td>66.7</td>
      <td>65.8</td>
      <td>64.3</td>
      <td>53.0</td>
      <td>2005</td>
    </tr>
  </tbody>
</table>
</div>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Describe `shanghai_df`</span>
<span class="n">shanghai_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_score</th>
      <th>alumni</th>
      <th>award</th>
      <th>hici</th>
      <th>ns</th>
      <th>pub</th>
      <th>pcp</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1101.000000</td>
      <td>4896.000000</td>
      <td>4895.00000</td>
      <td>4895.000000</td>
      <td>4875.000000</td>
      <td>4895.000000</td>
      <td>4895.000000</td>
      <td>4897.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>36.383470</td>
      <td>9.161724</td>
      <td>7.69191</td>
      <td>16.221491</td>
      <td>16.078503</td>
      <td>38.254648</td>
      <td>21.242329</td>
      <td>2009.658566</td>
    </tr>
    <tr>
      <th>std</th>
      <td>13.557186</td>
      <td>14.140636</td>
      <td>15.49411</td>
      <td>14.382710</td>
      <td>12.511529</td>
      <td>13.050809</td>
      <td>9.254351</td>
      <td>3.197576</td>
    </tr>
    <tr>
      <th>min</th>
      <td>23.500000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.300000</td>
      <td>8.300000</td>
      <td>2005.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>27.400000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>7.300000</td>
      <td>8.000000</td>
      <td>28.900000</td>
      <td>15.600000</td>
      <td>2007.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>31.300000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>12.600000</td>
      <td>12.800000</td>
      <td>36.000000</td>
      <td>19.000000</td>
      <td>2009.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>41.800000</td>
      <td>15.600000</td>
      <td>13.40000</td>
      <td>21.700000</td>
      <td>19.800000</td>
      <td>45.300000</td>
      <td>24.500000</td>
      <td>2012.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.00000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>2015.000000</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="index-and-pull-values">Index and Pull Values<a class="headerlink" href="#index-and-pull-values" title="Permanent link">&para;</a></h2>
<p><code class="codehilite"><span class="p">[]</span></code> for row numbers or column names, <code class="codehilite"><span class="n">loc</span><span class="p">[]</span></code>, <code class="codehilite"><span class="n">iloc</span><span class="p">[]</span></code>, <code class="codehilite"><span class="n">query</span></code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Retrieve the total score of the first row</span>
<span class="k">print</span><span class="p">(</span><span class="n">times_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;total_score&#39;</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">96</span><span class="p">.</span><span class="mi">1</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Retrieve rows 0 and 1</span>
<span class="k">print</span><span class="p">(</span><span class="n">times_df</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>  <span class="n">world_rank</span>                     <span class="n">university_name</span>                   <span class="n">country</span>  <span class="err">\</span>
<span class="mi">0</span>          <span class="mi">1</span>                  <span class="n">Harvard</span> <span class="n">University</span>  <span class="n">United</span> <span class="n">States</span> <span class="k">of</span> <span class="n">America</span>   
<span class="mi">1</span>          <span class="mi">2</span>  <span class="n">California</span> <span class="n">Institute</span> <span class="k">of</span> <span class="n">Technology</span>  <span class="n">United</span> <span class="n">States</span> <span class="k">of</span> <span class="n">America</span>

   <span class="n">teaching</span> <span class="n">international</span>  <span class="n">research</span>  <span class="n">citations</span> <span class="n">income</span> <span class="n">total_score</span>  <span class="err">\</span>
<span class="mi">0</span>      <span class="mi">99</span><span class="p">.</span><span class="mi">7</span>          <span class="mi">72</span><span class="p">.</span><span class="mi">4</span>      <span class="mi">98</span><span class="p">.</span><span class="mi">7</span>       <span class="mi">98</span><span class="p">.</span><span class="mi">8</span>   <span class="mi">34</span><span class="p">.</span><span class="mi">5</span>        <span class="mi">96</span><span class="p">.</span><span class="mi">1</span>   
<span class="mi">1</span>      <span class="mi">97</span><span class="p">.</span><span class="mi">7</span>          <span class="mi">54</span><span class="p">.</span><span class="mi">6</span>      <span class="mi">98</span><span class="p">.</span><span class="mi">0</span>       <span class="mi">99</span><span class="p">.</span><span class="mi">9</span>   <span class="mi">83</span><span class="p">.</span><span class="mi">7</span>        <span class="mi">96</span><span class="p">.</span><span class="mi">0</span>

   <span class="n">num_students</span>  <span class="n">student_staff_ratio</span> <span class="n">international_students</span> <span class="n">female_male_ratio</span>  <span class="err">\</span>
<span class="mi">0</span>       <span class="mi">20152</span><span class="p">.</span><span class="mi">0</span>                  <span class="mi">8</span><span class="p">.</span><span class="mi">9</span>                    <span class="mi">25</span><span class="o">%</span>               <span class="n">NaN</span>   
<span class="mi">1</span>        <span class="mi">2243</span><span class="p">.</span><span class="mi">0</span>                  <span class="mi">6</span><span class="p">.</span><span class="mi">9</span>                    <span class="mi">27</span><span class="o">%</span>           <span class="mi">33</span> <span class="p">:</span> <span class="mi">67</span>

   <span class="k">year</span>  
<span class="mi">0</span>  <span class="mi">2011</span>  
<span class="mi">1</span>  <span class="mi">2011</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Retrieve the values at columns and rows 1-3</span>
<span class="k">print</span><span class="p">(</span><span class="n">times_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>                         <span class="n">university_name</span>                   <span class="n">country</span>  <span class="n">teaching</span>
<span class="mi">1</span>     <span class="n">California</span> <span class="n">Institute</span> <span class="k">of</span> <span class="n">Technology</span>  <span class="n">United</span> <span class="n">States</span> <span class="k">of</span> <span class="n">America</span>      <span class="mi">97</span><span class="p">.</span><span class="mi">7</span>
<span class="mi">2</span>  <span class="n">Massachusetts</span> <span class="n">Institute</span> <span class="k">of</span> <span class="n">Technology</span>  <span class="n">United</span> <span class="n">States</span> <span class="k">of</span> <span class="n">America</span>      <span class="mi">97</span><span class="p">.</span><span class="mi">8</span>
<span class="mi">3</span>                    <span class="n">Stanford</span> <span class="n">University</span>  <span class="n">United</span> <span class="n">States</span> <span class="k">of</span> <span class="n">America</span>      <span class="mi">98</span><span class="p">.</span><span class="mi">3</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Retrieve the column `total_score` </span>
<span class="k">print</span><span class="p">(</span><span class="n">times_df</span><span class="p">[</span><span class="s1">&#39;total_score&#39;</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">0</span>       <span class="mi">96</span><span class="p">.</span><span class="mi">1</span>
<span class="mi">1</span>       <span class="mi">96</span><span class="p">.</span><span class="mi">0</span>
<span class="mi">2</span>       <span class="mi">95</span><span class="p">.</span><span class="mi">6</span>
<span class="mi">3</span>       <span class="mi">94</span><span class="p">.</span><span class="mi">3</span>
<span class="mi">4</span>       <span class="mi">94</span><span class="p">.</span><span class="mi">2</span>
<span class="mi">5</span>       <span class="mi">91</span><span class="p">.</span><span class="mi">2</span>
<span class="mi">6</span>       <span class="mi">91</span><span class="p">.</span><span class="mi">2</span>
<span class="mi">7</span>       <span class="mi">91</span><span class="p">.</span><span class="mi">1</span>
<span class="mi">8</span>       <span class="mi">90</span><span class="p">.</span><span class="mi">6</span>
<span class="mi">9</span>       <span class="mi">89</span><span class="p">.</span><span class="mi">5</span>
<span class="mi">10</span>      <span class="mi">87</span><span class="p">.</span><span class="mi">7</span>
<span class="mi">11</span>      <span class="mi">86</span><span class="p">.</span><span class="mi">9</span>
<span class="mi">12</span>      <span class="mi">86</span><span class="p">.</span><span class="mi">4</span>
<span class="mi">13</span>      <span class="mi">83</span><span class="p">.</span><span class="mi">9</span>
<span class="mi">14</span>      <span class="mi">83</span><span class="p">.</span><span class="mi">4</span>
<span class="mi">15</span>      <span class="mi">83</span><span class="p">.</span><span class="mi">4</span>
<span class="mi">16</span>      <span class="mi">82</span><span class="p">.</span><span class="mi">0</span>
<span class="mi">17</span>      <span class="mi">81</span><span class="p">.</span><span class="mi">0</span>
<span class="mi">18</span>      <span class="mi">79</span><span class="p">.</span><span class="mi">5</span>
<span class="mi">19</span>      <span class="mi">79</span><span class="p">.</span><span class="mi">3</span>
<span class="mi">20</span>      <span class="mi">79</span><span class="p">.</span><span class="mi">2</span>
<span class="mi">21</span>      <span class="mi">78</span><span class="p">.</span><span class="mi">4</span>
<span class="mi">22</span>      <span class="mi">78</span><span class="p">.</span><span class="mi">0</span>
<span class="mi">23</span>      <span class="mi">76</span><span class="p">.</span><span class="mi">5</span>
<span class="mi">24</span>      <span class="mi">75</span><span class="p">.</span><span class="mi">9</span>
<span class="mi">25</span>      <span class="mi">75</span><span class="p">.</span><span class="mi">6</span>
<span class="mi">26</span>      <span class="mi">75</span><span class="p">.</span><span class="mi">3</span>
<span class="mi">27</span>      <span class="mi">75</span><span class="p">.</span><span class="mi">1</span>
<span class="mi">28</span>      <span class="mi">75</span><span class="p">.</span><span class="mi">0</span>
<span class="mi">29</span>      <span class="mi">73</span><span class="p">.</span><span class="mi">8</span>
        <span class="p">...</span> 
<span class="mi">2573</span>       <span class="o">-</span>
<span class="mi">2574</span>       <span class="o">-</span>
<span class="mi">2575</span>       <span class="o">-</span>
<span class="mi">2576</span>       <span class="o">-</span>
<span class="mi">2577</span>       <span class="o">-</span>
<span class="mi">2578</span>       <span class="o">-</span>
<span class="mi">2579</span>       <span class="o">-</span>
<span class="mi">2580</span>       <span class="o">-</span>
<span class="mi">2581</span>       <span class="o">-</span>
<span class="mi">2582</span>       <span class="o">-</span>
<span class="mi">2583</span>       <span class="o">-</span>
<span class="mi">2584</span>       <span class="o">-</span>
<span class="mi">2585</span>       <span class="o">-</span>
<span class="mi">2586</span>       <span class="o">-</span>
<span class="mi">2587</span>       <span class="o">-</span>
<span class="mi">2588</span>       <span class="o">-</span>
<span class="mi">2589</span>       <span class="o">-</span>
<span class="mi">2590</span>       <span class="o">-</span>
<span class="mi">2591</span>       <span class="o">-</span>
<span class="mi">2592</span>       <span class="o">-</span>
<span class="mi">2593</span>       <span class="o">-</span>
<span class="mi">2594</span>       <span class="o">-</span>
<span class="mi">2595</span>       <span class="o">-</span>
<span class="mi">2596</span>       <span class="o">-</span>
<span class="mi">2597</span>       <span class="o">-</span>
<span class="mi">2598</span>       <span class="o">-</span>
<span class="mi">2599</span>       <span class="o">-</span>
<span class="mi">2600</span>       <span class="o">-</span>
<span class="mi">2601</span>       <span class="o">-</span>
<span class="mi">2602</span>       <span class="o">-</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">total_score</span><span class="p">,</span> <span class="k">Length</span><span class="p">:</span> <span class="mi">2603</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="k">object</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Are the last entries after 2006?</span>
<span class="k">print</span><span class="p">(</span><span class="n">shanghai_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2006</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">Series</span><span class="p">([],</span> <span class="n">Name</span><span class="p">:</span> <span class="k">year</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">bool</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Was the alumni count higher than 90 for the first ten universities?</span>
<span class="k">print</span><span class="p">(</span><span class="n">shanghai_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;alumni&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">90</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">0</span>      <span class="k">True</span>
<span class="mi">1</span>      <span class="k">True</span>
<span class="mi">2</span>     <span class="k">False</span>
<span class="mi">3</span>     <span class="k">False</span>
<span class="mi">4</span>     <span class="k">False</span>
<span class="mi">5</span>     <span class="k">False</span>
<span class="mi">6</span>     <span class="k">False</span>
<span class="mi">7</span>     <span class="k">False</span>
<span class="mi">8</span>     <span class="k">False</span>
<span class="mi">9</span>     <span class="k">False</span>
<span class="mi">10</span>    <span class="k">False</span>
<span class="mi">11</span>    <span class="k">False</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">alumni</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">bool</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Query `shanghai_df` for universities with total score between 40 and 50</span>
<span class="n">average_schools</span> <span class="o">=</span> <span class="n">shanghai_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;total_score &gt; 0 and total_score &lt; 50&#39;</span><span class="p">)</span>

<span class="c1"># Print the result</span>
<span class="k">print</span><span class="p">(</span><span class="n">average_schools</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>     <span class="n">world_rank</span>                                    <span class="n">university_name</span>  <span class="err">\</span>
<span class="mi">15</span>           <span class="mi">16</span>                  <span class="n">University</span> <span class="k">of</span> <span class="n">Wisconsin</span> <span class="o">-</span> <span class="n">Madison</span>   
<span class="mi">16</span>           <span class="mi">17</span>                           <span class="n">University</span> <span class="k">of</span> <span class="n">Washington</span>   
<span class="mi">17</span>           <span class="mi">18</span>            <span class="n">University</span> <span class="k">of</span> <span class="n">California</span><span class="p">,</span> <span class="n">San</span> <span class="n">Francisco</span>   
<span class="mi">18</span>           <span class="mi">19</span>                       <span class="n">The</span> <span class="n">Johns</span> <span class="n">Hopkins</span> <span class="n">University</span>   
<span class="mi">19</span>           <span class="mi">20</span>                            <span class="n">The</span> <span class="n">University</span> <span class="k">of</span> <span class="n">Tokyo</span>   
<span class="mi">20</span>           <span class="mi">21</span>                 <span class="n">University</span> <span class="k">of</span> <span class="n">Michigan</span> <span class="o">-</span> <span class="n">Ann</span> <span class="n">Arbor</span>   
<span class="mi">21</span>           <span class="mi">22</span>                                   <span class="n">Kyoto</span> <span class="n">University</span>   
<span class="mi">22</span>           <span class="mi">23</span>  <span class="n">The</span> <span class="n">Imperial</span> <span class="n">College</span> <span class="k">of</span> <span class="n">Science</span><span class="p">,</span> <span class="n">Technology</span> <span class="n">an</span><span class="p">...</span>   
<span class="mi">23</span>           <span class="mi">24</span>                              <span class="n">University</span> <span class="k">of</span> <span class="n">Toronto</span>   
<span class="mi">24</span>           <span class="mi">25</span>         <span class="n">University</span> <span class="k">of</span> <span class="n">Illinois</span> <span class="k">at</span> <span class="n">Urbana</span><span class="o">-</span><span class="n">Champaign</span>   
<span class="mi">25</span>           <span class="mi">26</span>                          <span class="n">University</span> <span class="n">College</span> <span class="n">London</span>   
<span class="mi">26</span>           <span class="mi">27</span>       <span class="n">Swiss</span> <span class="n">Federal</span> <span class="n">Institute</span> <span class="k">of</span> <span class="n">Technology</span> <span class="n">Zurich</span>   
<span class="mi">27</span>           <span class="mi">28</span>                 <span class="n">Washington</span> <span class="n">University</span> <span class="k">in</span> <span class="n">St</span><span class="p">.</span> <span class="n">Louis</span>   
<span class="mi">28</span>           <span class="mi">29</span>                                <span class="k">New</span> <span class="n">York</span> <span class="n">University</span>   
<span class="mi">29</span>           <span class="mi">30</span>                             <span class="n">Rockefeller</span> <span class="n">University</span>   
<span class="mi">30</span>           <span class="mi">31</span>                            <span class="n">Northwestern</span> <span class="n">University</span>   
<span class="mi">31</span>           <span class="mi">32</span>                                    <span class="n">Duke</span> <span class="n">University</span>   
<span class="mi">32</span>           <span class="mi">32</span>               <span class="n">University</span> <span class="k">of</span> <span class="n">Minnesota</span><span class="p">,</span> <span class="n">Twin</span> <span class="n">Cities</span>   
<span class="mi">33</span>           <span class="mi">34</span>            <span class="n">University</span> <span class="k">of</span> <span class="n">California</span><span class="p">,</span> <span class="n">Santa</span> <span class="n">Barbara</span>   
<span class="mi">34</span>           <span class="mi">35</span>                  <span class="n">University</span> <span class="k">of</span> <span class="n">Colorado</span> <span class="k">at</span> <span class="n">Boulder</span>   
<span class="mi">35</span>           <span class="mi">36</span>                  <span class="n">The</span> <span class="n">University</span> <span class="k">of</span> <span class="n">Texas</span> <span class="k">at</span> <span class="n">Austin</span>   
<span class="mi">36</span>           <span class="mi">37</span>                     <span class="n">University</span> <span class="k">of</span> <span class="n">British</span> <span class="n">Columbia</span>   
<span class="mi">37</span>           <span class="mi">38</span>  <span class="n">The</span> <span class="n">University</span> <span class="k">of</span> <span class="n">Texas</span> <span class="n">Southwestern</span> <span class="n">Medical</span> <span class="k">C</span><span class="p">...</span>   
<span class="mi">38</span>           <span class="mi">39</span>    <span class="n">Pennsylvania</span> <span class="k">State</span> <span class="n">University</span> <span class="o">-</span> <span class="n">University</span> <span class="n">Park</span>   
<span class="mi">39</span>           <span class="mi">39</span>                              <span class="n">Vanderbilt</span> <span class="n">University</span>   
<span class="mi">40</span>           <span class="mi">41</span>                    <span class="n">University</span> <span class="k">of</span> <span class="n">California</span><span class="p">,</span> <span class="n">Davis</span>   
<span class="mi">41</span>           <span class="mi">41</span>                                 <span class="n">Utrecht</span> <span class="n">University</span>   
<span class="mi">42</span>           <span class="mi">43</span>  <span class="n">Rutgers</span><span class="p">,</span> <span class="n">The</span> <span class="k">State</span> <span class="n">University</span> <span class="k">of</span> <span class="k">New</span> <span class="n">Jersey</span> <span class="o">-</span> <span class="p">...</span>   
<span class="mi">43</span>           <span class="mi">43</span>                           <span class="n">University</span> <span class="k">of</span> <span class="n">Pittsburgh</span>   
<span class="mi">44</span>           <span class="mi">45</span>                               <span class="n">Karolinska</span> <span class="n">Institute</span>   
<span class="p">...</span>         <span class="p">...</span>                                                <span class="p">...</span>   
<span class="mi">4467</span>         <span class="mi">71</span>                                   <span class="n">Ghent</span> <span class="n">University</span>   
<span class="mi">4468</span>         <span class="mi">72</span>                   <span class="n">Ecole</span> <span class="n">Normale</span> <span class="n">Superieure</span> <span class="o">-</span> <span class="n">Paris</span>   
<span class="mi">4469</span>         <span class="mi">73</span>                                  <span class="n">Aarhus</span> <span class="n">University</span>   
<span class="mi">4470</span>         <span class="mi">73</span>                                  <span class="n">Boston</span> <span class="n">University</span>   
<span class="mi">4471</span>         <span class="mi">75</span>                                   <span class="n">Brown</span> <span class="n">University</span>   
<span class="mi">4472</span>         <span class="mi">75</span>                            <span class="n">University</span> <span class="k">of</span> <span class="n">Groningen</span>   
<span class="mi">4473</span>         <span class="mi">77</span>                                  <span class="n">Nagoya</span> <span class="n">University</span>   
<span class="mi">4474</span>         <span class="mi">77</span>                               <span class="n">Stockholm</span> <span class="n">University</span>   
<span class="mi">4475</span>         <span class="mi">77</span>            <span class="n">Technion</span><span class="o">-</span><span class="n">Israel</span> <span class="n">Institute</span> <span class="k">of</span> <span class="n">Technology</span>   
<span class="mi">4476</span>         <span class="mi">77</span>                 <span class="n">The</span> <span class="n">Australian</span> <span class="k">National</span> <span class="n">University</span>   
<span class="mi">4477</span>         <span class="mi">77</span>                       <span class="n">The</span> <span class="n">University</span> <span class="k">of</span> <span class="n">Queensland</span>   
<span class="mi">4478</span>         <span class="mi">82</span>                                  <span class="n">Leiden</span> <span class="n">University</span>   
<span class="mi">4479</span>         <span class="mi">83</span>                              <span class="n">University</span> <span class="k">of</span> <span class="n">Florida</span>   
<span class="mi">4480</span>         <span class="mi">84</span>                                    <span class="n">Rice</span> <span class="n">University</span>   
<span class="mi">4481</span>         <span class="mi">85</span>                                   <span class="n">Osaka</span> <span class="n">University</span>   
<span class="mi">4482</span>         <span class="mi">86</span>                            <span class="n">Moscow</span> <span class="k">State</span> <span class="n">University</span>   
<span class="mi">4483</span>         <span class="mi">87</span>                <span class="n">The</span> <span class="n">University</span> <span class="k">of</span> <span class="n">Western</span> <span class="n">Australia</span>   
<span class="mi">4484</span>         <span class="mi">87</span>                                <span class="n">University</span> <span class="k">of</span> <span class="n">Basel</span>   
<span class="mi">4485</span>         <span class="mi">87</span>                           <span class="n">University</span> <span class="k">of</span> <span class="n">Strasbourg</span>   
<span class="mi">4486</span>         <span class="mi">90</span>                                          <span class="n">KU</span> <span class="n">Leuven</span>   
<span class="mi">4487</span>         <span class="mi">90</span>                              <span class="n">University</span> <span class="k">of</span> <span class="n">Arizona</span>   
<span class="mi">4488</span>         <span class="mi">92</span>                              <span class="n">University</span> <span class="k">of</span> <span class="n">Warwick</span>   
<span class="mi">4489</span>         <span class="mi">93</span>                           <span class="n">Arizona</span> <span class="k">State</span> <span class="n">University</span>   
<span class="mi">4490</span>         <span class="mi">93</span>               <span class="n">University</span> <span class="k">of</span> <span class="n">California</span><span class="p">,</span> <span class="n">Santa</span> <span class="n">Cruz</span>   
<span class="mi">4491</span>         <span class="mi">93</span>                                 <span class="n">University</span> <span class="k">of</span> <span class="n">Utah</span>   
<span class="mi">4492</span>         <span class="mi">96</span>                                <span class="n">McMaster</span> <span class="n">University</span>   
<span class="mi">4493</span>         <span class="mi">97</span>                                 <span class="n">University</span> <span class="k">of</span> <span class="n">Bonn</span>   
<span class="mi">4494</span>         <span class="mi">98</span>                            <span class="n">VU</span> <span class="n">University</span> <span class="n">Amsterdam</span>   
<span class="mi">4495</span>         <span class="mi">99</span>                          <span class="n">Michigan</span> <span class="k">State</span> <span class="n">University</span>   
<span class="mi">4496</span>        <span class="mi">100</span>                               <span class="n">Texas</span> <span class="n">A</span><span class="o">&amp;</span><span class="n">M</span> <span class="n">University</span>

     <span class="n">national_rank</span>  <span class="n">total_score</span>  <span class="n">alumni</span>  <span class="n">award</span>  <span class="n">hici</span>    <span class="n">ns</span>   <span class="n">pub</span>   <span class="n">pcp</span>  <span class="k">year</span>  
<span class="mi">15</span>              <span class="mi">14</span>         <span class="mi">49</span><span class="p">.</span><span class="mi">2</span>    <span class="mi">43</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">36</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">52</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">46</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">68</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">29</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">2005</span>  
<span class="mi">16</span>              <span class="mi">15</span>         <span class="mi">48</span><span class="p">.</span><span class="mi">4</span>    <span class="mi">28</span><span class="p">.</span><span class="mi">8</span>   <span class="mi">32</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">53</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">47</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">73</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">27</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">2005</span>  
<span class="mi">17</span>              <span class="mi">16</span>         <span class="mi">47</span><span class="p">.</span><span class="mi">8</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">37</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">55</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">57</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">58</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">45</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">2005</span>  
<span class="mi">18</span>              <span class="mi">17</span>         <span class="mi">46</span><span class="p">.</span><span class="mi">9</span>    <span class="mi">51</span><span class="p">.</span><span class="mi">4</span>   <span class="mi">28</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">41</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">52</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">67</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">24</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">2005</span>  
<span class="mi">19</span>               <span class="mi">1</span>         <span class="mi">46</span><span class="p">.</span><span class="mi">7</span>    <span class="mi">36</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">14</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">38</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">52</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">86</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">34</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">2005</span>  
<span class="mi">20</span>              <span class="mi">18</span>         <span class="mi">44</span><span class="p">.</span><span class="mi">9</span>    <span class="mi">43</span><span class="p">.</span><span class="mi">0</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">61</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">43</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">76</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">30</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">2005</span>  
<span class="mi">21</span>               <span class="mi">2</span>         <span class="mi">43</span><span class="p">.</span><span class="mi">8</span>    <span class="mi">39</span><span class="p">.</span><span class="mi">7</span>   <span class="mi">34</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">34</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">37</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">72</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">31</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">2005</span>  
<span class="mi">22</span>               <span class="mi">3</span>         <span class="mi">43</span><span class="p">.</span><span class="mi">7</span>    <span class="mi">20</span><span class="p">.</span><span class="mi">8</span>   <span class="mi">38</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">40</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">38</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">64</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">40</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">2005</span>  
<span class="mi">23</span>               <span class="mi">1</span>         <span class="mi">43</span><span class="p">.</span><span class="mi">1</span>    <span class="mi">28</span><span class="p">.</span><span class="mi">1</span>   <span class="mi">19</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">39</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">38</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">76</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">41</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">2005</span>  
<span class="mi">24</span>              <span class="mi">19</span>         <span class="mi">42</span><span class="p">.</span><span class="mi">8</span>    <span class="mi">41</span><span class="p">.</span><span class="mi">6</span>   <span class="mi">37</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">44</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">34</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">58</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">26</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">2005</span>  
<span class="mi">25</span>               <span class="mi">4</span>         <span class="mi">42</span><span class="p">.</span><span class="mi">6</span>    <span class="mi">30</span><span class="p">.</span><span class="mi">7</span>   <span class="mi">32</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">37</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">41</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">60</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">38</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">2005</span>  
<span class="mi">26</span>               <span class="mi">1</span>         <span class="mi">41</span><span class="p">.</span><span class="mi">7</span>    <span class="mi">40</span><span class="p">.</span><span class="mi">2</span>   <span class="mi">37</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">35</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">41</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">43</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">52</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">2005</span>  
<span class="mi">27</span>              <span class="mi">20</span>         <span class="mi">40</span><span class="p">.</span><span class="mi">7</span>    <span class="mi">25</span><span class="p">.</span><span class="mi">1</span>   <span class="mi">26</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">38</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">46</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">53</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">39</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">2005</span>  
<span class="mi">28</span>              <span class="mi">21</span>         <span class="mi">38</span><span class="p">.</span><span class="mi">8</span>    <span class="mi">33</span><span class="p">.</span><span class="mi">8</span>   <span class="mi">25</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">43</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">35</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">55</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">26</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">2005</span>  
<span class="mi">29</span>              <span class="mi">22</span>         <span class="mi">38</span><span class="p">.</span><span class="mi">2</span>    <span class="mi">22</span><span class="p">.</span><span class="mi">6</span>   <span class="mi">59</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">28</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">44</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">24</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">35</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">2005</span>  
<span class="mi">30</span>              <span class="mi">23</span>         <span class="mi">37</span><span class="p">.</span><span class="mi">9</span>    <span class="mi">21</span><span class="p">.</span><span class="mi">7</span>   <span class="mi">19</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">44</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">33</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">57</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">36</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">2005</span>  
<span class="mi">31</span>              <span class="mi">24</span>         <span class="mi">37</span><span class="p">.</span><span class="mi">7</span>    <span class="mi">20</span><span class="p">.</span><span class="mi">8</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">47</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">45</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">60</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">38</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">2005</span>  
<span class="mi">32</span>              <span class="mi">24</span>         <span class="mi">37</span><span class="p">.</span><span class="mi">7</span>    <span class="mi">36</span><span class="p">.</span><span class="mi">0</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">49</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">35</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">68</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">23</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">2005</span>  
<span class="mi">33</span>              <span class="mi">26</span>         <span class="mi">36</span><span class="p">.</span><span class="mi">9</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">36</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">42</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">39</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">44</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">35</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">2005</span>  
<span class="mi">34</span>              <span class="mi">27</span>         <span class="mi">36</span><span class="p">.</span><span class="mi">3</span>    <span class="mi">16</span><span class="p">.</span><span class="mi">6</span>   <span class="mi">29</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">40</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">36</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">46</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">29</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">2005</span>  
<span class="mi">35</span>              <span class="mi">28</span>         <span class="mi">35</span><span class="p">.</span><span class="mi">5</span>    <span class="mi">21</span><span class="p">.</span><span class="mi">7</span>   <span class="mi">17</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">49</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">30</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">54</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">21</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">2005</span>  
<span class="mi">36</span>               <span class="mi">2</span>         <span class="mi">35</span><span class="p">.</span><span class="mi">4</span>    <span class="mi">20</span><span class="p">.</span><span class="mi">8</span>   <span class="mi">19</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">32</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">32</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">60</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">33</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">2005</span>  
<span class="mi">37</span>              <span class="mi">29</span>         <span class="mi">34</span><span class="p">.</span><span class="mi">8</span>    <span class="mi">24</span><span class="p">.</span><span class="mi">3</span>   <span class="mi">33</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">31</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">38</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">37</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">31</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">2005</span>  
<span class="mi">38</span>              <span class="mi">30</span>         <span class="mi">33</span><span class="p">.</span><span class="mi">4</span>    <span class="mi">14</span><span class="p">.</span><span class="mi">0</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">45</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">37</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">59</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">24</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">2005</span>  
<span class="mi">39</span>              <span class="mi">30</span>         <span class="mi">33</span><span class="p">.</span><span class="mi">4</span>    <span class="mi">12</span><span class="p">.</span><span class="mi">5</span>   <span class="mi">30</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">34</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">24</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">49</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">35</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">2005</span>  
<span class="mi">40</span>              <span class="mi">32</span>         <span class="mi">32</span><span class="p">.</span><span class="mi">9</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">46</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">34</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">64</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">29</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">2005</span>  
<span class="mi">41</span>               <span class="mi">1</span>         <span class="mi">32</span><span class="p">.</span><span class="mi">9</span>    <span class="mi">30</span><span class="p">.</span><span class="mi">7</span>   <span class="mi">21</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">27</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">27</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">55</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">25</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">2005</span>  
<span class="mi">42</span>              <span class="mi">33</span>         <span class="mi">32</span><span class="p">.</span><span class="mi">3</span>    <span class="mi">15</span><span class="p">.</span><span class="mi">4</span>   <span class="mi">20</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">36</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">32</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">47</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">24</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">2005</span>  
<span class="mi">43</span>              <span class="mi">33</span>         <span class="mi">32</span><span class="p">.</span><span class="mi">3</span>    <span class="mi">25</span><span class="p">.</span><span class="mi">1</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">40</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">25</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">64</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">28</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">2005</span>  
<span class="mi">44</span>               <span class="mi">1</span>         <span class="mi">32</span><span class="p">.</span><span class="mi">1</span>    <span class="mi">30</span><span class="p">.</span><span class="mi">7</span>   <span class="mi">27</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">33</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">19</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">47</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">25</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">2005</span>  
<span class="p">...</span>            <span class="p">...</span>          <span class="p">...</span>     <span class="p">...</span>    <span class="p">...</span>   <span class="p">...</span>   <span class="p">...</span>   <span class="p">...</span>   <span class="p">...</span>   <span class="p">...</span>  
<span class="mi">4467</span>             <span class="mi">1</span>         <span class="mi">27</span><span class="p">.</span><span class="mi">8</span>     <span class="mi">5</span><span class="p">.</span><span class="mi">1</span>   <span class="mi">13</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">26</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">18</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">57</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">34</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">2015</span>  
<span class="mi">4468</span>             <span class="mi">3</span>         <span class="mi">27</span><span class="p">.</span><span class="mi">6</span>    <span class="mi">48</span><span class="p">.</span><span class="mi">9</span>   <span class="mi">28</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">6</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">19</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">26</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">60</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">2015</span>  
<span class="mi">4469</span>             <span class="mi">2</span>         <span class="mi">27</span><span class="p">.</span><span class="mi">3</span>    <span class="mi">11</span><span class="p">.</span><span class="mi">5</span>   <span class="mi">22</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">12</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">25</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">51</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">31</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">2015</span>  
<span class="mi">4470</span>            <span class="mi">42</span>         <span class="mi">27</span><span class="p">.</span><span class="mi">3</span>    <span class="mi">11</span><span class="p">.</span><span class="mi">5</span>   <span class="mi">11</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">29</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">26</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">49</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">21</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">2015</span>  
<span class="mi">4471</span>            <span class="mi">43</span>         <span class="mi">27</span><span class="p">.</span><span class="mi">0</span>    <span class="mi">14</span><span class="p">.</span><span class="mi">5</span>   <span class="mi">13</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">26</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">25</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">43</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">32</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">2015</span>  
<span class="mi">4472</span>             <span class="mi">2</span>         <span class="mi">27</span><span class="p">.</span><span class="mi">0</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">18</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">23</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">21</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">52</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">32</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">2015</span>  
<span class="mi">4473</span>             <span class="mi">3</span>         <span class="mi">26</span><span class="p">.</span><span class="mi">7</span>    <span class="mi">29</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">25</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">16</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">17</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">44</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">23</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">2015</span>  
<span class="mi">4474</span>             <span class="mi">3</span>         <span class="mi">26</span><span class="p">.</span><span class="mi">7</span>    <span class="mi">24</span><span class="p">.</span><span class="mi">1</span>   <span class="mi">27</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">18</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">19</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">40</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">25</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">2015</span>  
<span class="mi">4475</span>             <span class="mi">2</span>         <span class="mi">26</span><span class="p">.</span><span class="mi">7</span>    <span class="mi">23</span><span class="p">.</span><span class="mi">5</span>   <span class="mi">37</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">15</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">18</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">33</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">28</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">2015</span>  
<span class="mi">4476</span>             <span class="mi">2</span>         <span class="mi">26</span><span class="p">.</span><span class="mi">7</span>    <span class="mi">13</span><span class="p">.</span><span class="mi">6</span>   <span class="mi">19</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">24</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">20</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">45</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">29</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">2015</span>  
<span class="mi">4477</span>             <span class="mi">2</span>         <span class="mi">26</span><span class="p">.</span><span class="mi">7</span>    <span class="mi">12</span><span class="p">.</span><span class="mi">6</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">22</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">24</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">63</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">29</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">2015</span>  
<span class="mi">4478</span>             <span class="mi">3</span>         <span class="mi">26</span><span class="p">.</span><span class="mi">5</span>    <span class="mi">17</span><span class="p">.</span><span class="mi">8</span>    <span class="mi">9</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">25</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">22</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">46</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">32</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">2015</span>  
<span class="mi">4479</span>            <span class="mi">44</span>         <span class="mi">26</span><span class="p">.</span><span class="mi">2</span>    <span class="mi">17</span><span class="p">.</span><span class="mi">0</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">30</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">21</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">58</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">17</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">2015</span>  
<span class="mi">4480</span>            <span class="mi">45</span>         <span class="mi">26</span><span class="p">.</span><span class="mi">0</span>    <span class="mi">16</span><span class="p">.</span><span class="mi">2</span>   <span class="mi">21</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">28</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">22</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">29</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">34</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">2015</span>  
<span class="mi">4481</span>             <span class="mi">4</span>         <span class="mi">25</span><span class="p">.</span><span class="mi">7</span>     <span class="mi">8</span><span class="p">.</span><span class="mi">9</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">31</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">26</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">51</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">21</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">2015</span>  
<span class="mi">4482</span>             <span class="mi">1</span>         <span class="mi">25</span><span class="p">.</span><span class="mi">3</span>    <span class="mi">41</span><span class="p">.</span><span class="mi">4</span>   <span class="mi">33</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">7</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">46</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">31</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">2015</span>  
<span class="mi">4483</span>             <span class="mi">4</span>         <span class="mi">24</span><span class="p">.</span><span class="mi">9</span>    <span class="mi">13</span><span class="p">.</span><span class="mi">6</span>   <span class="mi">14</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">24</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">14</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">47</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">28</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">2015</span>  
<span class="mi">4484</span>             <span class="mi">4</span>         <span class="mi">24</span><span class="p">.</span><span class="mi">9</span>    <span class="mi">19</span><span class="p">.</span><span class="mi">2</span>   <span class="mi">16</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">17</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">21</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">39</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">35</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">2015</span>  
<span class="mi">4485</span>             <span class="mi">4</span>         <span class="mi">24</span><span class="p">.</span><span class="mi">9</span>    <span class="mi">25</span><span class="p">.</span><span class="mi">1</span>   <span class="mi">28</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">15</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">19</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">34</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">21</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">2015</span>  
<span class="mi">4486</span>             <span class="mi">2</span>         <span class="mi">24</span><span class="p">.</span><span class="mi">7</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">30</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">18</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">56</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">30</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">2015</span>  
<span class="mi">4487</span>            <span class="mi">46</span>         <span class="mi">24</span><span class="p">.</span><span class="mi">7</span>    <span class="mi">14</span><span class="p">.</span><span class="mi">5</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">27</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">27</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">48</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">20</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">2015</span>  
<span class="mi">4488</span>             <span class="mi">9</span>         <span class="mi">24</span><span class="p">.</span><span class="mi">6</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">29</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">23</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">14</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">39</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">26</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">2015</span>  
<span class="mi">4489</span>            <span class="mi">47</span>         <span class="mi">24</span><span class="p">.</span><span class="mi">5</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">20</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">22</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">25</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">42</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">19</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">2015</span>  
<span class="mi">4490</span>            <span class="mi">47</span>         <span class="mi">24</span><span class="p">.</span><span class="mi">5</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">37</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">33</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">29</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">37</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">2015</span>  
<span class="mi">4491</span>            <span class="mi">47</span>         <span class="mi">24</span><span class="p">.</span><span class="mi">5</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>   <span class="mi">11</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">26</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">25</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">46</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">18</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">2015</span>  
<span class="mi">4492</span>             <span class="mi">4</span>         <span class="mi">24</span><span class="p">.</span><span class="mi">4</span>    <span class="mi">12</span><span class="p">.</span><span class="mi">6</span>   <span class="mi">18</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">23</span><span class="p">.</span><span class="mi">2</span>  <span class="mi">15</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">44</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">22</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">2015</span>  
<span class="mi">4493</span>             <span class="mi">4</span>         <span class="mi">24</span><span class="p">.</span><span class="mi">3</span>    <span class="mi">15</span><span class="p">.</span><span class="mi">4</span>   <span class="mi">19</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">17</span><span class="p">.</span><span class="mi">4</span>  <span class="mi">21</span><span class="p">.</span><span class="mi">1</span>  <span class="mi">39</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">25</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">2015</span>  
<span class="mi">4494</span>             <span class="mi">4</span>         <span class="mi">24</span><span class="p">.</span><span class="mi">2</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">27</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">18</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">55</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">33</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">2015</span>  
<span class="mi">4495</span>            <span class="mi">50</span>         <span class="mi">24</span><span class="p">.</span><span class="mi">0</span>     <span class="mi">8</span><span class="p">.</span><span class="mi">9</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">30</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">21</span><span class="p">.</span><span class="mi">8</span>  <span class="mi">50</span><span class="p">.</span><span class="mi">6</span>  <span class="mi">18</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">2015</span>  
<span class="mi">4496</span>            <span class="mi">51</span>         <span class="mi">23</span><span class="p">.</span><span class="mi">9</span>     <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>    <span class="mi">0</span><span class="p">.</span><span class="mi">0</span>  <span class="mi">34</span><span class="p">.</span><span class="mi">3</span>  <span class="mi">22</span><span class="p">.</span><span class="mi">7</span>  <span class="mi">49</span><span class="p">.</span><span class="mi">5</span>  <span class="mi">20</span><span class="p">.</span><span class="mi">9</span>  <span class="mi">2015</span>

<span class="p">[</span><span class="mi">948</span> <span class="k">rows</span> <span class="n">x</span> <span class="mi">11</span> <span class="n">columns</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">shanghai_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;national_rank == 1 and world_rank == 1&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>world_rank</th>
      <th>university_name</th>
      <th>national_rank</th>
      <th>total_score</th>
      <th>alumni</th>
      <th>award</th>
      <th>hici</th>
      <th>ns</th>
      <th>pub</th>
      <th>pcp</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">shanghai_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;alumni &lt; 20&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>world_rank</th>
      <th>university_name</th>
      <th>national_rank</th>
      <th>total_score</th>
      <th>alumni</th>
      <th>award</th>
      <th>hici</th>
      <th>ns</th>
      <th>pub</th>
      <th>pcp</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>12</th>
      <td>13</td>
      <td>University of California, San Diego</td>
      <td>11</td>
      <td>51.0</td>
      <td>17.7</td>
      <td>34.7</td>
      <td>59.8</td>
      <td>56.5</td>
      <td>64.5</td>
      <td>46.6</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>17</th>
      <td>18</td>
      <td>University of California, San Francisco</td>
      <td>16</td>
      <td>47.8</td>
      <td>0.0</td>
      <td>37.6</td>
      <td>55.6</td>
      <td>57.9</td>
      <td>58.8</td>
      <td>45.2</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>33</th>
      <td>34</td>
      <td>University of California, Santa Barbara</td>
      <td>26</td>
      <td>36.9</td>
      <td>0.0</td>
      <td>36.0</td>
      <td>42.3</td>
      <td>39.0</td>
      <td>44.1</td>
      <td>35.8</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>34</th>
      <td>35</td>
      <td>University of Colorado at Boulder</td>
      <td>27</td>
      <td>36.3</td>
      <td>16.6</td>
      <td>29.8</td>
      <td>40.8</td>
      <td>36.6</td>
      <td>46.3</td>
      <td>29.5</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>38</th>
      <td>39</td>
      <td>Pennsylvania State University - University Park</td>
      <td>30</td>
      <td>33.4</td>
      <td>14.0</td>
      <td>0.0</td>
      <td>45.8</td>
      <td>37.9</td>
      <td>59.9</td>
      <td>24.0</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>39</th>
      <td>39</td>
      <td>Vanderbilt University</td>
      <td>30</td>
      <td>33.4</td>
      <td>12.5</td>
      <td>30.2</td>
      <td>34.2</td>
      <td>24.5</td>
      <td>49.2</td>
      <td>35.6</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>40</th>
      <td>41</td>
      <td>University of California, Davis</td>
      <td>32</td>
      <td>32.9</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>46.5</td>
      <td>34.5</td>
      <td>64.0</td>
      <td>29.8</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>42</th>
      <td>43</td>
      <td>Rutgers, The State University of New Jersey - ...</td>
      <td>33</td>
      <td>32.3</td>
      <td>15.4</td>
      <td>20.4</td>
      <td>36.9</td>
      <td>32.9</td>
      <td>47.1</td>
      <td>24.1</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>47</th>
      <td>47</td>
      <td>University of California, Irvine</td>
      <td>35</td>
      <td>31.8</td>
      <td>0.0</td>
      <td>30.0</td>
      <td>32.4</td>
      <td>28.5</td>
      <td>48.2</td>
      <td>31.1</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>49</th>
      <td>50</td>
      <td>University of Southern California</td>
      <td>37</td>
      <td>31.7</td>
      <td>0.0</td>
      <td>27.3</td>
      <td>37.7</td>
      <td>23.6</td>
      <td>52.8</td>
      <td>25.8</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>54</th>
      <td>55</td>
      <td>University of North Carolina at Chapel Hill</td>
      <td>39</td>
      <td>30.3</td>
      <td>12.5</td>
      <td>0.0</td>
      <td>35.1</td>
      <td>32.8</td>
      <td>59.5</td>
      <td>27.3</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>55</th>
      <td>56</td>
      <td>The Australian National University</td>
      <td>1</td>
      <td>30.2</td>
      <td>17.7</td>
      <td>12.9</td>
      <td>36.9</td>
      <td>29.0</td>
      <td>45.1</td>
      <td>27.8</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>57</th>
      <td>57</td>
      <td>University of Florida</td>
      <td>40</td>
      <td>30.0</td>
      <td>15.4</td>
      <td>0.0</td>
      <td>35.1</td>
      <td>25.0</td>
      <td>65.2</td>
      <td>25.8</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>58</th>
      <td>57</td>
      <td>University of Zurich</td>
      <td>2</td>
      <td>30.0</td>
      <td>12.5</td>
      <td>27.3</td>
      <td>19.2</td>
      <td>30.3</td>
      <td>47.2</td>
      <td>30.6</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>61</th>
      <td>62</td>
      <td>Osaka University</td>
      <td>3</td>
      <td>29.3</td>
      <td>12.5</td>
      <td>0.0</td>
      <td>23.6</td>
      <td>31.1</td>
      <td>66.8</td>
      <td>29.2</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>62</th>
      <td>63</td>
      <td>The Ohio State University - Columbus</td>
      <td>41</td>
      <td>29.2</td>
      <td>17.7</td>
      <td>0.0</td>
      <td>40.8</td>
      <td>21.5</td>
      <td>61.2</td>
      <td>19.5</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>63</th>
      <td>64</td>
      <td>University of Bristol</td>
      <td>7</td>
      <td>28.8</td>
      <td>10.9</td>
      <td>18.2</td>
      <td>30.4</td>
      <td>24.5</td>
      <td>47.5</td>
      <td>27.4</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>70</th>
      <td>71</td>
      <td>University of Heidelberg</td>
      <td>3</td>
      <td>28.0</td>
      <td>10.9</td>
      <td>27.7</td>
      <td>20.8</td>
      <td>20.9</td>
      <td>48.1</td>
      <td>26.9</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>72</th>
      <td>73</td>
      <td>Tohoku University</td>
      <td>4</td>
      <td>27.8</td>
      <td>18.8</td>
      <td>0.0</td>
      <td>19.2</td>
      <td>26.9</td>
      <td>65.3</td>
      <td>29.0</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>73</th>
      <td>73</td>
      <td>University of Arizona</td>
      <td>44</td>
      <td>27.8</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>29.4</td>
      <td>36.8</td>
      <td>55.8</td>
      <td>25.7</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>74</th>
      <td>75</td>
      <td>Purdue University - West Lafayette</td>
      <td>45</td>
      <td>27.7</td>
      <td>18.8</td>
      <td>17.1</td>
      <td>27.2</td>
      <td>21.4</td>
      <td>49.8</td>
      <td>19.4</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>75</th>
      <td>76</td>
      <td>University of Helsinki</td>
      <td>1</td>
      <td>27.4</td>
      <td>18.8</td>
      <td>18.2</td>
      <td>15.7</td>
      <td>21.4</td>
      <td>54.5</td>
      <td>27.5</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>76</th>
      <td>77</td>
      <td>Michigan State University</td>
      <td>46</td>
      <td>26.9</td>
      <td>12.5</td>
      <td>0.0</td>
      <td>37.7</td>
      <td>26.6</td>
      <td>51.0</td>
      <td>18.7</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>79</th>
      <td>80</td>
      <td>Boston University</td>
      <td>48</td>
      <td>26.1</td>
      <td>15.4</td>
      <td>0.0</td>
      <td>31.4</td>
      <td>28.1</td>
      <td>50.8</td>
      <td>17.5</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>80</th>
      <td>80</td>
      <td>King's College London</td>
      <td>9</td>
      <td>26.1</td>
      <td>16.6</td>
      <td>23.5</td>
      <td>20.8</td>
      <td>17.4</td>
      <td>44.6</td>
      <td>24.8</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>81</th>
      <td>82</td>
      <td>University of Melbourne</td>
      <td>2</td>
      <td>26.0</td>
      <td>15.4</td>
      <td>14.4</td>
      <td>22.2</td>
      <td>18.7</td>
      <td>53.5</td>
      <td>19.9</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>82</th>
      <td>83</td>
      <td>University of Nottingham</td>
      <td>10</td>
      <td>25.9</td>
      <td>15.4</td>
      <td>20.4</td>
      <td>20.8</td>
      <td>19.0</td>
      <td>45.6</td>
      <td>24.8</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>85</th>
      <td>86</td>
      <td>Brown University</td>
      <td>49</td>
      <td>25.4</td>
      <td>0.0</td>
      <td>13.9</td>
      <td>29.4</td>
      <td>25.5</td>
      <td>40.7</td>
      <td>27.9</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>86</th>
      <td>87</td>
      <td>Indiana University Bloomington</td>
      <td>50</td>
      <td>25.2</td>
      <td>14.0</td>
      <td>18.2</td>
      <td>24.8</td>
      <td>21.2</td>
      <td>42.0</td>
      <td>18.2</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>88</th>
      <td>89</td>
      <td>Texas A&amp;M University - College Station</td>
      <td>51</td>
      <td>25.1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>32.4</td>
      <td>24.4</td>
      <td>55.0</td>
      <td>20.4</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4867</th>
      <td>401-500</td>
      <td>University of Jena</td>
      <td>29-39</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>9.3</td>
      <td>34.0</td>
      <td>17.1</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4868</th>
      <td>401-500</td>
      <td>University of Jyvaskyla</td>
      <td>4-6</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.6</td>
      <td>10.3</td>
      <td>26.7</td>
      <td>14.1</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4869</th>
      <td>401-500</td>
      <td>University of Konstanz</td>
      <td>29-39</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>12.1</td>
      <td>11.4</td>
      <td>22.2</td>
      <td>13.5</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4870</th>
      <td>401-500</td>
      <td>University of KwaZulu-Natal</td>
      <td>3-4</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.6</td>
      <td>8.4</td>
      <td>32.8</td>
      <td>16.6</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4871</th>
      <td>401-500</td>
      <td>University of Ljubljana</td>
      <td>1</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>7.7</td>
      <td>35.1</td>
      <td>14.2</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4872</th>
      <td>401-500</td>
      <td>University of Maryland, Baltimore County</td>
      <td>126-146</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>17.4</td>
      <td>6.5</td>
      <td>17.8</td>
      <td>17.3</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4873</th>
      <td>401-500</td>
      <td>University of Milan - Bicocca</td>
      <td>11-20</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>5.6</td>
      <td>30.9</td>
      <td>21.4</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4874</th>
      <td>401-500</td>
      <td>University of Nice Sophia Antipolis</td>
      <td>19-22</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.6</td>
      <td>16.3</td>
      <td>26.2</td>
      <td>12.7</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4875</th>
      <td>401-500</td>
      <td>University of Oklahoma - Norman</td>
      <td>126-146</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.1</td>
      <td>10.0</td>
      <td>28.0</td>
      <td>14.0</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4876</th>
      <td>401-500</td>
      <td>University of Palermo</td>
      <td>11-20</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>6.3</td>
      <td>6.6</td>
      <td>28.2</td>
      <td>14.8</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4877</th>
      <td>401-500</td>
      <td>University of Parma</td>
      <td>11-20</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>13.6</td>
      <td>2.1</td>
      <td>26.7</td>
      <td>19.6</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4878</th>
      <td>401-500</td>
      <td>University of Pavia</td>
      <td>11-20</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>5.7</td>
      <td>30.7</td>
      <td>19.7</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4879</th>
      <td>401-500</td>
      <td>University of Perugia</td>
      <td>11-20</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.6</td>
      <td>7.5</td>
      <td>29.3</td>
      <td>18.5</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4880</th>
      <td>401-500</td>
      <td>University of Quebec</td>
      <td>19-20</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>9.8</td>
      <td>33.3</td>
      <td>16.8</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4881</th>
      <td>401-500</td>
      <td>University of Regensburg</td>
      <td>29-39</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.6</td>
      <td>13.9</td>
      <td>27.7</td>
      <td>15.2</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4882</th>
      <td>401-500</td>
      <td>University of Rennes 1</td>
      <td>19-22</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.6</td>
      <td>9.2</td>
      <td>28.1</td>
      <td>11.2</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4883</th>
      <td>401-500</td>
      <td>University of Rhode Island</td>
      <td>126-146</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>15.2</td>
      <td>6.1</td>
      <td>21.1</td>
      <td>16.0</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4884</th>
      <td>401-500</td>
      <td>University of Roma - Tor Vergata</td>
      <td>11-20</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.8</td>
      <td>33.7</td>
      <td>19.2</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4885</th>
      <td>401-500</td>
      <td>University of Rostock</td>
      <td>29-39</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.6</td>
      <td>8.4</td>
      <td>25.0</td>
      <td>13.5</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4886</th>
      <td>401-500</td>
      <td>University of Santiago Compostela</td>
      <td>9-13</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>7.1</td>
      <td>6.1</td>
      <td>31.1</td>
      <td>13.2</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4887</th>
      <td>401-500</td>
      <td>University of Science, Malaysia</td>
      <td>2</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>7.1</td>
      <td>3.3</td>
      <td>30.6</td>
      <td>15.7</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4888</th>
      <td>401-500</td>
      <td>University of Seville</td>
      <td>9-13</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>7.5</td>
      <td>33.7</td>
      <td>11.3</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4889</th>
      <td>401-500</td>
      <td>University of Surrey</td>
      <td>34-37</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.6</td>
      <td>4.9</td>
      <td>27.0</td>
      <td>18.0</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4890</th>
      <td>401-500</td>
      <td>University of Szeged</td>
      <td>1-2</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>13.3</td>
      <td>3.6</td>
      <td>3.4</td>
      <td>21.8</td>
      <td>12.8</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4891</th>
      <td>401-500</td>
      <td>University of the Basque Country</td>
      <td>9-13</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.6</td>
      <td>7.1</td>
      <td>36.1</td>
      <td>13.5</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4892</th>
      <td>401-500</td>
      <td>University of Trieste</td>
      <td>11-20</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>10.9</td>
      <td>25.1</td>
      <td>20.1</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4893</th>
      <td>401-500</td>
      <td>University of Zaragoza</td>
      <td>9-13</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>7.6</td>
      <td>5.1</td>
      <td>33.3</td>
      <td>13.1</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4894</th>
      <td>401-500</td>
      <td>Utah State University</td>
      <td>126-146</td>
      <td>NaN</td>
      <td>13.6</td>
      <td>0.0</td>
      <td>3.6</td>
      <td>10.8</td>
      <td>25.1</td>
      <td>15.5</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4895</th>
      <td>401-500</td>
      <td>Vienna University of Technology</td>
      <td>4-6</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>12.2</td>
      <td>28.8</td>
      <td>22.9</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>4896</th>
      <td>401-500</td>
      <td>Wake Forest University</td>
      <td>126-146</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>14.9</td>
      <td>7.5</td>
      <td>25.0</td>
      <td>11.9</td>
      <td>2015</td>
    </tr>
  </tbody>
</table>
<p>4122 rows × 11 columns</p>
</div>

<h2 id="method-chaining">Method Chaining<a class="headerlink" href="#method-chaining" title="Permanent link">&para;</a></h2>
<p><code class="codehilite"><span class="n">pipe</span><span class="p">()</span></code> to chain operations and thus eliminate the need for intermediate DataFrames.</p>
<p>Without this operator, instead of writing <code class="codehilite"><span class="n">df</span><span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">f</span><span class="p">).</span><span class="n">pipe</span><span class="p">(</span><span class="k">g</span><span class="p">).</span><span class="n">pipe</span><span class="p">(</span><span class="n">h</span><span class="p">)</span></code> write: <code class="codehilite"><span class="n">h</span><span class="p">(</span><span class="k">g</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">df</span><span class="p">)))</span></code>. This becomes harder to follow once the number of nested functions grows large.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Extract info</span>
<span class="k">def</span> <span class="nf">extract_info</span><span class="p">(</span><span class="n">input_df</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">input_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">info_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;nb_rows&#39;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;nb_cols&#39;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">info_df</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Gather all info   </span>
<span class="n">all_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">times_df</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">extract_info</span><span class="p">,</span> <span class="s1">&#39;times&#39;</span><span class="p">),</span> <span class="n">shanghai_df</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">extract_info</span><span class="p">,</span> <span class="s1">&#39;shanghai&#39;</span><span class="p">)])</span>

<span class="k">print</span><span class="p">(</span><span class="n">all_info</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>       <span class="n">name</span>  <span class="n">nb_cols</span>  <span class="n">nb_rows</span>
<span class="mi">0</span>     <span class="n">times</span>       <span class="mi">14</span>     <span class="mi">2603</span>
<span class="mi">0</span>  <span class="n">shanghai</span>       <span class="mi">11</span>     <span class="mi">4897</span>
</pre></div>
</td></tr></table>

<p>Select the common columns.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">common_columns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">shanghai_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">times_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># Return `common_columns`</span>
<span class="k">print</span><span class="p">(</span><span class="n">common_columns</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">{</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;university_name&#39;</span><span class="p">,</span> <span class="s1">&#39;total_score&#39;</span><span class="p">,</span> <span class="s1">&#39;world_rank&#39;</span><span class="err">}</span>
</pre></div>
</td></tr></table>

<h3 id="clean-the-data">Clean the Data<a class="headerlink" href="#clean-the-data" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Clean up the `world_rank` </span>
<span class="k">def</span> <span class="nf">clean_world_rank</span><span class="p">(</span><span class="n">input_df</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">input_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df</span><span class="o">.</span><span class="n">world_rank</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">world_rank</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Assign the common years of `shanghai_df` and `times_df` to `common_years`    </span>
<span class="n">common_years</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">shanghai_df</span><span class="o">.</span><span class="n">year</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">times_df</span><span class="o">.</span><span class="n">year</span><span class="p">)</span> 

<span class="c1"># Print `common_years`</span>
<span class="k">print</span><span class="p">(</span><span class="n">common_years</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">{</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">,</span> <span class="mi">2015</span><span class="err">}</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Filter years</span>
<span class="k">def</span> <span class="nf">filter_year</span><span class="p">(</span><span class="n">input_df</span><span class="p">,</span> <span class="n">years</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">input_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;year in {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">years</span><span class="p">)))</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Clean `times_df` and `shanghai_df`</span>
<span class="n">cleaned_times_df</span> <span class="o">=</span> <span class="p">(</span><span class="n">times_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">common_columns</span><span class="p">]</span>
                            <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">filter_year</span><span class="p">,</span> <span class="n">common_years</span><span class="p">)</span>
                            <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">clean_world_rank</span><span class="p">)</span>
                            <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;times&#39;</span><span class="p">))</span>
<span class="n">cleaned_shanghai_df</span> <span class="o">=</span> <span class="p">(</span><span class="n">shanghai_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">common_columns</span><span class="p">]</span>
                                  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">filter_year</span><span class="p">,</span> <span class="n">common_years</span><span class="p">)</span>
                                  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">clean_world_rank</span><span class="p">)</span>
                                  <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;shanghai&#39;</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<h3 id="concatenate-into-a-single-dataframe">Concatenate into a single DataFrame<a class="headerlink" href="#concatenate-into-a-single-dataframe" title="Permanent link">&para;</a></h3>
<p>38% of data missing from the <code class="codehilite"><span class="n">total_score</span> <span class="k">column</span></code>: drop this column with the <code class="codehilite"><span class="na">.drop</span></code> method.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Compose `ranking_df` with `cleaned_times_df` and `cleaned_shanghai_df`</span>
<span class="n">ranking_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">cleaned_times_df</span><span class="p">,</span> <span class="n">cleaned_shanghai_df</span><span class="p">])</span>

<span class="c1"># Calculate the percentage of missing data</span>
<span class="n">missing_data</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">pd</span><span class="o">.</span><span class="n">isnull</span><span class="p">(</span><span class="n">ranking_df</span><span class="o">.</span><span class="n">total_score</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">ranking_df</span><span class="p">)</span>

<span class="c1"># Drop the `total_score` column of `ranking_df`</span>
<span class="n">ranking_df</span> <span class="o">=</span> <span class="n">ranking_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;total_score&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<h2 id="memory-optimization">Memory Optimization<a class="headerlink" href="#memory-optimization" title="Permanent link">&para;</a></h2>
<p>Memory can start to play a big part in how fast the pipelines can run. Without the “deep” flag turned on, Pandas won’t estimate memory consumption for the <code class="codehilite"><span class="k">object</span></code> dtype: <code class="codehilite"><span class="n">category</span></code> when dealing with categorical data, etc. <code class="codehilite"><span class="n">int64</span></code> or even <code class="codehilite"><span class="n">int16</span></code> takes less memory.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Print the memory usage of `ranking_df` </span>
<span class="n">ranking_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">&lt;</span><span class="k">class</span> <span class="s1">&#39;pandas.core.frame.DataFrame&#39;</span><span class="o">&gt;</span>
<span class="n">Int64Index</span><span class="p">:</span> <span class="mi">3686</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">0</span> <span class="k">to</span> <span class="mi">4896</span>
<span class="k">Data</span> <span class="n">columns</span> <span class="p">(</span><span class="n">total</span> <span class="mi">4</span> <span class="n">columns</span><span class="p">):</span>
<span class="k">year</span>               <span class="mi">3686</span> <span class="n">non</span><span class="o">-</span><span class="k">null</span> <span class="n">int64</span>
<span class="n">world_rank</span>         <span class="mi">3686</span> <span class="n">non</span><span class="o">-</span><span class="k">null</span> <span class="k">object</span>
<span class="n">university_name</span>    <span class="mi">3685</span> <span class="n">non</span><span class="o">-</span><span class="k">null</span> <span class="k">object</span>
<span class="n">name</span>               <span class="mi">3686</span> <span class="n">non</span><span class="o">-</span><span class="k">null</span> <span class="k">object</span>
<span class="n">dtypes</span><span class="p">:</span> <span class="n">int64</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="k">object</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">memory</span> <span class="k">usage</span><span class="p">:</span> <span class="mi">144</span><span class="p">.</span><span class="mi">0</span><span class="o">+</span> <span class="n">KB</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Print the deep memory usage of `ranking_df` </span>
<span class="n">ranking_df</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">memory_usage</span><span class="o">=</span><span class="s2">&quot;deep&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">&lt;</span><span class="k">class</span> <span class="s1">&#39;pandas.core.frame.DataFrame&#39;</span><span class="o">&gt;</span>
<span class="n">Int64Index</span><span class="p">:</span> <span class="mi">3686</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">0</span> <span class="k">to</span> <span class="mi">4896</span>
<span class="k">Data</span> <span class="n">columns</span> <span class="p">(</span><span class="n">total</span> <span class="mi">4</span> <span class="n">columns</span><span class="p">):</span>
<span class="k">year</span>               <span class="mi">3686</span> <span class="n">non</span><span class="o">-</span><span class="k">null</span> <span class="n">int64</span>
<span class="n">world_rank</span>         <span class="mi">3686</span> <span class="n">non</span><span class="o">-</span><span class="k">null</span> <span class="k">object</span>
<span class="n">university_name</span>    <span class="mi">3685</span> <span class="n">non</span><span class="o">-</span><span class="k">null</span> <span class="k">object</span>
<span class="n">name</span>               <span class="mi">3686</span> <span class="n">non</span><span class="o">-</span><span class="k">null</span> <span class="k">object</span>
<span class="n">dtypes</span><span class="p">:</span> <span class="n">int64</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="k">object</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">memory</span> <span class="k">usage</span><span class="p">:</span> <span class="mi">803</span><span class="p">.</span><span class="mi">1</span> <span class="n">KB</span>
</pre></div>
</td></tr></table>

<h3 id="cast-object-types">Cast Object Types<a class="headerlink" href="#cast-object-types" title="Permanent link">&para;</a></h3>
<p>&hellip;to more appropriate ones.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">memory_change</span><span class="p">(</span><span class="n">input_df</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">input_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">old</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># In KB</span>
    <span class="n">new</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">memory_usage</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="c1"># In KB</span>
    <span class="n">change</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">old</span> <span class="o">-</span> <span class="n">new</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">old</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">report</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;The inital memory footprint for {column} is: {old}KB.</span><span class="se">\n</span><span class="s2">&quot;</span> 
              <span class="s2">&quot;The casted {column} now takes: {new}KB.</span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="s2">&quot;A change of {change} %.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="nb">locals</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">report</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># parameters:</span>
<span class="c1"># input_df, column, dtype</span>
<span class="k">print</span><span class="p">(</span><span class="n">memory_change</span><span class="p">(</span><span class="n">ranking_df</span><span class="p">,</span><span class="s1">&#39;world_rank&#39;</span><span class="p">,</span> <span class="s1">&#39;int16&#39;</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nv">The</span> <span class="nv">inital</span> <span class="nv">memory</span> <span class="nv">footprint</span> <span class="k">for</span> <span class="nv">world_rank</span> <span class="nv">is</span>: <span class="mi">244</span>.<span class="mi">43</span><span class="nv">KB</span>.
<span class="nv">The</span> <span class="nv">casted</span> <span class="nv">world_rank</span> <span class="nv">now</span> <span class="nv">takes</span>: <span class="mi">36</span>.<span class="mi">0</span><span class="nv">KB</span>.
<span class="nv">A</span> <span class="nv">change</span> <span class="nv">of</span> <span class="mi">85</span>.<span class="mi">27</span> <span class="o">%</span>.
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">memory_change</span><span class="p">(</span><span class="n">ranking_df</span><span class="p">,</span><span class="s1">&#39;university_name&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nv">The</span> <span class="nv">inital</span> <span class="nv">memory</span> <span class="nv">footprint</span> <span class="k">for</span> <span class="nv">university_name</span> <span class="nv">is</span>: <span class="mi">329</span>.<span class="mi">98</span><span class="nv">KB</span>.
<span class="nv">The</span> <span class="nv">casted</span> <span class="nv">university_name</span> <span class="nv">now</span> <span class="nv">takes</span>: <span class="mi">121</span>.<span class="mi">37</span><span class="nv">KB</span>.
<span class="nv">A</span> <span class="nv">change</span> <span class="nv">of</span> <span class="mi">63</span>.<span class="mi">22</span> <span class="o">%</span>.
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">memory_change</span><span class="p">(</span><span class="n">ranking_df</span><span class="p">,</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nv">The</span> <span class="nv">inital</span> <span class="nv">memory</span> <span class="nv">footprint</span> <span class="k">for</span> <span class="nv">name</span> <span class="nv">is</span>: <span class="mi">257</span>.<span class="mi">49</span><span class="nv">KB</span>.
<span class="nv">The</span> <span class="nv">casted</span> <span class="nv">name</span> <span class="nv">now</span> <span class="nv">takes</span>: <span class="mi">32</span>.<span class="mi">6</span><span class="nv">KB</span>.
<span class="nv">A</span> <span class="nv">change</span> <span class="nv">of</span> <span class="mi">87</span>.<span class="mi">34</span> <span class="o">%</span>.
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Cast `world_rank` as type `int16`</span>
<span class="n">ranking_df</span><span class="o">.</span><span class="n">world_rank</span> <span class="o">=</span> <span class="n">ranking_df</span><span class="o">.</span><span class="n">world_rank</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int16&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Cast `unversity_name` as type `category`</span>
<span class="n">ranking_df</span><span class="o">.</span><span class="n">university_name</span> <span class="o">=</span> <span class="n">ranking_df</span><span class="o">.</span><span class="n">university_name</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Cast `name` as type `category`</span>
<span class="n">ranking_df</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">ranking_df</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Double check the memory usage after type casting</span>
<span class="n">ranking_df</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">memory_usage</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">&lt;</span><span class="k">class</span> <span class="s1">&#39;pandas.core.frame.DataFrame&#39;</span><span class="o">&gt;</span>
<span class="n">Int64Index</span><span class="p">:</span> <span class="mi">3686</span> <span class="n">entries</span><span class="p">,</span> <span class="mi">0</span> <span class="k">to</span> <span class="mi">4896</span>
<span class="k">Data</span> <span class="n">columns</span> <span class="p">(</span><span class="n">total</span> <span class="mi">4</span> <span class="n">columns</span><span class="p">):</span>
<span class="k">year</span>               <span class="mi">3686</span> <span class="n">non</span><span class="o">-</span><span class="k">null</span> <span class="n">int64</span>
<span class="n">university_name</span>    <span class="mi">3685</span> <span class="n">non</span><span class="o">-</span><span class="k">null</span> <span class="n">category</span>
<span class="n">world_rank</span>         <span class="mi">3686</span> <span class="n">non</span><span class="o">-</span><span class="k">null</span> <span class="n">int16</span>
<span class="n">name</span>               <span class="mi">3686</span> <span class="n">non</span><span class="o">-</span><span class="k">null</span> <span class="n">category</span>
<span class="n">dtypes</span><span class="p">:</span> <span class="n">category</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">int16</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">int64</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">memory</span> <span class="k">usage</span><span class="p">:</span> <span class="mi">161</span><span class="p">.</span><span class="mi">2</span> <span class="n">KB</span>
</pre></div>
</td></tr></table>

<p>From 803.1 KB!</p>
<p>We have a well-formed data set (i.e. it is in a tidy state) with an optimized memory footprint, data analysis can start.</p>
<h2 id="replace-rank-subset-groupby">Replace, Rank, Subset, <code class="codehilite"><span class="n">groupby</span></code><a class="headerlink" href="#replace-rank-subset-groupby" title="Permanent link">&para;</a></h2>
<h3 id="replace">Replace<a class="headerlink" href="#replace" title="Permanent link">&para;</a></h3>
<p>‘Massachusetts Institute of Technology (MIT)’ and ‘Massachusetts Institute of Technology’ are two different records of the same university. Thus, change the first name to the latter.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Query for the rows with university name &#39;Massachusetts Institute of Technology (MIT)&#39;</span>
<span class="k">print</span><span class="p">(</span><span class="n">ranking_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;university_name == &#39;Massachusetts Institute of Technology (MIT)&#39;&quot;</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>      <span class="k">year</span>                              <span class="n">university_name</span>  <span class="n">world_rank</span>      <span class="n">name</span>
<span class="mi">3016</span>  <span class="mi">2011</span>  <span class="n">Massachusetts</span> <span class="n">Institute</span> <span class="k">of</span> <span class="n">Technology</span> <span class="p">(</span><span class="n">MIT</span><span class="p">)</span>           <span class="mi">3</span>  <span class="n">shanghai</span>
<span class="mi">3516</span>  <span class="mi">2012</span>  <span class="n">Massachusetts</span> <span class="n">Institute</span> <span class="k">of</span> <span class="n">Technology</span> <span class="p">(</span><span class="n">MIT</span><span class="p">)</span>           <span class="mi">3</span>  <span class="n">shanghai</span>
<span class="mi">3801</span>  <span class="mi">2013</span>  <span class="n">Massachusetts</span> <span class="n">Institute</span> <span class="k">of</span> <span class="n">Technology</span> <span class="p">(</span><span class="n">MIT</span><span class="p">)</span>           <span class="mi">4</span>  <span class="n">shanghai</span>
<span class="mi">3899</span>  <span class="mi">2014</span>  <span class="n">Massachusetts</span> <span class="n">Institute</span> <span class="k">of</span> <span class="n">Technology</span> <span class="p">(</span><span class="n">MIT</span><span class="p">)</span>           <span class="mi">3</span>  <span class="n">shanghai</span>
<span class="mi">4399</span>  <span class="mi">2015</span>  <span class="n">Massachusetts</span> <span class="n">Institute</span> <span class="k">of</span> <span class="n">Technology</span> <span class="p">(</span><span class="n">MIT</span><span class="p">)</span>           <span class="mi">3</span>  <span class="n">shanghai</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">ranking_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ranking_df</span><span class="o">.</span><span class="n">university_name</span> <span class="o">==</span> <span class="s1">&#39;Massachusetts Institute of Technology (MIT)&#39;</span><span class="p">,</span> <span class="s1">&#39;university_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Massachusetts Institute of Technology&#39;</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">ranking_df</span><span class="o">.</span><span class="n">university_name</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">0</span>                       <span class="n">Harvard</span> <span class="n">University</span>
<span class="mi">1</span>       <span class="n">California</span> <span class="n">Institute</span> <span class="k">of</span> <span class="n">Technology</span>
<span class="mi">2</span>    <span class="n">Massachusetts</span> <span class="n">Institute</span> <span class="k">of</span> <span class="n">Technology</span>
<span class="mi">3</span>                      <span class="n">Stanford</span> <span class="n">University</span>
<span class="mi">4</span>                     <span class="n">Princeton</span> <span class="n">University</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">university_name</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">category</span>
<span class="n">Categories</span> <span class="p">(</span><span class="mi">785</span><span class="p">,</span> <span class="k">object</span><span class="p">):</span> <span class="p">[</span><span class="n">Aalborg</span> <span class="n">University</span><span class="p">,</span> <span class="n">Aalto</span> <span class="n">University</span><span class="p">,</span> <span class="n">Aarhus</span> <span class="n">University</span><span class="p">,</span> <span class="n">Aberystwyth</span> <span class="n">University</span><span class="p">,</span> <span class="p">...,</span> <span class="err">É</span><span class="n">cole</span> <span class="n">Normale</span> <span class="n">Supérieure</span><span class="p">,</span> <span class="err">É</span><span class="n">cole</span> <span class="n">Normale</span> <span class="n">Supérieure</span> <span class="n">de</span> <span class="n">Lyon</span><span class="p">,</span> <span class="err">É</span><span class="n">cole</span> <span class="n">Polytechnique</span><span class="p">,</span> <span class="err">É</span><span class="n">cole</span> <span class="n">Polytechnique</span> <span class="n">Fédérale</span> <span class="n">de</span> <span class="n">Lausanne</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<h3 id="rank-subset-groupby">Rank, Subset, <code class="codehilite"><span class="n">groupby</span></code><a class="headerlink" href="#rank-subset-groupby" title="Permanent link">&para;</a></h3>
<p>To find the 5 (more generally <code class="codehilite"><span class="n">n</span></code>) top universities over the years, for each ranking system, here is how to do it in pseudo-code:</p>
<ul>
<li>For each year (in the <code class="codehilite"><span class="k">year</span></code> column) and for each ranking system (in the <code class="codehilite"><span class="n">name</span></code> column):<ul>
<li>Select the subset of the data for this given year and the given ranking system.</li>
<li>Select the 5 top universities and store them in a list.</li>
<li>Store the result in a dictionary with (year, name) as key and the list of the universities (in descending order) as the value.</li>
</ul>
</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Load in `itertools`</span>
<span class="kn">import</span> <span class="nn">itertools</span>

<span class="c1"># Initialize `ranking`</span>
<span class="n">ranking</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">common_years</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;times&quot;</span><span class="p">,</span> <span class="s2">&quot;shanghai&quot;</span><span class="p">]):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">ranking_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">year</span> <span class="o">==</span> <span class="n">year</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">)</span>
                                    <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">world_rank</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)))),</span> <span class="p">:]</span>
                   <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;world_rank&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
                   <span class="o">.</span><span class="n">university_name</span><span class="p">)</span>
    <span class="n">ranking</span><span class="p">[(</span><span class="n">year</span><span class="p">,</span> <span class="n">name</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>


<span class="c1"># Print `ranking`</span>
<span class="k">print</span><span class="p">(</span><span class="n">ranking</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">{</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="s1">&#39;times&#39;</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;Princeton University&#39;</span><span class="p">,</span> <span class="s1">&#39;Stanford University&#39;</span><span class="p">,</span> <span class="s1">&#39;Massachusetts Institute of Technology&#39;</span><span class="p">,</span> <span class="s1">&#39;California Institute of Technology&#39;</span><span class="p">,</span> <span class="s1">&#39;Harvard University&#39;</span><span class="p">],</span> <span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="s1">&#39;shanghai&#39;</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;University of Cambridge&#39;</span><span class="p">,</span> <span class="s1">&#39;University of California, Berkeley&#39;</span><span class="p">,</span> <span class="s1">&#39;Massachusetts Institute of Technology&#39;</span><span class="p">,</span> <span class="s1">&#39;Stanford University&#39;</span><span class="p">,</span> <span class="s1">&#39;Harvard University&#39;</span><span class="p">],</span> <span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="s1">&#39;times&#39;</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;Princeton University&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Oxford&#39;</span><span class="p">,</span> <span class="s1">&#39;Harvard University&#39;</span><span class="p">,</span> <span class="s1">&#39;Stanford University&#39;</span><span class="p">,</span> <span class="s1">&#39;California Institute of Technology&#39;</span><span class="p">],</span> <span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="s1">&#39;shanghai&#39;</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;University of Cambridge&#39;</span><span class="p">,</span> <span class="s1">&#39;University of California, Berkeley&#39;</span><span class="p">,</span> <span class="s1">&#39;Massachusetts Institute of Technology&#39;</span><span class="p">,</span> <span class="s1">&#39;Stanford University&#39;</span><span class="p">,</span> <span class="s1">&#39;Harvard University&#39;</span><span class="p">],</span> <span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="s1">&#39;times&#39;</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;Massachusetts Institute of Technology&#39;</span><span class="p">,</span> <span class="s1">&#39;Harvard University&#39;</span><span class="p">,</span> <span class="s1">&#39;Stanford University&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Oxford&#39;</span><span class="p">,</span> <span class="s1">&#39;California Institute of Technology&#39;</span><span class="p">],</span> <span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="s1">&#39;shanghai&#39;</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;University of Cambridge&#39;</span><span class="p">,</span> <span class="s1">&#39;Massachusetts Institute of Technology&#39;</span><span class="p">,</span> <span class="s1">&#39;University of California, Berkeley&#39;</span><span class="p">,</span> <span class="s1">&#39;Stanford University&#39;</span><span class="p">,</span> <span class="s1">&#39;Harvard University&#39;</span><span class="p">],</span> <span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="s1">&#39;times&#39;</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;Massachusetts Institute of Technology&#39;</span><span class="p">,</span> <span class="s1">&#39;Stanford University&#39;</span><span class="p">,</span> <span class="s1">&#39;Harvard University&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Oxford&#39;</span><span class="p">,</span> <span class="s1">&#39;California Institute of Technology&#39;</span><span class="p">],</span> <span class="p">(</span><span class="mi">2014</span><span class="p">,</span> <span class="s1">&#39;shanghai&#39;</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;University of Cambridge&#39;</span><span class="p">,</span> <span class="s1">&#39;University of California-Berkeley&#39;</span><span class="p">,</span> <span class="s1">&#39;Massachusetts Institute of Technology&#39;</span><span class="p">,</span> <span class="s1">&#39;Stanford University&#39;</span><span class="p">,</span> <span class="s1">&#39;Harvard University&#39;</span><span class="p">],</span> <span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="s1">&#39;times&#39;</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;University of Cambridge&#39;</span><span class="p">,</span> <span class="s1">&#39;Stanford University&#39;</span><span class="p">,</span> <span class="s1">&#39;University of Oxford&#39;</span><span class="p">,</span> <span class="s1">&#39;Harvard University&#39;</span><span class="p">,</span> <span class="s1">&#39;California Institute of Technology&#39;</span><span class="p">],</span> <span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="s1">&#39;shanghai&#39;</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;University of Cambridge&#39;</span><span class="p">,</span> <span class="s1">&#39;University of California, Berkeley&#39;</span><span class="p">,</span> <span class="s1">&#39;Massachusetts Institute of Technology&#39;</span><span class="p">,</span> <span class="s1">&#39;Stanford University&#39;</span><span class="p">,</span> <span class="s1">&#39;Harvard University&#39;</span><span class="p">]</span><span class="err">}</span>
</pre></div>
</td></tr></table>

<p>We have this ranking dictionary, let’s find out how much (in percentage) both ranking methods differ over the years: the two are 100% set-similar if the selected 5-top universities are the same even though they aren’t ranked the same.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Import `defaultdict`</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="c1"># Initialize `compare`</span>
<span class="n">compare</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

<span class="c1"># Initialize `exact_similarity` and `set_similarity`</span>
<span class="n">exact_similarity</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">set_similarity</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">method</span><span class="p">),</span> <span class="n">universities</span> <span class="ow">in</span> <span class="n">ranking</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">compare</span><span class="p">[</span><span class="n">year</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">universities</span><span class="p">)</span>

<span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">ranks</span> <span class="ow">in</span> <span class="n">compare</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">set_similarity</span><span class="p">[</span><span class="n">year</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ranks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">ranks</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="o">/</span> <span class="mf">5.0</span>

<span class="c1"># Print `set_similarity`  </span>
<span class="k">print</span><span class="p">(</span><span class="n">set_similarity</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">{</span><span class="mi">2011</span><span class="p">:</span> <span class="mi">60</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2012</span><span class="p">:</span> <span class="mi">40</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2013</span><span class="p">:</span> <span class="mi">60</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2014</span><span class="p">:</span> <span class="mi">60</span><span class="p">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2015</span><span class="p">:</span> <span class="mi">60</span><span class="p">.</span><span class="mi">0</span><span class="err">}</span>
</pre></div>
</td></tr></table>

<p>Is there a better, more idiomatic Pandas way?</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Construct a DataFrame with the top 5 universities </span>
<span class="n">top_5_df</span> <span class="o">=</span> <span class="n">ranking_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">world_rank</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)),</span> <span class="p">:]</span>

<span class="c1"># Print the first rows of `top_5_df`</span>
<span class="n">top_5_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>university_name</th>
      <th>world_rank</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011</td>
      <td>Harvard University</td>
      <td>1</td>
      <td>times</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2011</td>
      <td>California Institute of Technology</td>
      <td>2</td>
      <td>times</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2011</td>
      <td>Massachusetts Institute of Technology</td>
      <td>3</td>
      <td>times</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2011</td>
      <td>Stanford University</td>
      <td>4</td>
      <td>times</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2011</td>
      <td>Princeton University</td>
      <td>5</td>
      <td>times</td>
    </tr>
  </tbody>
</table>
</div>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">top_5_df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>university_name</th>
      <th>world_rank</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4397</th>
      <td>2015</td>
      <td>Harvard University</td>
      <td>1</td>
      <td>shanghai</td>
    </tr>
    <tr>
      <th>4398</th>
      <td>2015</td>
      <td>Stanford University</td>
      <td>2</td>
      <td>shanghai</td>
    </tr>
    <tr>
      <th>4399</th>
      <td>2015</td>
      <td>Massachusetts Institute of Technology</td>
      <td>3</td>
      <td>shanghai</td>
    </tr>
    <tr>
      <th>4400</th>
      <td>2015</td>
      <td>University of California, Berkeley</td>
      <td>4</td>
      <td>shanghai</td>
    </tr>
    <tr>
      <th>4401</th>
      <td>2015</td>
      <td>University of Cambridge</td>
      <td>5</td>
      <td>shanghai</td>
    </tr>
  </tbody>
</table>
</div>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Compute the similarity</span>
<span class="k">def</span> <span class="nf">compute_set_similarity</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">pivoted</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="s1">&#39;world_rank&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;university_name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="n">set_simlarity</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="nb">len</span><span class="p">((</span><span class="nb">set</span><span class="p">(</span><span class="n">pivoted</span><span class="p">[</span><span class="s1">&#39;shanghai&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">pivoted</span><span class="p">[</span><span class="s1">&#39;times&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)))</span> <span class="o">/</span> <span class="mi">5</span>
    <span class="k">return</span> <span class="n">set_simlarity</span>

<span class="c1"># Group `top_5_df` by `year`    </span>
<span class="n">grouped_df</span> <span class="o">=</span> <span class="n">top_5_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;year&#39;</span><span class="p">)</span>

<span class="c1"># Use `compute_set_similarity` to construct a DataFrame</span>
<span class="n">setsimilarity_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;set_similarity&#39;</span><span class="p">:</span> <span class="n">grouped_df</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">compute_set_similarity</span><span class="p">)})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># Print the first rows of `setsimilarity_df`</span>
<span class="n">setsimilarity_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>set_similarity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2011</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2012</td>
      <td>40.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2013</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2014</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2015</td>
      <td>60.0</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="visualization">Visualization<a class="headerlink" href="#visualization" title="Permanent link">&para;</a></h2>
<h3 id="matplotlib">Matplotlib<a class="headerlink" href="#matplotlib" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Plot a scatterplot with `total_score` and `alumni`</span>
<span class="n">shanghai_df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s1">&#39;total_score&#39;</span><span class="p">,</span> <span class="s1">&#39;alumni&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><img alt="" src="../img/write_idiomatic/output_56_0.png" /></p>
<h3 id="remove-values">Remove values<a class="headerlink" href="#remove-values" title="Permanent link">&para;</a></h3>
<p>There are some 0 values for the alumni column (0, -, <code class="codehilite"><span class="n">NaN</span></code>, etc.). Remove them.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Replace `-` entries with NaN values</span>
<span class="n">times_df</span><span class="p">[</span><span class="s1">&#39;total_score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">times_df</span><span class="p">[</span><span class="s1">&#39;total_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;NaN&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>

<span class="c1"># Drop all rows with NaN values for `num_students` </span>
<span class="n">times_df</span> <span class="o">=</span> <span class="n">times_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;num_students&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>

<span class="c1"># Cast the remaining rows with `num_students` as int</span>
<span class="n">times_df</span><span class="p">[</span><span class="s1">&#39;num_students&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">times_df</span><span class="p">[</span><span class="s1">&#39;num_students&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Plot a scatterplot with `total_score` and `num_students`</span>
<span class="n">times_df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s1">&#39;total_score&#39;</span><span class="p">,</span> <span class="s1">&#39;num_students&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><img alt="" src="../img/write_idiomatic/output_59_0.png" /></p>
<h3 id="seaborn">Seaborn<a class="headerlink" href="#seaborn" title="Permanent link">&para;</a></h3>
<p>The Seaborn plotting tool is mainly used to create statistical plots that are visually appealing.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>

<span class="c1"># Set the Seaborn theme if desired</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s1">&#39;darkgrid&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Abbreviate country names of United States and United Kingdom</span>
<span class="n">times_df</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">times_df</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;United States of America&quot;</span><span class="p">,</span> <span class="s2">&quot;USA&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;United Kingdom&quot;</span><span class="p">,</span> <span class="s2">&quot;UK&quot;</span><span class="p">)</span>

<span class="c1"># Count the frequency of countries </span>
<span class="n">count</span> <span class="o">=</span> <span class="n">times_df</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[:</span><span class="mi">10</span><span class="p">]</span>

<span class="c1"># Convert the top 10 countries to a DataFrame </span>
<span class="n">df</span> <span class="o">=</span> <span class="n">count</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Reset the index </span>
<span class="c1">#df.reset_index(level=0, inplace=True)</span>
<span class="c1"># or...</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;index1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>

<span class="n">df</span>
</pre></div>
</td></tr></table>

<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>index1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>USA</th>
      <td>625</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>UK</th>
      <td>286</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>Germany</th>
      <td>150</td>
      <td>Germany</td>
    </tr>
    <tr>
      <th>Australia</th>
      <td>117</td>
      <td>Australia</td>
    </tr>
    <tr>
      <th>Canada</th>
      <td>108</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>Japan</th>
      <td>98</td>
      <td>Japan</td>
    </tr>
    <tr>
      <th>Italy</th>
      <td>94</td>
      <td>Italy</td>
    </tr>
    <tr>
      <th>China</th>
      <td>82</td>
      <td>China</td>
    </tr>
    <tr>
      <th>Netherlands</th>
      <td>75</td>
      <td>Netherlands</td>
    </tr>
    <tr>
      <th>France</th>
      <td>73</td>
      <td>France</td>
    </tr>
  </tbody>
</table>
</div>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Rename the columns</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span><span class="p">,]</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Plot a barplot with `country` and `count`</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><img alt="" src="../img/write_idiomatic/output_65_0.png" /></p>
<h3 id="filter-rows">Filter rows<a class="headerlink" href="#filter-rows" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">times_df_filtered</span> <span class="o">=</span> <span class="n">times_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">times_df</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;USA&#39;</span><span class="p">,</span> <span class="s1">&#39;UK&#39;</span><span class="p">,</span> <span class="s1">&#39;Canada&#39;</span><span class="p">,</span> <span class="s1">&#39;Australia&#39;</span><span class="p">,</span> <span class="s1">&#39;Germany&#39;</span><span class="p">])]</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Barplot with `country` and `total_score`</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;total_score&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">times_df_filtered</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">despine</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><img alt="" src="../img/write_idiomatic/output_68_0.png" /></p>
<h3 id="correlation">Correlation<a class="headerlink" href="#correlation" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">{</span><span class="s1">&#39;divide&#39;</span><span class="p">:</span> <span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="s1">&#39;invalid&#39;</span><span class="p">:</span> <span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="s1">&#39;over&#39;</span><span class="p">:</span> <span class="s1">&#39;warn&#39;</span><span class="p">,</span> <span class="s1">&#39;under&#39;</span><span class="p">:</span> <span class="s1">&#39;ignore&#39;</span><span class="err">}</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">times_df</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><img alt="" src="../img/write_idiomatic/output_71_0.png" /></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">times_df_filtered</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;total_score&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">2015</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span>
<span class="n">g</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><img alt="" src="../img/write_idiomatic/output_72_0.png" /></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)</span>

<span class="c1"># Compute the correlation matrix</span>
<span class="n">corr</span> <span class="o">=</span> <span class="n">times_df</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="c1"># Generate a mask for the upper triangle</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
<span class="n">mask</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">mask</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c1"># Set up the matplotlib figure</span>
<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="c1"># Generate a custom diverging colormap</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">diverging_palette</span><span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># Draw the heatmap with the mask and correct aspect ratio</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=.</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">square</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><img alt="" src="../img/write_idiomatic/output_73_0.png" /></p>
<h2 id="to-go-beyond">To go beyond<a class="headerlink" href="#to-go-beyond" title="Permanent link">&para;</a></h2>
<p>with <a href="http://jakevdp.github.io/blog/2017/03/22/group-by-from-scratch/">groupby</a>.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../viewing_3d_volumetric_data_with_matplotlib/" title="Viewing 3D Volumetric Data with Matplotlib" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Viewing 3D Volumetric Data with Matplotlib
              </span>
            </div>
          </a>
        
        
          <a href="../apprenez_a_programmer_en_python/" title="Apprenez à programmer en Python" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Apprenez à programmer en Python
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c648116f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>