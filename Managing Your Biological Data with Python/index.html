



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A Python documentation website.">
      
      
        <link rel="canonical" href="https://ugoproto.github.io/ugo_py_doc/Managing Your Biological Data with Python/">
      
      
        <meta name="author" content="Ugo Sparks">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.0">
    
    
      
        <title>Managing Your Biological Data with Python - ugo_py_doc</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700|Ubuntu+Mono">
        <style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="yellow" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#chapter-1-the-python-shell-and-basics" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://ugoproto.github.io/ugo_py_doc/" title="ugo_py_doc" class="md-header-nav__button md-logo">
          
            <i class="md-icon">layers</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                ugo_py_doc
              </span>
              <span class="md-header-nav__topic">
                Managing Your Biological Data with Python
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/ugoproto/ugo_r_doc.git/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      ugo_py_doc
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon">layers</i>
      
    </span>
    ugo_py_doc
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/ugoproto/ugo_r_doc.git/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      ugo_py_doc
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Basics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Basics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Py_CS/" title="Python Cheat Sheets" class="md-nav__link">
      Python Cheat Sheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python_Preliminaries/" title="Python Preliminaries" class="md-nav__link">
      Python Preliminaries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python_Nice_to_Have/" title="Python Nice to Have" class="md-nav__link">
      Python Nice to Have
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Freeze_the_Code/" title="Freeze the Code" class="md-nav__link">
      Freeze the Code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Decorators/" title="Decorators" class="md-nav__link">
      Decorators
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Write_Better_Python/" title="Write Better Python with PEP" class="md-nav__link">
      Write Better Python with PEP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Regex/" title="Regular Expressions (regex)" class="md-nav__link">
      Regular Expressions (regex)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Databases/" title="Databases" class="md-nav__link">
      Databases
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Datetime/" title="Datetime" class="md-nav__link">
      Datetime
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Gedit_Execute_Highlighted_Python_Code/" title="Gedit, Execute Highlighted Python Code" class="md-nav__link">
      Gedit, Execute Highlighted Python Code
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Scipy Stack
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Scipy Stack
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Scipy_CS/" title="Scipy Stack Cheat Sheets" class="md-nav__link">
      Scipy Stack Cheat Sheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../JN_CS/" title="Jupyter Notebook Cheat Sheets" class="md-nav__link">
      Jupyter Notebook Cheat Sheets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Scientific Python/" title="Scientific Python" class="md-nav__link">
      Scientific Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Importing Data into Python/" title="Importing Data into Python" class="md-nav__link">
      Importing Data into Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python for Data Science/" title="Python for Data Science" class="md-nav__link">
      Python for Data Science
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Tidy_Data_in_Python/" title="Tidy Data in Python" class="md-nav__link">
      Tidy Data in Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Lists/" title="Lists" class="md-nav__link">
      Lists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../IPython Notebook/" title="IPython Notebook, Collection" class="md-nav__link">
      IPython Notebook, Collection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python Numpy Arrays/" title="Python Numpy Arrays" class="md-nav__link">
      Python Numpy Arrays
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Vectors and Arrays (Linear Algebra)/" title="Vectors and Arrays (Linear Algebra)" class="md-nav__link">
      Vectors and Arrays (Linear Algebra)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Matplotlib, Python Plotting/" title="Matplotlib, Python Plotting" class="md-nav__link">
      Matplotlib, Python Plotting
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Viewing+3D+Volumetric+Data+With+Matplotlib/" title="Viewing 3D Volumetric Data with Matplotlib" class="md-nav__link">
      Viewing 3D Volumetric Data with Matplotlib
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Seaborn, Python Statistical Data Visualization Library/" title="Seaborn, Python's Statistical Data Visualization Library" class="md-nav__link">
      Seaborn, Python's Statistical Data Visualization Library
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Pandas+DataFrames/" title="Pandas DataFrames" class="md-nav__link">
      Pandas DataFrames
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Write Idiomatic Pandas Code/" title="Write Idiomatic Pandas Code" class="md-nav__link">
      Write Idiomatic Pandas Code
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Exploratory Data Analysis/" title="Exploratory Data Analysis (EDA)" class="md-nav__link">
      Exploratory Data Analysis (EDA)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Intro to data.world in Python/" title="Intro to data.world in Python" class="md-nav__link">
      Intro to data.world in Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python+And+Excel/" title="Python and Excel" class="md-nav__link">
      Python and Excel
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Overview_of_scikit-learn/" title="Overview of scikit-learn" class="md-nav__link">
      Overview of scikit-learn
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../k-NN_Linear_regression_Logit_Scaling_Centering_Noise/" title="k-NN, Linear regression, Logit, Scaling, Centering, Noise" class="md-nav__link">
      k-NN, Linear regression, Logit, Scaling, Centering, Noise
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Time_Series_Analysis/" title="Time Series Analysis" class="md-nav__link">
      Time Series Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Sentiment_Analysis_with_Twitter/" title="Sentiment Analysis with Twitter" class="md-nav__link">
      Sentiment Analysis with Twitter
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../EDA_Machine_Learning_Feature_Engineering_and_Kaggle/" title="EDA, Machine Learning, Feature Engineering, and Kaggle" class="md-nav__link">
      EDA, Machine Learning, Feature Engineering, and Kaggle
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Courses
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Courses
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Apprenez a programmer en Python/" title="Apprenez à programmer en Python" class="md-nav__link">
      Apprenez à programmer en Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Codecademy Python/" title="Codecademy Python" class="md-nav__link">
      Codecademy Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Learn Python the Hard Way/" title="Learn Python the Hard Way" class="md-nav__link">
      Learn Python the Hard Way
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../LPTHW, Python Code Snippets/" title="LPTHW, Python Code Snippets" class="md-nav__link">
      LPTHW, Python Code Snippets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Introduction to Python/" title="Introduction to Python" class="md-nav__link">
      Introduction to Python
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Manuals
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Manuals
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Automate the Boring Stuff with Python/" title="Automate the Boring Stuff with Python" class="md-nav__link">
      Automate the Boring Stuff with Python
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Real_Python/" title="Real Python" class="md-nav__link">
      Real Python
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Managing Your Biological Data with Python
      </label>
    
    <a href="./" title="Managing Your Biological Data with Python" class="md-nav__link md-nav__link--active">
      Managing Your Biological Data with Python
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chapter-1-the-python-shell-and-basics" title="Chapter 1, The Python Shell and Basics" class="md-nav__link">
    Chapter 1, The Python Shell and Basics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-2-your-first-python-program" title="Chapter 2, Your First Python Program" class="md-nav__link">
    Chapter 2, Your First Python Program
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-2-data-management" title="Part 2, Data management" class="md-nav__link">
    Part 2, Data management
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-3-analyzing-a-data-column" title="Chapter 3, Analyzing a Data Column" class="md-nav__link">
    Chapter 3, Analyzing a Data Column
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-4-parsing-data-records" title="Chapter 4, Parsing Data Records" class="md-nav__link">
    Chapter 4, Parsing Data Records
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-5-searching-data" title="Chapter 5, Searching Data" class="md-nav__link">
    Chapter 5, Searching Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-6-filtering-data" title="Chapter 6, Filtering Data" class="md-nav__link">
    Chapter 6, Filtering Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-7-managing-tabular-data" title="Chapter 7, Managing Tabular Data" class="md-nav__link">
    Chapter 7, Managing Tabular Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-8-sorting-data" title="Chapter 8, Sorting Data" class="md-nav__link">
    Chapter 8, Sorting Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-9-pattern-matching-and-text-mining" title="Chapter 9, Pattern Matching and Text Mining" class="md-nav__link">
    Chapter 9, Pattern Matching and Text Mining
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-3-modular-programming" title="Part 3, Modular Programming" class="md-nav__link">
    Part 3, Modular Programming
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-10-divide-a-program-into-functions" title="Chapter 10, Divide a Program into Functions" class="md-nav__link">
    Chapter 10, Divide a Program into Functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-11-managing-complexity-with-classes" title="Chapter 11 Managing Complexity with Classes" class="md-nav__link">
    Chapter 11 Managing Complexity with Classes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-12-debugging" title="Chapter 12 Debugging" class="md-nav__link">
    Chapter 12 Debugging
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-13-using-external-modules-the-python-interface-to-r" title="Chapter 13, Using External Modules, The Python Interface to R" class="md-nav__link">
    Chapter 13, Using External Modules, The Python Interface to R
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-14-building-program-pipelines" title="Chapter 14, Building Program Pipelines" class="md-nav__link">
    Chapter 14, Building Program Pipelines
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-15-writing-good-programs" title="Chapter 15, Writing Good Programs" class="md-nav__link">
    Chapter 15, Writing Good Programs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-4-data-visualization" title="Part 4, Data Visualization" class="md-nav__link">
    Part 4, Data Visualization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-16-creating-scientific-diagrams" title="Chapter 16, Creating Scientific Diagrams" class="md-nav__link">
    Chapter 16, Creating Scientific Diagrams
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-18-manipulating-images" title="Chapter 18, Manipulating Images" class="md-nav__link">
    Chapter 18, Manipulating Images
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-6-cookbook" title="Part 6, Cookbook" class="md-nav__link">
    Part 6, Cookbook
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recipe-2-reversing-and-randomizing-a-sequence" title="Recipe 2, Reversing and Randomizing a Sequence" class="md-nav__link">
    Recipe 2, Reversing and Randomizing a Sequence
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recipe-3-creating-a-random-sequence-with-probabilities" title="Recipe 3, Creating a Random Sequence with Probabilities" class="md-nav__link">
    Recipe 3, Creating a Random Sequence with Probabilities
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Python for Education/" title="Python for Education" class="md-nav__link">
      Python for Education
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#chapter-1-the-python-shell-and-basics" title="Chapter 1, The Python Shell and Basics" class="md-nav__link">
    Chapter 1, The Python Shell and Basics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-2-your-first-python-program" title="Chapter 2, Your First Python Program" class="md-nav__link">
    Chapter 2, Your First Python Program
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-2-data-management" title="Part 2, Data management" class="md-nav__link">
    Part 2, Data management
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-3-analyzing-a-data-column" title="Chapter 3, Analyzing a Data Column" class="md-nav__link">
    Chapter 3, Analyzing a Data Column
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-4-parsing-data-records" title="Chapter 4, Parsing Data Records" class="md-nav__link">
    Chapter 4, Parsing Data Records
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-5-searching-data" title="Chapter 5, Searching Data" class="md-nav__link">
    Chapter 5, Searching Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-6-filtering-data" title="Chapter 6, Filtering Data" class="md-nav__link">
    Chapter 6, Filtering Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-7-managing-tabular-data" title="Chapter 7, Managing Tabular Data" class="md-nav__link">
    Chapter 7, Managing Tabular Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-8-sorting-data" title="Chapter 8, Sorting Data" class="md-nav__link">
    Chapter 8, Sorting Data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-9-pattern-matching-and-text-mining" title="Chapter 9, Pattern Matching and Text Mining" class="md-nav__link">
    Chapter 9, Pattern Matching and Text Mining
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-3-modular-programming" title="Part 3, Modular Programming" class="md-nav__link">
    Part 3, Modular Programming
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-10-divide-a-program-into-functions" title="Chapter 10, Divide a Program into Functions" class="md-nav__link">
    Chapter 10, Divide a Program into Functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-11-managing-complexity-with-classes" title="Chapter 11 Managing Complexity with Classes" class="md-nav__link">
    Chapter 11 Managing Complexity with Classes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-12-debugging" title="Chapter 12 Debugging" class="md-nav__link">
    Chapter 12 Debugging
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-13-using-external-modules-the-python-interface-to-r" title="Chapter 13, Using External Modules, The Python Interface to R" class="md-nav__link">
    Chapter 13, Using External Modules, The Python Interface to R
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-14-building-program-pipelines" title="Chapter 14, Building Program Pipelines" class="md-nav__link">
    Chapter 14, Building Program Pipelines
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-15-writing-good-programs" title="Chapter 15, Writing Good Programs" class="md-nav__link">
    Chapter 15, Writing Good Programs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-4-data-visualization" title="Part 4, Data Visualization" class="md-nav__link">
    Part 4, Data Visualization
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-16-creating-scientific-diagrams" title="Chapter 16, Creating Scientific Diagrams" class="md-nav__link">
    Chapter 16, Creating Scientific Diagrams
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-18-manipulating-images" title="Chapter 18, Manipulating Images" class="md-nav__link">
    Chapter 18, Manipulating Images
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-6-cookbook" title="Part 6, Cookbook" class="md-nav__link">
    Part 6, Cookbook
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recipe-2-reversing-and-randomizing-a-sequence" title="Recipe 2, Reversing and Randomizing a Sequence" class="md-nav__link">
    Recipe 2, Reversing and Randomizing a Sequence
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recipe-3-creating-a-random-sequence-with-probabilities" title="Recipe 3, Creating a Random Sequence with Probabilities" class="md-nav__link">
    Recipe 3, Creating a Random Sequence with Probabilities
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ugoproto/ugo_r_doc.git/edit/master/docs/Managing Your Biological Data with Python.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Managing Your Biological Data with Python</h1>
                
                <div class="toc"><span class="toctitle">CONTENT</span><ul>
<li><a href="#part-1-getting-started">Part 1, Getting Started</a></li>
<li><a href="#chapter-1-the-python-shell-and-basics">Chapter 1, The Python Shell and Basics</a></li>
<li><a href="#chapter-2-your-first-python-program">Chapter 2, Your First Python Program</a></li>
<li><a href="#part-2-data-management">Part 2, Data management</a></li>
<li><a href="#chapter-3-analyzing-a-data-column">Chapter 3, Analyzing a Data Column</a></li>
<li><a href="#chapter-4-parsing-data-records">Chapter 4, Parsing Data Records</a></li>
<li><a href="#chapter-5-searching-data">Chapter 5, Searching Data</a></li>
<li><a href="#chapter-6-filtering-data">Chapter 6, Filtering Data</a></li>
<li><a href="#chapter-7-managing-tabular-data">Chapter 7, Managing Tabular Data</a></li>
<li><a href="#chapter-8-sorting-data">Chapter 8, Sorting Data</a></li>
<li><a href="#chapter-9-pattern-matching-and-text-mining">Chapter 9, Pattern Matching and Text Mining</a></li>
<li><a href="#part-3-modular-programming">Part 3, Modular Programming</a></li>
<li><a href="#chapter-10-divide-a-program-into-functions">Chapter 10, Divide a Program into Functions</a></li>
<li><a href="#chapter-11-managing-complexity-with-classes">Chapter 11 Managing Complexity with Classes</a></li>
<li><a href="#chapter-12-debugging">Chapter 12 Debugging</a></li>
<li><a href="#chapter-13-using-external-modules-the-python-interface-to-r">Chapter 13, Using External Modules, The Python Interface to R</a></li>
<li><a href="#chapter-14-building-program-pipelines">Chapter 14, Building Program Pipelines</a></li>
<li><a href="#chapter-15-writing-good-programs">Chapter 15, Writing Good Programs</a></li>
<li><a href="#part-4-data-visualization">Part 4, Data Visualization</a></li>
<li><a href="#chapter-16-creating-scientific-diagrams">Chapter 16, Creating Scientific Diagrams</a></li>
<li><a href="#chapter-18-manipulating-images">Chapter 18, Manipulating Images</a></li>
<li><a href="#part-6-cookbook">Part 6, Cookbook</a></li>
<li><a href="#recipe-2-reversing-and-randomizing-a-sequence">Recipe 2, Reversing and Randomizing a Sequence</a></li>
<li><a href="#recipe-3-creating-a-random-sequence-with-probabilities">Recipe 3, Creating a Random Sequence with Probabilities</a></li>
</ul>
</div>
<hr />
<p><strong>Foreword</strong></p>
<p>Notes and code snippets. Python 2. The book comes with files and cases. Python 2. From CRC Press, 2014.</p>
<hr />
<h4 id="part-1-getting-started">Part 1, Getting Started<a class="headerlink" href="#part-1-getting-started" title="Permanent link">&para;</a></h4>
<h4 id="chapter-1-the-python-shell-and-basics">Chapter 1, The Python Shell and Basics<a class="headerlink" href="#chapter-1-the-python-shell-and-basics" title="Permanent link">&para;</a></h4>
<p><strong>Data structure</strong></p>
<ul>
<li>Booleans: <code class="codehilite">True</code> or <code class="codehilite">False</code>.</li>
<li>Dictionaries: unordered collections of key-value pairs; both can be numbers or strings; indicated with <code class="codehilite">{key1: value1, &#39;key2&#39;: &#39;value2&#39;}</code>.</li>
<li>Floats: numbers with digits after the dicemal point,</li>
<li>Integers: numbers without digits after the decimal point.</li>
<li>Lists: mutable ordered collections of objects; indicated with <code class="codehilite">[a, b, c]</code>.</li>
<li>Sets: immutable unordered collections of unique elements; indicated by <code class="codehilite">([a, b, c])</code>.</li>
<li>Strings: immutable ordered collections of characters; indicated with <code class="codehilite">&#39;single&#39;</code> or <code class="codehilite">&quot;double&quot;</code> quotation marks.</li>
<li>Tuples: immutable ordered collections of objects; indicated with <code class="codehilite">(a, b, c)</code>.</li>
</ul>
<p><strong>Conversions</strong></p>
<p>Convert or coerce data:<br />
- <code class="codehilite">float(value)</code>; into a float.<br />
- <code class="codehilite">int(value)</code>; into an integer.<br />
- <code class="codehilite">str(value)</code>; into a string.</p>
<p><strong>Strings</strong></p>
<p><code class="codehilite">&#39;Single&#39;</code> and <code class="codehilite">&quot;double&quot;</code> quotes are for short strings.</p>
<p>&rsquo;&lsquo;&rsquo;Triple single and double quotes<br />
are rather multilines.&rsquo;&lsquo;&rsquo;</p>
<p><strong>Access character and substrings</strong></p>
<ul>
<li><code class="codehilite">print s[-1]</code>; print the last character of a string.</li>
<li><code class="codehilite">print s[-5:]</code>; print from the 5<sup>th</sup> position from the end to the end.</li>
</ul>
<p><strong>String functions</strong></p>
<ul>
<li><code class="codehilite">len(s)</code>; length of the string,</li>
<li><code class="codehilite">s.upper()</code>; convert to uppercase.</li>
<li><code class="codehilite">s.lower()</code>; convert to lowercase.</li>
<li><code class="codehilite">s.strip()</code>; remove white spaces and tabs from both ends.</li>
<li><code class="codehilite">s.strio(&#39;m&#39;)</code>; remove <code class="codehilite">&#39;m&#39;</code> from both ends.</li>
<li><code class="codehilite">s.rstrip()</code>; remove on the right only.</li>
<li><code class="codehilite">s.lstrip(&#39;m&#39;)</code>; remove on the left only.</li>
<li><code class="codehilite">s.split(&#39; &#39;)</code>; cut into words where there is space.</li>
<li><code class="codehilite">s.find(&#39;m&#39;)</code>; search for the <code class="codehilite">&#39;m&#39;</code> substring and return the starting position.</li>
<li><code class="codehilite">s.replace(&#39;m&#39;, &#39;n&#39;)</code>; replace <code class="codehilite">&#39;m&#39;</code> with <code class="codehilite">&#39;n&#39;</code>.</li>
<li><code class="codehilite">s.startwith(&#39;m&#39;)</code>; check beginning and return <code class="codehilite">True</code> or <code class="codehilite">False</code>.</li>
<li><code class="codehilite">s.endwith(&#39;m&#39;)</code>; check end and return <code class="codehilite">True</code> or <code class="codehilite">False</code>.</li>
</ul>
<p><strong>Create lists</strong></p>
<ul>
<li><code class="codehilite">data = [1, 2, 3, 4, 5]</code>.</li>
<li><code class="codehilite">data[1:3]</code>; <code class="codehilite">[2, 3]</code>.</li>
<li><code class="codehilite">data[0:2]</code>; <code class="codehilite">[1, 2]</code>.</li>
<li><code class="codehilite">data[:3]</code>; <code class="codehilite">[1, 2, 3]</code>.</li>
<li><code class="codehilite">data[-2:]</code>; <code class="codehilite">[4, 5]</code>.</li>
<li><code class="codehilite">data2 = data[:]</code>; create a copy.</li>
</ul>
<p><strong>Modify lists</strong></p>
<ul>
<li><code class="codehilite">l[i] = x</code>; replace the i<sup>th</sup> element with <code class="codehilite">x</code>.</li>
<li><code class="codehilite">l[i;j] = t</code>; replace elements from <code class="codehilite">i</code> to <code class="codehilite">j</code> by <code class="codehilite">t</code> (iterable).</li>
<li><code class="codehilite">del l[i;j]</code>; delete the elements of the list from <code class="codehilite">i</code> to <code class="codehilite">j</code>.</li>
<li><code class="codehilite">del s[i;k;k]</code>; delete the elements of the list from <code class="codehilite">i</code> to <code class="codehilite">j</code> with stop <code class="codehilite">k</code>.</li>
<li><code class="codehilite">l.append(x)</code>; add element <code class="codehilite">x</code> to the list.</li>
<li><code class="codehilite">l.extend(x)</code>; add several element <code class="codehilite">x</code> to the list (iterable).</li>
<li><code class="codehilite">l.count(x)</code>; return the number of elements <code class="codehilite">x</code> in the list.</li>
<li><code class="codehilite">l.index(x[. i[. j]])</code>; return the smaller <code class="codehilite">k</code> such that <code class="codehilite">l[k] = x</code> and <code class="codehilite">i &lt;= k &lt;= j</code>.</li>
<li><code class="codehilite">l.insert(i.x)</code>; insert(wedge in) <code class="codehilite">x</code>.</li>
<li><code class="codehilite">l.pop(i)</code>; cancel the ith element and return its value; <code class="codehilite">l.pop()</code> does it for the last element.</li>
<li><code class="codehilite">l.remove(x)</code>; delete a choosen <code class="codehilite">x</code> element.</li>
<li><code class="codehilite">l.reverse()</code>; reverse the list order.</li>
<li><code class="codehilite">l.sort()</code>; sort the list.</li>
<li><code class="codehilite">l.sort([cmp[. key[. reverse]]])</code>; sort the list; <code class="codehilite">cmp</code> is a customized function for the comparison of element pairs that must return a negative value, zero, or a positive value depending on if the first element of the pair is lower than. equal to. or greater than the second element.</li>
<li><code class="codehilite">sorted(l)</code>; create a new list made of a simple ascending sort of the list without modifying the list.</li>
</ul>
<p><strong>Functions working of lists</strong></p>
<ul>
<li><code class="codehilite">len(data)</code>; length of the list.</li>
<li><code class="codehilite">min(data)</code>; smallest.</li>
<li><code class="codehilite">max(data)</code>; largest.</li>
<li><code class="codehilite">sum(data)</code>; sum.</li>
<li><code class="codehilite">range(4)</code>; create a list of number from 0 to 3.</li>
<li><code class="codehilite">range(1.5)</code>; create a list of number from 1 to 4.</li>
<li><code class="codehilite">range(2.9.2)</code>; create <code class="codehilite">[2, 4, 6, 8]</code>.</li>
<li><code class="codehilite">range(5, 0, -1)</code>; create <code class="codehilite">[5, 4, 3, 2, 1]</code></li>
</ul>
<p><strong>Tuples</strong></p>
<ul>
<li><code class="codehilite">t = 1, 2, 3</code> or <code class="codehilite">t = (1, 2, 3)</code></li>
<li><code class="codehilite">t = 1</code> or <code class="codehilite">tuple = (1,)</code></li>
</ul>
<p><strong>Accessing data in dictionaries</strong></p>
<ul>
<li><code class="codehilite">prices[&#39;banana&#39;]</code>; return the value of the key.</li>
<li><code class="codehilite">prices.get(&#39;banaba&#39;)</code>; do the same thing, but if the key does not exit, it returns <code class="codehilite">None</code>.</li>
<li><code class="codehilite">prices.has_key(&#39;apple&#39;)</code>; check whether the key(s) is(are) defined.</li>
<li><code class="codehilite">prices.keys()</code>; return a list of all keys.</li>
<li><code class="codehilite">prices.values()</code>; return a list of all values.</li>
<li><code class="codehilite">prices.items()</code>; return all keys and values as a list of tuples.</li>
</ul>
<p><strong>Modifying dictionaries</strong></p>
<ul>
<li><code class="codehilite">prices[&#39;kiwi&#39;] = 0.6</code>; set the value of the key.</li>
<li><code class="codehilite">prices.setdefault(&#39;egg&#39;, 0.9)</code>; set the value of the key if it is not yet defined.</li>
</ul>
<p><strong>None</strong></p>
<p>None indicate the object or part of it is empty. For example:<br />
- <code class="codehilite">a = None</code>.<br />
- <code class="codehilite">b = [None, None, &#39;green&#39;]</code>.</p>
<h4 id="chapter-2-your-first-python-program">Chapter 2, Your First Python Program<a class="headerlink" href="#chapter-2-your-first-python-program" title="Permanent link">&para;</a></h4>
<p><strong>Difference between functions and methods</strong></p>
<p>Functions are generic; use them anywhere without constraints. For example, <code class="codehilite">len()</code> works on all data.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="s1">&#39;protein&#39;</span><span class="p">)</span>
<span class="mi">7</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="s1">&#39;111&#39;</span><span class="p">)</span>
<span class="mi">3</span>
</pre></div>
</td></tr></table>

<p>Other funtions, called methods, are specific; use them on a certain type of data. For example, <code class="codehilite">count()</code> works only for strings or a &lsquo;string&rsquo; variable (below, <code class="codehilite">protein</code> is a string).</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;protein&#39;</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;occurence&#39;</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="mi">3</span>
</pre></div>
</td></tr></table>

<p><strong>Count the occurrence of each amino acid in a protein sequence</strong></p>
<p><sub>count, element, in, string</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">insulin</span> <span class="o">=</span> <span class="s2">&quot;GIVEQCCTSICSLYQLENYCNFVNQHLCGSHLVEALYLVCGERGFFYTPKT&quot;</span>

<span class="k">for</span> <span class="n">amino_acid</span> <span class="ow">in</span> <span class="s2">&quot;ACDEFGHIKLMNPQRSTVWY&quot;</span><span class="p">:</span>
    <span class="n">number</span> <span class="o">=</span> <span class="n">insulin</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">amino_acid</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">amino_acid</span><span class="p">,</span> <span class="n">number</span>
</pre></div>
</td></tr></table>

<p><strong>Create a random DNA sequence of length 10</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="n">alphabet</span> <span class="o">=</span> <span class="s2">&quot;AGCT&quot;</span>
<span class="n">sequence</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">sequence</span> <span class="o">=</span> <span class="n">sequence</span> <span class="o">+</span> <span class="n">alphabet</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

<span class="k">print</span> <span class="n">sequence</span>
</pre></div>
</td></tr></table>

<h4 id="part-2-data-management">Part 2, Data management<a class="headerlink" href="#part-2-data-management" title="Permanent link">&para;</a></h4>
<h4 id="chapter-3-analyzing-a-data-column">Chapter 3, Analyzing a Data Column<a class="headerlink" href="#chapter-3-analyzing-a-data-column" title="Permanent link">&para;</a></h4>
<p><strong>Read from a text file</strong></p>
<ul>
<li><code class="codehilite">readlines()</code>.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">text_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;neuron_data.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="c1"># &#39;r&#39; is facultative</span>

<span class="n">lines</span> <span class="o">=</span> <span class="n">text_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

<span class="n">text_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">print</span> <span class="n">lines</span>
</pre></div>
</td></tr></table>

<ul>
<li><code class="codehilite">read()</code>. </li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">text_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;neuron_data.txt&#39;</span><span class="p">)</span>
<span class="c1"># &#39;r&#39; is facultative</span>

<span class="k">print</span> <span class="n">text_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">text_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><strong>Difference between <code class="codehilite">read()</code> and <code class="codehilite">readlines()</code></strong></p>
<ul>
<li><code class="codehilite">read(x)</code>; read up to x bytes in a file. If you don&rsquo;t supply the size, it reads the entire file. The output is displayed as strings only once.</li>
<li>One character = 1 byte.</li>
<li>Close and reopen the file to read it again.</li>
<li><code class="codehilite">readlines(x)</code>; read up to x bytes. If you don&rsquo;t supply a size, it reads all the data until it reaches a newline (<code class="codehilite">\n</code>) or the end of a paragraph.</li>
<li>Close and reopen the file to read it again.</li>
</ul>
<p><strong>Write a text file</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;counts.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="c1"># &#39;w&#39; is mandatory</span>

<span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;number of neuron lengths: 7</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><strong>Clean a text file</strong></p>
<p><sub>strip</sub></p>
<ul>
<li><code class="codehilite">strip()</code>; removes blanks spaces.</li>
<li><code class="codehilite">rstrip()</code>; right only.</li>
<li><code class="codehilite">lstrip()</code>; left only.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;counts.txt&#39;</span><span class="p">)</span>
<span class="n">output_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># vs</span>

<span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;counts.txt&#39;</span><span class="p">)</span>
<span class="n">output_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><strong>Write and then read the same file</strong></p>
<ul>
<li><code class="codehilite">&#39;r&#39;</code>; cannot write with, only reads.</li>
<li><code class="codehilite">&#39;w&#39;</code>; cannot read with, only writes (an existing file with the same name will be erased).</li>
<li><code class="codehilite">&#39;a&#39;</code> append; data added to the end. </li>
<li><code class="codehilite">&#39;r+&#39;</code>; both read and write (by replacing the existing string at the beginning by the new string).</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">file1</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;count.txt&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">file1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;this is just a dummy test</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">file1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">file2</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;count.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">file2</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">file2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">file3</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;count.txt&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">file3</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;this is another test</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">file3</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">file4</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;count.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">file4</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">file4</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">file5</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;count.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">file5</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;this is a final test</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">file5</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">file6</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;count.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">file6</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">file6</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><strong>Read a series of numbers from a text file and print a summary of the data</strong></p>
<p><sub>strip, append, length, minimum, maximum, sort, format, integer, float</sub></p>
<ul>
<li><code class="codehilite">strip()</code>; remove blank spaces.</li>
<li>A text is string by default even thought the file contains numbers; transform the text into float.</li>
<li><code class="codehilite">append()</code>; each line to a list.</li>
<li><code class="codehilite">len(data)</code>.</li>
<li><code class="codehilite">sum(data)</code>.</li>
<li><code class="codehilite">min(data)</code>.</li>
<li><code class="codehilite">max(data)</code>.</li>
<li><code class="codehilite">sort()</code>.</li>
<li><code class="codehilite"><span class="c">%4i</span></code> is an integer with 4 digits.</li>
<li><code class="codehilite"><span class="c">%6.1f</span></code> is a float with 6 digits and 2 decimals.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;neuron_data.txt&#39;</span><span class="p">):</span>
    <span class="n">length</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>

<span class="n">n_items</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">shortest</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">longest</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>


<span class="n">output</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;results.txt&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>

<span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;number of dendritic lengths : </span><span class="si">%4i</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">n_items</span><span class="p">))</span>
<span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;total dendritic length      : </span><span class="si">%6.1f</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">total</span><span class="p">))</span>
<span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;shortest dendritic length   : </span><span class="si">%7.2f</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">shortest</span><span class="p">))</span>
<span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;longest dendritic length    : </span><span class="si">%7.2f</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">longest</span><span class="p">))</span>
<span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%37.2f</span><span class="se">\n</span><span class="si">%37.2f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]))</span>

<span class="n">output</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><strong>Format the data</strong></p>
<p><sub>formatting, variable</sub></p>
<ul>
<li><code class="codehilite"><span class="nf">%s</span></code>; a string.</li>
<li><code class="codehilite"><span class="nf">%d</span></code>; a digit.</li>
<li><code class="codehilite"><span class="nf">%r</span></code>; raw data.</li>
<li><code class="codehilite"><span class="c">%10s</span></code>; left-justify by 10 bytes.</li>
<li><code class="codehilite"><span class="c">%-10s</span></code>; right-justify. by bytes</li>
<li><code class="codehilite"><span class="nf">%i</span></code>; an integer.</li>
<li><code class="codehilite"><span class="nf">%f</span></code>; a float.</li>
<li><code class="codehilite"><span class="c">%2f</span></code>; a float with 2 digits.</li>
<li><code class="codehilite"><span class="c">%2.2f</span></code>; has 2 digits and 2 decimals.</li>
<li><code class="codehilite"><span class="c">%2i</span></code>; has 2 digits.</li>
<li>And so on.</li>
<li><code class="codehilite">str()</code>; turn a variable into a string (digit <code class="codehilite">3</code> to string <code class="codehilite">&#39;3&#39;</code> for example).</li>
<li><code class="codehilite">int()</code>; turn a variable into an integer (string <code class="codehilite">&#39;3&#39;</code> to digit <code class="codehilite">3</code> for example).</li>
<li><code class="codehilite">float()</code>; turn a variable into a float (digit <code class="codehilite">3</code> to <code class="codehilite">3.0</code> for example).</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">file1</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;count.txt&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">file1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;this is just a dummy test&#39;</span><span class="p">)</span>
<span class="n">file1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">file2</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;count.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">variable</span> <span class="o">=</span> <span class="n">file2</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="k">print</span> <span class="s2">&quot;Test1: </span><span class="si">%r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">variable</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Test2: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">variable</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Test3: </span><span class="si">%30s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">variable</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Test4: </span><span class="si">%-30s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">variable</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Test5: </span><span class="si">%30r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">variable</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Test6: </span><span class="si">%-30r</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">variable</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Test7: </span><span class="si">%d</span><span class="s2">, </span><span class="si">%d</span><span class="s2">, </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Test8: </span><span class="si">%2d</span><span class="s2">, </span><span class="si">%3d</span><span class="s2">, </span><span class="si">%10d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Test9: </span><span class="si">%d</span><span class="s2">, </span><span class="si">%i</span><span class="s2">, </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Test10: </span><span class="si">%i</span><span class="s2">, </span><span class="si">%i</span><span class="s2">, </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">,</span> <span class="mf">3.1416</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Test11: </span><span class="si">%2i</span><span class="s2">, </span><span class="si">%5i</span><span class="s2">, </span><span class="si">%10i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">,</span> <span class="mf">3.1416</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Test12: </span><span class="si">%f</span><span class="s2">, </span><span class="si">%f</span><span class="s2">, </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">,</span> <span class="mf">3.1416</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Test13: </span><span class="si">%2f</span><span class="s2">, </span><span class="si">%2.2f</span><span class="s2">, </span><span class="si">%10.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">,</span> <span class="mf">3.1416</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Test14: </span><span class="si">%2f</span><span class="s2">, </span><span class="si">%2f</span><span class="s2">, </span><span class="si">%2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mf">0.11</span><span class="p">,</span> <span class="mf">10.111</span><span class="p">,</span> <span class="mf">1000.1111</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;Test15: </span><span class="si">%2.1f</span><span class="s2">, </span><span class="si">%2.1f</span><span class="s2">, </span><span class="si">%2.10f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="mf">0.11</span><span class="p">,</span> <span class="mf">10.111</span><span class="p">,</span> <span class="mf">1000.1111</span><span class="p">)</span>

<span class="n">file2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>Test1: &#39;this is just a dummy test&#39;
Test2: this is just a dummy test
Test3:      this is just a dummy test
Test4: this is just a dummy test     
Test5:    &#39;this is just a dummy test&#39;
Test6: &#39;this is just a dummy test&#39;   
Test7: 1, 2, 3
Test8:  1,   2,          3
Test9: 1, 2, 3.000000
Test10: 1, 2, 3
Test11:  1,     2,          3
Test12: 1.000000, 2.800000, 3.141600
Test13: 1.000000, 2.80,      3.142
Test14: 0.110000, 10.111000, 1000.111100
Test15: 0.1, 10.1, 1000.1111000000
</pre></div>
</td></tr></table>

<p><strong>Write a list of numbers to a text file</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mf">16.38</span><span class="p">,</span> <span class="mf">139.90</span><span class="p">,</span> <span class="mf">441.46</span><span class="p">,</span> <span class="mf">29.03</span><span class="p">,</span> <span class="mf">40.93</span><span class="p">,</span> <span class="mf">202.07</span><span class="p">,</span> <span class="mf">142.30</span><span class="p">,</span> <span class="mf">346.00</span><span class="p">,</span> <span class="mf">300.00</span><span class="p">]</span>

<span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">open</span><span class="p">(</span><span class="s1">&#39;results.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Ouput:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>16.38
139.9
441.46
29.03
40.93
202.07
142.3
346.0
300.0
</pre></div>
</td></tr></table>

<p><strong>Calculate the average from a list of numbers</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># calculate average from float numbers</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.53</span><span class="p">,</span> <span class="mf">3.47</span><span class="p">,</span> <span class="mf">3.51</span><span class="p">,</span> <span class="mf">3.72</span><span class="p">,</span> <span class="mf">3.43</span><span class="p">]</span>
<span class="n">average</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="k">print</span> <span class="n">average</span>

<span class="c1"># calculate average from integer numbers</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">average</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="k">print</span> <span class="n">average</span>
</pre></div>
</td></tr></table>

<p><strong>Calculate the median from a list of numbers</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.53</span><span class="p">,</span> <span class="mf">3.47</span><span class="p">,</span> <span class="mf">3.51</span><span class="p">,</span> <span class="mf">3.72</span><span class="p">,</span> <span class="mf">3.43</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

<span class="n">mid</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> 
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">median</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">mid</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="n">mid</span><span class="p">])</span> <span class="o">/</span> <span class="mf">2.0</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">median</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">mid</span><span class="p">]</span>

<span class="k">print</span> <span class="n">median</span>
</pre></div>
</td></tr></table>

<p><strong>Join or concatenate a list</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;+&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="s1">&#39;1+2+3&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="s1">&#39;abc&#39;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">int</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">L</span><span class="p">))</span>
<span class="mi">123</span>
</pre></div>
</td></tr></table>

<p><strong>Calculate (a variance and )a standard deviation from a list of numbers</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.53</span><span class="p">,</span> <span class="mf">3.47</span><span class="p">,</span> <span class="mf">3.51</span><span class="p">,</span> <span class="mf">3.72</span><span class="p">,</span> <span class="mf">3.43</span><span class="p">]</span>
<span class="n">average</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">total</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="n">total</span> <span class="o">+=</span> <span class="p">(</span><span class="n">value</span> <span class="o">-</span> <span class="n">average</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

<span class="n">variance</span> <span class="o">=</span> <span class="n">total</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="c1"># population variance</span>
<span class="n">stddev</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">variance</span><span class="p">)</span> <span class="c1"># population stddev</span>

<span class="k">print</span> <span class="n">variance</span>
<span class="k">print</span> <span class="n">stddev</span>
</pre></div>
</td></tr></table>

<h4 id="chapter-4-parsing-data-records">Chapter 4, Parsing Data Records<a class="headerlink" href="#chapter-4-parsing-data-records" title="Permanent link">&para;</a></h4>
<p><strong>Find items common to two lists</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># proteins participating in cell cycle</span>

<span class="n">list_a</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;cell_cycle_proteins.txt&quot;</span><span class="p">):</span>
    <span class="n">list_a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

<span class="k">print</span> <span class="n">list_a</span>

<span class="c1"># proteins expressed in a given cancer cell</span>

<span class="n">list_b</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;cancer_cell_proteins.txt&quot;</span><span class="p">):</span>
    <span class="n">list_b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> 

<span class="k">print</span> <span class="n">list_b</span>

<span class="k">for</span> <span class="n">protein</span> <span class="ow">in</span> <span class="n">list_a</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">protein</span> <span class="ow">in</span> <span class="n">list_b</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">protein</span><span class="p">,</span> <span class="s1">&#39;detected in the cancer cell&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">protein</span><span class="p">,</span> <span class="s1">&#39;not observed&#39;</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>[&#39;P62258&#39;, &#39;P61981&#39;, &#39;P62191&#39;, &#39;P17980&#39;, &#39;P43686&#39;, &#39;P35998&#39;, &#39;P62333&#39;, &#39;Q99460&#39;, &#39;O75832&#39;]
[&#39;P43686&#39;, &#39;P62333&#39;]

P62258 not observed
P61981 not observed
P62191 not observed
P17980 not observed
P43686 detected in the cancer cell
P35998 not observed
P62333 detected in the cancer cell
Q99460 not observed
O75832 not observed
</pre></div>
</td></tr></table>

<p>**Find if two or more conditions are met</p>
<p><sub>boolean, operators, and, or, not</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">seq</span> <span class="o">=</span> <span class="s2">&quot;MGSNKSKPKDASQRRRSLEPAENVHGAGGGAFPASQTPSKPASADGHRGPSAAFAPAAAE&quot;</span>

<span class="k">if</span> <span class="s1">&#39;GGG&#39;</span> <span class="ow">in</span> <span class="n">seq</span> <span class="ow">and</span> <span class="s1">&#39;RRR&#39;</span><span class="ow">in</span> <span class="n">seq</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;GGG is at position: &#39;</span><span class="p">,</span> <span class="n">seq</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;GGG&#39;</span><span class="p">)</span>
    <span class="k">print</span> <span class="s1">&#39;RRR is at position: &#39;</span><span class="p">,</span> <span class="n">seq</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;RRR&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="s1">&#39;WWW&#39;</span> <span class="ow">in</span> <span class="n">seq</span> <span class="ow">or</span> <span class="s1">&#39;AAA&#39;</span> <span class="ow">in</span> <span class="n">seq</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;Either WWW or AAA occur in the sequence&#39;</span>

<span class="k">if</span> <span class="s1">&#39;AAA&#39;</span> <span class="ow">in</span> <span class="n">seq</span> <span class="ow">and</span> <span class="ow">not</span> <span class="s1">&#39;PPP&#39;</span> <span class="ow">in</span> <span class="n">seq</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;AAA occurs in the sequence but not PPP&#39;</span>
</pre></div>
</td></tr></table>

<p><strong>Boolean Operators</strong></p>
<table>
<thead>
<tr>
<th>Condition</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>A &lt; B</td>
<td>A lower than B</td>
</tr>
<tr>
<td>A &lt;= B</td>
<td>A lower than or equal to B</td>
</tr>
<tr>
<td>A &gt; B</td>
<td>A greater than B</td>
</tr>
<tr>
<td>A &gt;= B</td>
<td>A greater than or equal to B</td>
</tr>
<tr>
<td>A == B</td>
<td>A equal to B</td>
</tr>
<tr>
<td>A != B</td>
<td>A different from B</td>
</tr>
<tr>
<td>A&lt;&gt; B</td>
<td>idem</td>
</tr>
<tr>
<td>A is B</td>
<td>A is the same thing as B &lsquo;thing&rsquo; being an object</td>
</tr>
<tr>
<td>A is not B</td>
<td>A is not the same thing as B</td>
</tr>
<tr>
<td>A in B</td>
<td>A is present in the sequence B</td>
</tr>
<tr>
<td>A not in B</td>
<td>A is not present in the sequence B</td>
</tr>
</tbody>
</table>
<p><strong>Find all prime numbers under 30</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">print</span> <span class="s2">&quot;prime number:&quot;</span><span class="p">,</span> <span class="n">i</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span> <span class="s2">&quot;multiple of two:&quot;</span><span class="p">,</span> <span class="n">i</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span> <span class="s2">&quot;multiple of three:&quot;</span><span class="p">,</span> <span class="n">i</span>
    <span class="k">elif</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span> <span class="s2">&quot;multiple of five:&quot;</span><span class="p">,</span> <span class="n">i</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s2">&quot;prime number:&quot;</span><span class="p">,</span> <span class="n">i</span>
</pre></div>
</td></tr></table>

<p><strong>List vs Tuple vs Set</strong></p>
<ul>
<li>mutable: change, replace, reorder, add elements.</li>
<li><code class="codehilite">List = [1, 2, 3]</code>; mutable sequences of objects. </li>
<li><code class="codehilite">Tuple = (1, 2, 3)</code>; immutable ordered sequences of objects;.</li>
<li><code class="codehilite">Set = set([1, 2, 3])</code>; immutable unordered  collections of unique elements.</li>
<li>The three can contain digits, strings or other objects (embedded).</li>
</ul>
<p><strong>More on lists</strong></p>
<ul>
<li><code class="codehilite">List[0]</code>; extract</li>
<li><code class="codehilite">Llist = [[1, 2, 3],[a, b, c],[x, 4, &#39;text&#39;], &#39;seq&#39;]</code>; embedded lists.</li>
<li><code class="codehilite">List[0][1]</code>; extract from embedded lists.</li>
<li><code class="codehilite">List.append(5)</code>; add.</li>
<li>Create:<ul>
<li><code class="codehilite">range(3)</code>.</li>
<li><code class="codehilite">seq(0, 2, 1)</code>.</li>
<li><code class="codehilite">[0.0] * 10</code>.</li>
<li><code class="codehilite">[x**2 for x in range(5)]</code>.</li>
</ul>
</li>
</ul>
<p><strong>Creating a list with a one-line loop</strong></p>
<p><sub>loop, conditional, conditional, on one line</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># remove non-base symbols from a sequence</span>
<span class="n">squares</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
<span class="k">print</span> <span class="n">squares</span>

<span class="n">bases</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">]</span>
<span class="k">print</span> <span class="n">bases</span>

<span class="n">seq</span> <span class="o">=</span> <span class="s1">&#39;GGACXCAGXXGATT&#39;</span>
<span class="k">print</span> <span class="n">seq</span>

<span class="n">seqlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">base</span> <span class="k">for</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">seq</span> <span class="k">if</span> <span class="n">base</span> <span class="ow">in</span> <span class="n">bases</span><span class="p">]</span>
<span class="k">print</span> <span class="n">seqlist</span>
</pre></div>
</td></tr></table>

<p><strong>Write all headers from a file to a separate file</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">fasta_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;SwissProt.fasta&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">out_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;SwissProt.header&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fasta_file</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span>
        <span class="n">out_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="n">out_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><strong>Reads all AC numbers from the deflines of a file</strong></p>
<p><sub>parse, parsing, text, file</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">input_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;SwissProt.fasta&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="n">ac_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">input_file</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span>
        <span class="n">ac_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="k">print</span> <span class="n">ac_list</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>[&#39;P31946&#39;, &#39;P62258&#39;, &#39;Q04917&#39;, &#39;P61981&#39;, &#39;P31947&#39;, &#39;P27348&#39;, &#39;P63104&#39;, &#39;P30443&#39;]
</pre></div>
</td></tr></table>

<p><strong>Read a file (genbank_file) and convert it to another file (output_file)</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">genbank_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;AY810830.gb&quot;</span><span class="p">)</span>
<span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;AY810830.fasta&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>

<span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">genbank_file</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">9</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ACCESSION&#39;</span><span class="p">:</span>
        <span class="n">accession</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span> <span class="o">+</span> <span class="n">accession</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ORIGIN&#39;</span><span class="p">:</span> 
        <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">elif</span> <span class="n">flag</span><span class="p">:</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">fields</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fields</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
            <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">seq</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">genbank_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><strong>Read multiple files and extract data</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">fasta_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;SwissProt.fasta&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">out_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;SwissProtHuman.fasta&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

<span class="n">seq</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fasta_file</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">and</span> <span class="n">seq</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="c1"># process the first line of the input file</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">line</span>
    <span class="k">elif</span> <span class="n">line</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">:</span>
        <span class="c1"># join the lines with sequence</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="n">seq</span> <span class="o">+</span> <span class="n">line</span>
    <span class="k">elif</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;&gt;&#39;</span> <span class="ow">and</span> <span class="n">seq</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="c1"># in subsequent lines starting with &#39;&gt;&#39;,</span>
        <span class="c1"># write the previous header and sequence</span>
        <span class="c1"># to the output file. Then re-initialize</span>
        <span class="c1"># the header and seq variables for the next record</span>
        <span class="k">if</span> <span class="s2">&quot;Homo sapiens&quot;</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span>
            <span class="n">out_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span> <span class="o">+</span> <span class="n">seq</span><span class="p">)</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">line</span>

<span class="c1"># take care of the very last record of the input file</span>
<span class="k">if</span> <span class="s2">&quot;Homo sapiens&quot;</span> <span class="ow">in</span> <span class="n">header</span><span class="p">:</span>
    <span class="n">out_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span> <span class="o">+</span> <span class="n">seq</span><span class="p">)</span>
<span class="n">out_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<h4 id="chapter-5-searching-data">Chapter 5, Searching Data<a class="headerlink" href="#chapter-5-searching-data" title="Permanent link">&para;</a></h4>
<p><strong>Translate a RNA sequence to a protein sequence in three reading frames</strong></p>
<p><sub>dictionary</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">codon_table</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;GCU&#39;</span><span class="p">:</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;GCC&#39;</span><span class="p">:</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;GCA&#39;</span><span class="p">:</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;GCG&#39;</span><span class="p">:</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;CGU&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;CGC&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span>   
    <span class="s1">&#39;CGA&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;CGG&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;AGA&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;AGG&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;UCU&#39;</span><span class="p">:</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;UCC&#39;</span><span class="p">:</span><span class="s1">&#39;S&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UCA&#39;</span><span class="p">:</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;UCG&#39;</span><span class="p">:</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;AGU&#39;</span><span class="p">:</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;AGC&#39;</span><span class="p">:</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;AUU&#39;</span><span class="p">:</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;AUC&#39;</span><span class="p">:</span><span class="s1">&#39;I&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AUA&#39;</span><span class="p">:</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;UUA&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;UUG&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;CUU&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;CUC&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;CUA&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CUG&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;GGU&#39;</span><span class="p">:</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;GGC&#39;</span><span class="p">:</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;GGA&#39;</span><span class="p">:</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;GGG&#39;</span><span class="p">:</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;GUU&#39;</span><span class="p">:</span><span class="s1">&#39;V&#39;</span><span class="p">,</span>
    <span class="s1">&#39;GUC&#39;</span><span class="p">:</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;GUA&#39;</span><span class="p">:</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;GUG&#39;</span><span class="p">:</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;ACU&#39;</span><span class="p">:</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;ACC&#39;</span><span class="p">:</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;ACA&#39;</span><span class="p">:</span><span class="s1">&#39;T&#39;</span><span class="p">,</span>
    <span class="s1">&#39;ACG&#39;</span><span class="p">:</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;CCU&#39;</span><span class="p">:</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;CCC&#39;</span><span class="p">:</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;CCA&#39;</span><span class="p">:</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;CCG&#39;</span><span class="p">:</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;AAU&#39;</span><span class="p">:</span><span class="s1">&#39;N&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AAC&#39;</span><span class="p">:</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;GAU&#39;</span><span class="p">:</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;GAC&#39;</span><span class="p">:</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;UGU&#39;</span><span class="p">:</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;UGC&#39;</span><span class="p">:</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;CAA&#39;</span><span class="p">:</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CAG&#39;</span><span class="p">:</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;GAA&#39;</span><span class="p">:</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;GAG&#39;</span><span class="p">:</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;CAU&#39;</span><span class="p">:</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;CAC&#39;</span><span class="p">:</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;AAA&#39;</span><span class="p">:</span><span class="s1">&#39;K&#39;</span><span class="p">,</span>
    <span class="s1">&#39;AAG&#39;</span><span class="p">:</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;UUU&#39;</span><span class="p">:</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;UUC&#39;</span><span class="p">:</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;UAU&#39;</span><span class="p">:</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;UAC&#39;</span><span class="p">:</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;AUG&#39;</span><span class="p">:</span><span class="s1">&#39;M&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UGG&#39;</span><span class="p">:</span><span class="s1">&#39;W&#39;</span><span class="p">,</span>
    <span class="s1">&#39;UAG&#39;</span><span class="p">:</span><span class="s1">&#39;STOP&#39;</span><span class="p">,</span> <span class="s1">&#39;UGA&#39;</span><span class="p">:</span><span class="s1">&#39;STOP&#39;</span><span class="p">,</span> <span class="s1">&#39;UAA&#39;</span><span class="p">:</span><span class="s1">&#39;STOP&#39;</span>
    <span class="p">}</span>

<span class="c1"># read the RNA sequence into a single string</span>
<span class="n">rna</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;A06662-RNA.fasta&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">):</span> 
        <span class="n">rna</span> <span class="o">=</span> <span class="n">rna</span> <span class="o">+</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="c1"># translate one frame at a time</span>
<span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">prot</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> 
    <span class="k">print</span> <span class="s1">&#39;Reading frame &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">frame</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rna</span><span class="p">),</span> <span class="mi">3</span><span class="p">):</span>
        <span class="n">codon</span> <span class="o">=</span> <span class="n">rna</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">codon</span> <span class="ow">in</span> <span class="n">codon_table</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">codon_table</span><span class="p">[</span><span class="n">codon</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;STOP&#39;</span><span class="p">:</span>
                <span class="n">prot</span> <span class="o">=</span> <span class="n">prot</span> <span class="o">+</span> <span class="s1">&#39;*&#39;</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="n">prot</span> <span class="o">=</span> <span class="n">prot</span> <span class="o">+</span> <span class="n">codon_table</span><span class="p">[</span><span class="n">codon</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># handle too short codons</span>
            <span class="n">prot</span> <span class="o">=</span> <span class="n">prot</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span>   

    <span class="c1"># format to blocks of 48 columns</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">prot</span><span class="p">):</span>
        <span class="k">print</span> <span class="n">prot</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">48</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">48</span>
</pre></div>
</td></tr></table>

<p>Output (contains a translated sequence for each reading frame):</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>Reading frame 1
WDQSAEAACVRVRVRVCACVCVRLHLCRVGKEIEMGGQ*AQVPKALNP
LVWSLLRAMGAIEKSEQGCV*M*GLEGSSREASSKAFAIIW*ENPARM
DRQNGIEMSWQLKWTGFGTSLVVGSKQRRIWDSGGLAWGRRGCLRGWE
G*E*DDTWWCLAGGGQG*LCEGTARATEAF*DPAVPEPGRQDLHCGRP
GEHLA

Reading frame 2
GTSQQRQRVCACVCVCVRVCVYACICVGWVRR*RWAGSRPRSRRP*TH
WFGVS*GQWGPLRSLNRAVSECEV*KDPPEKPALKLLQSSGERTQQGW
TGRME*R*VGS*SGQDLVLAWLWGASRGESGTLVVWPGADGGVSGAGR
DESRMIHGGVWQEAGKDDYVKALPGQLKPFETLLSQNQGGKTFIVGDQ
VSIW-

Reading frame 3
GPVSRGSVCARACACVCVCVCTLAFVSGG*GDRDGRAVGPGPEGLEPT
GLESPKGNGGH*EV*TGLCLNVRSRRILQRSQL*SFCNHLVREPSKDG
QAEWNRDELAAEVDRIWY*PGCGEQAEENLGLWWSGLGQTGVSQGLGG
MRVG*YMVVSGRRRARMTM*RHCPGN*SLLRPCCPRTREARPSLWETR
*ASG-
</pre></div>
</td></tr></table>

<p><strong>While loop</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">seq</span> <span class="o">=</span> <span class="s2">&quot;IVGGYTCGANTVPYQVSLNSGYHFCGGSLINSQWVVSAAHCYKSGIQVRLGEDNINVVEGNEQF&quot;</span>

<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">12</span><span class="p">]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">12</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>IVGGYTCGANTV
PYQVSLNSGYHF
CGGSLINSQWVV
SAAHCYKSGIQV
RLGEDNINVVEG
NEQF
</pre></div>
</td></tr></table>

<p><strong>Find the a sequence in a file</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">swissprot</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;SwissProt.fasta&quot;</span><span class="p">)</span>
<span class="n">insulin_ac</span> <span class="o">=</span> <span class="s1">&#39;P61981&#39;</span>
<span class="n">result</span> <span class="o">=</span> <span class="bp">None</span>

<span class="k">while</span> <span class="n">result</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">swissprot</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">):</span>
        <span class="n">ac</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ac</span> <span class="o">==</span> <span class="n">insulin_ac</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="k">print</span> <span class="n">result</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>&gt;sp|P61981|1433G_HUMAN 14-3-3 protein gamma OS=Homo sapiens GN=YWHAG PE=1 SV=2
</pre></div>
</td></tr></table>

<p><strong>Searching a list</strong></p>
<p><sub>search</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">bases</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">]</span>
<span class="n">seq</span> <span class="o">=</span> <span class="s1">&#39;CAGGCCATTRKGL&#39;</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">seq</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bases</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;is not a nucleotide&quot;</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>R is not a nucleotide
K is not a nucleotide
L is not a nucleotide
</pre></div>
</td></tr></table>

<p><strong>Read a file and store entries in a dictionary</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">sequences</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">ac</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">seq</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;SwissProt.fasta&quot;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">seq</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">sequences</span><span class="p">[</span><span class="n">ac</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">):</span>
        <span class="n">ac</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="n">seq</span> <span class="o">+</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="n">sequences</span><span class="p">[</span><span class="n">ac</span><span class="p">]</span> <span class="o">=</span> <span class="n">seq</span>
<span class="k">print</span> <span class="n">sequences</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="k">print</span> <span class="n">sequences</span><span class="p">[</span><span class="s1">&#39;P62258&#39;</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>[&#39;Q04917&#39;, &#39;P63104&#39;, &#39;P27348&#39;, &#39;P31947&#39;, &#39;P31946&#39;, &#39;P30443&#39;, &#39;P61981&#39;, &#39;P62258&#39;]

MDDREDLVYQAKLAEQAERYDEMVESMKKVAGMDVELTVEERNLLSVAYKNVIGARRASWRIISSIEQKEENKGGEDKLKMIREYRQMVETELKLICCDILDVLDKHLIPAANTGESKVFYYKMKGDYHRYLAEFATGNDRKEAAENSLVAYKAASDIAMTELPPTHPIRLGLALNFSVFYYEILNSPDRACRLAKAAFDDAIAELDTLSEESYKDSTLIMQLLRDNLTLWTSDMQGDGEEQNKEALQDVEDENQ
</pre></div>
</td></tr></table>

<p><strong>Read a sequence from a structure</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">aa_codes</span> <span class="o">=</span> <span class="p">{</span>
     <span class="s1">&#39;ALA&#39;</span><span class="p">:</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;CYS&#39;</span><span class="p">:</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;ASP&#39;</span><span class="p">:</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;GLU&#39;</span><span class="p">:</span><span class="s1">&#39;E&#39;</span><span class="p">,</span>
     <span class="s1">&#39;PHE&#39;</span><span class="p">:</span><span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;GLY&#39;</span><span class="p">:</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;HIS&#39;</span><span class="p">:</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;LYS&#39;</span><span class="p">:</span><span class="s1">&#39;K&#39;</span><span class="p">,</span>
     <span class="s1">&#39;ILE&#39;</span><span class="p">:</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;LEU&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;MET&#39;</span><span class="p">:</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;ASN&#39;</span><span class="p">:</span><span class="s1">&#39;N&#39;</span><span class="p">,</span>
     <span class="s1">&#39;PRO&#39;</span><span class="p">:</span><span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;GLN&#39;</span><span class="p">:</span><span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="s1">&#39;ARG&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">,</span> <span class="s1">&#39;SER&#39;</span><span class="p">:</span><span class="s1">&#39;S&#39;</span><span class="p">,</span>
     <span class="s1">&#39;THR&#39;</span><span class="p">:</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;VAL&#39;</span><span class="p">:</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;TYR&#39;</span><span class="p">:</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;TRP&#39;</span><span class="p">:</span><span class="s1">&#39;W&#39;</span><span class="p">}</span>

<span class="n">seq</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;1TLD.pdb&quot;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;SEQRES&quot;</span><span class="p">:</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">resname</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">:]:</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="n">seq</span> <span class="o">+</span> <span class="n">aa_codes</span><span class="p">[</span><span class="n">resname</span><span class="p">]</span>

<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">print</span> <span class="s2">&quot;&gt;1TLD&quot;</span>
<span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">seq</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">64</span><span class="p">]</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">64</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>&gt;1TLD
IVGGYTCGANTVPYQVSLNSGYHFCGGSLINSQWVVSAAHCYKSGIQVRLGEDNINVVEGNEQF
ISASKSIVHPSYNSNTLNNDIMLIKLKSAASLNSRVASISLPTSCASAGTQCLISGWGNTKSSG
TSYPDVLKCLKAPILSDSSCKSAYPGQITSNMFCAGYLEGGKDSCQGDSGGPVVCSGKLQGIVS
WGSGCAQKNKPGVYTKVCNYVSWIKQTIASN
</pre></div>
</td></tr></table>

<h4 id="chapter-6-filtering-data">Chapter 6, Filtering Data<a class="headerlink" href="#chapter-6-filtering-data" title="Permanent link">&para;</a></h4>
<p><strong>Calculate the intersection of two lists</strong></p>
<p><sub>venn</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">data_a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">data_b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>

<span class="n">a_and_b</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">data_a</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">data_b</span><span class="p">:</span>
        <span class="n">a_and_b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

<span class="k">print</span> <span class="n">a_and_b</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>[1, 5]
</pre></div>
</td></tr></table>

<p><strong>More about sets</strong></p>
<p><sub>set</sub></p>
<ul>
<li><code class="codehilite">Set = set([1, 2, 3])</code>; immutable unordered collections of unique elements.</li>
<li>They are not sequential objects like lists.</li>
<li>They cannot contain identical elements.<ul>
<li>to remove duplicates</li>
<li>to calculate the intersection</li>
<li>the union</li>
<li>the difference between two or more group of objects</li>
<li>as long as the order is not important.</li>
</ul>
</li>
<li>They do not support indexing and slicing operations.</li>
<li>They take the <code class="codehilite">in</code> and <code class="codehilite">not in</code> operators (test an element for membership in a set).</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">s1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="s1">&#39;LDFGJLDFGDGD&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s1</span>
<span class="nb">set</span><span class="p">([</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;L&#39;</span> <span class="ow">in</span> <span class="n">s1</span>
<span class="bp">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="s1">&#39;Z&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">s1</span>
<span class="bp">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">s2</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;LDF&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s1</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="bp">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">s1</span><span class="o">.</span><span class="n">issuperset</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="bp">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">s1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">5</span> <span class="ow">in</span> <span class="n">s1</span>
<span class="bp">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="mi">6</span> <span class="ow">in</span> <span class="n">s1</span>
<span class="bp">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">s2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s1</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="bp">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">s1</span><span class="o">.</span><span class="n">issuperset</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="bp">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">s3</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s3</span>
<span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">s3</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s3</span>
<span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">s5</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s5</span>
<span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">s5</span><span class="o">.</span><span class="n">update</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s5</span>
<span class="nb">set</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">s1</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s2</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s1</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="nb">set</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">s1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="nb">set</span><span class="p">([</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">s1</span><span class="o">.</span><span class="n">symmetric_difference</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="nb">set</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">s1</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="nb">set</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">s2</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
<span class="nb">set</span><span class="p">([</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<p><strong>Calculate the intersection of two sets</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">data_a</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">data_b</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>

<span class="n">a_and_b</span> <span class="o">=</span> <span class="n">data_a</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">data_b</span><span class="p">)</span>
<span class="k">print</span> <span class="n">a_and_b</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>set([1, 5])
</pre></div>
</td></tr></table>

<p><strong>Find numbers common to three sets</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nb">reduce</span><span class="p">()</span> <span class="ow">is</span>

<span class="n">a</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">b</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">c</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="n">triple_set</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>
<span class="n">common</span> <span class="o">=</span> <span class="nb">reduce</span><span class="p">(</span><span class="nb">set</span><span class="o">.</span><span class="n">intersection</span><span class="p">,</span> <span class="n">triple_set</span><span class="p">)</span>
<span class="k">print</span> <span class="n">common</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>set([1, 4])
</pre></div>
</td></tr></table>

<p><strong>Calculate the differences of two lists</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">data_a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">data_b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>

<span class="n">a_not_b</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">b_not_a</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">data_a</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">num</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_b</span><span class="p">:</span>
        <span class="n">a_not_b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

<span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">data_b</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">num</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data_a</span><span class="p">:</span>
        <span class="n">b_not_a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>

<span class="k">print</span> <span class="n">a_not_b</span>
<span class="k">print</span> <span class="n">b_not_a</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>[2, 3, 4, 6]
[7, 8, 9]
</pre></div>
</td></tr></table>

<p><strong>Calculate the differences of two sets 1</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">data_a</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">data_b</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>

<span class="n">a_not_b</span> <span class="o">=</span> <span class="n">data_a</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">data_b</span><span class="p">)</span>
<span class="n">b_not_a</span> <span class="o">=</span> <span class="n">data_b</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">data_a</span><span class="p">)</span>

<span class="k">print</span> <span class="n">a_not_b</span>
<span class="k">print</span> <span class="n">b_not_a</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>set([2, 3, 4, 6])
set([8, 9, 7])
</pre></div>
</td></tr></table>

<p><strong>Calculate the differences of two sets 2</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">data_a</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">data_b</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>

<span class="n">a_or_b</span> <span class="o">=</span> <span class="n">data_a</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">data_b</span><span class="p">)</span>
<span class="n">a_xor_b</span> <span class="o">=</span> <span class="n">data_a</span><span class="o">.</span><span class="n">symmetric_difference</span><span class="p">(</span><span class="n">data_b</span><span class="p">)</span>

<span class="k">print</span> <span class="n">a_or_b</span>
<span class="k">print</span> <span class="n">a_xor_b</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>set([1, 2, 3, 4, 5, 6, 7, 8, 9])
set([2, 3, 4, 6, 7, 8, 9])
</pre></div>
</td></tr></table>

<p><strong>Remove elements from a list</strong></p>
<ul>
<li><code class="codehilite">pop()</code>; return and remove the first value.</li>
<li><code class="codehilite">pop(0)</code>; return and remove a specific position in the index.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">data_a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data_a</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<span class="mi">1</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">data_a</span>
<span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<ul>
<li><code class="codehilite">del()</code>; remove a specific position in the index only.</li>
</ul>
<p><sub>delete</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">data_a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">del</span><span class="p">(</span><span class="n">data_a</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">data_a</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<ul>
<li><code class="codehilite">remove()</code>;  remove a specific element only.</li>
</ul>
<p><sub>remove</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">data_a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data_a</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">print</span> <span class="n">data_a</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">data_a</span> <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p><strong>Slicing a list</strong></p>
<p><sub>slice, subset</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">data_a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data_2</span> <span class="o">=</span> <span class="n">data_a</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p><strong>Remove elements from a dictionary</strong></p>
<p><sub>pop, delete</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="mi">1</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span>
<span class="p">{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span>
<span class="mi">1</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span>
<span class="p">{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
</pre></div>
</td></tr></table>

<p><strong>Delete particular lines from a text file or write back particular lines in a new file</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">lines</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;text.txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="nb">open</span><span class="p">(</span><span class="s1">&#39;new.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="n">lines</span><span class="p">[</span><span class="mi">6</span><span class="p">:])</span>
</pre></div>
</td></tr></table>

<p><strong>Remove some lines from a text file</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">in_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;text.txt&#39;</span><span class="p">)</span>
<span class="n">out_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;new.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>

<span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">indices_to_remove</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">in_file</span><span class="p">:</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">index</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">indices_to_remove</span><span class="p">:</span>
        <span class="n">out_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="n">in_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">out_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><strong>Remove some lines from a text file with <code class="codehilite"><span class="n">enumerate</span>()</code></strong></p>
<p><sub>enumerate</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">out_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;new.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="n">indices_to_remove</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;text.txt&#39;</span><span class="p">)):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">indices_to_remove</span><span class="p">:</span>
        <span class="n">out_file_write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="n">out_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><strong>Remove duplicates from a file with accession numbers 1</strong></p>
<p><sub>set</sub></p>
<ul>
<li>Using a set is faster but distorts the order.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">input_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;UniprotID.txt&#39;</span><span class="p">)</span>
<span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;UniprotID-unique.txt&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

<span class="n">unique</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">input_file</span><span class="p">:</span>
    <span class="n">unique</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">unique</span><span class="p">:</span>
    <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Remove duplicates from a list of accession numbers 2</strong></p>
<p><sub>list</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">input_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;UniprotID.txt&#39;</span><span class="p">)</span>
<span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;UniprotID-unique.txt&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

<span class="n">unique</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">input_file</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">line</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unique</span><span class="p">:</span>
        <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">unique</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

<span class="n">input_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><strong>Compare two lists of accession codes using sets</strong></p>
<p><sub>set comparison, difference</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># read the old database release</span>
<span class="n">old_db</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;list_old.txt&quot;</span><span class="p">):</span>
    <span class="n">accession</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">old_db</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">accession</span><span class="p">)</span>

<span class="c1"># read the new database release</span>
<span class="n">new_db</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;list_new.txt&quot;</span><span class="p">):</span>
    <span class="n">accession</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">new_db</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">accession</span><span class="p">)</span>

<span class="c1"># report the differences</span>
<span class="n">new_entries</span> <span class="o">=</span> <span class="n">new_db</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">old_db</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;new entries&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">new_entries</span><span class="p">)</span>
<span class="n">old_entries</span> <span class="o">=</span> <span class="n">old_db</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">new_db</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;deprecated entries&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">old_entries</span><span class="p">)</span>
<span class="n">unique_entries</span> <span class="o">=</span> <span class="n">new_db</span><span class="o">.</span><span class="n">symmetric_difference</span><span class="p">(</span><span class="n">old_db</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;unique entries&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">unique_entries</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<h4 id="chapter-7-managing-tabular-data">Chapter 7, Managing Tabular Data<a class="headerlink" href="#chapter-7-managing-tabular-data" title="Permanent link">&para;</a></h4>
<p><strong>The original data</strong></p>
<table>
<thead>
<tr>
<th>protein</th>
<th>ext1</th>
<th>ext2</th>
<th>ext3</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.16</td>
<td>0.038</td>
<td>0.044</td>
<td>0.04</td>
</tr>
<tr>
<td>0.33</td>
<td>0.089</td>
<td>0.095</td>
<td>0.091</td>
</tr>
<tr>
<td>0.66</td>
<td>0.184</td>
<td>0.191</td>
<td>0.191</td>
</tr>
<tr>
<td>1.0</td>
<td>0.28</td>
<td>0.292</td>
<td>0.283</td>
</tr>
<tr>
<td>1.32</td>
<td>0.365</td>
<td>0.367</td>
<td>0.365</td>
</tr>
<tr>
<td>1.66</td>
<td>0.441</td>
<td>0.443</td>
<td>0.444</td>
</tr>
</tbody>
</table>
<p><strong>Read tabular data from a tab-separated text file</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;lowry_data.txt&#39;</span><span class="p">):</span>
    <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">))</span>

<span class="k">print</span> <span class="n">table</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>[
[&#39;protein&#39;, &#39;ext1&#39;, &#39;ext2&#39;, &#39;ext3&#39;],
[&#39;0.16&#39;, &#39;0.038&#39;, &#39;0.044&#39;, &#39;0.04&#39;],
[&#39;0.33&#39;, &#39;0.089&#39;, &#39;0.095&#39;, &#39;0.091&#39;],
[&#39;0.66&#39;, &#39;0.184&#39;, &#39;0.191&#39;, &#39;0.191&#39;],
[&#39;1.0&#39;, &#39;0.28&#39;, &#39;0.292&#39;, &#39;0.283&#39;],
[&#39;1.32&#39;, &#39;0.365&#39;, &#39;0.367&#39;, &#39;0.365&#39;],
[&#39;1.66&#39;, &#39;0.441&#39;, &#39;0.443&#39;, &#39;0.444&#39;]
]
</pre></div>
</td></tr></table>

<p><strong>Write a nested list to a text file</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;protein&#39;</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.038</span><span class="p">,</span> <span class="mf">0.044</span><span class="p">,</span> <span class="mf">0.040</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.089</span><span class="p">,</span> <span class="mf">0.095</span><span class="p">,</span> <span class="mf">0.091</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.66</span><span class="p">,</span> <span class="mf">0.184</span><span class="p">,</span> <span class="mf">0.191</span><span class="p">,</span> <span class="mf">0.191</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.00</span><span class="p">,</span> <span class="mf">0.280</span><span class="p">,</span> <span class="mf">0.292</span><span class="p">,</span> <span class="mf">0.283</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.32</span><span class="p">,</span> <span class="mf">0.365</span><span class="p">,</span> <span class="mf">0.367</span><span class="p">,</span> <span class="mf">0.365</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.66</span><span class="p">,</span> <span class="mf">0.441</span><span class="p">,</span> <span class="mf">0.443</span><span class="p">,</span> <span class="mf">0.444</span><span class="p">]</span>
    <span class="p">]</span>

<span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
    <span class="n">line</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">out</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

<span class="nb">open</span><span class="p">(</span><span class="s1">&#39;lowry_data.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Reformat a four-column to a two-column table</strong></p>
<p>Create a 2D table.</p>
<p>Print the table line by line.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;protein&#39;</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.038</span><span class="p">,</span> <span class="mf">0.044</span><span class="p">,</span> <span class="mf">0.040</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.089</span><span class="p">,</span> <span class="mf">0.095</span><span class="p">,</span> <span class="mf">0.091</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.66</span><span class="p">,</span> <span class="mf">0.184</span><span class="p">,</span> <span class="mf">0.191</span><span class="p">,</span> <span class="mf">0.191</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.00</span><span class="p">,</span> <span class="mf">0.280</span><span class="p">,</span> <span class="mf">0.292</span><span class="p">,</span> <span class="mf">0.283</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.32</span><span class="p">,</span> <span class="mf">0.365</span><span class="p">,</span> <span class="mf">0.367</span><span class="p">,</span> <span class="mf">0.365</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.66</span><span class="p">,</span> <span class="mf">0.441</span><span class="p">,</span> <span class="mf">0.443</span><span class="p">,</span> <span class="mf">0.444</span><span class="p">]</span>
    <span class="p">]</span>

<span class="c1"># remove the first row</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

<span class="n">protein</span><span class="p">,</span> <span class="n">ext1</span><span class="p">,</span> <span class="n">ext2</span><span class="p">,</span> <span class="n">ext3</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">table</span><span class="p">)</span>

<span class="c1"># create a single column for `ext` or concatenate each `ext`</span>
<span class="c1"># extend (`* 3`) the `protein` column to match the `ext` column.</span>
<span class="n">extinction</span> <span class="o">=</span> <span class="n">ext1</span> <span class="o">+</span> <span class="n">ext2</span> <span class="o">+</span> <span class="n">ext3</span>
<span class="n">protein</span> <span class="o">=</span> <span class="n">protein</span> <span class="o">*</span> <span class="mi">3</span>

<span class="c1"># create four tuples for each column</span>
<span class="n">table</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">protein</span><span class="p">,</span> <span class="n">extinction</span><span class="p">)</span>

<span class="k">for</span> <span class="n">prot</span><span class="p">,</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">prot</span><span class="p">,</span> <span class="n">ext</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table>
<thead>
<tr>
<th>protein</th>
<th>ext</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.16</td>
<td>0.038</td>
</tr>
<tr>
<td>0.33</td>
<td>0.089</td>
</tr>
<tr>
<td>0.66</td>
<td>0.184</td>
</tr>
<tr>
<td>1.0</td>
<td>0.28</td>
</tr>
<tr>
<td>1.32</td>
<td>0.365</td>
</tr>
<tr>
<td>1.66</td>
<td>0.441</td>
</tr>
<tr>
<td>0.16</td>
<td>0.044</td>
</tr>
<tr>
<td>0.33</td>
<td>0.095</td>
</tr>
<tr>
<td>0.66</td>
<td>0.191</td>
</tr>
<tr>
<td>1.0</td>
<td>0.292</td>
</tr>
<tr>
<td>1.32</td>
<td>0.367</td>
</tr>
<tr>
<td>1.66</td>
<td>0.443</td>
</tr>
<tr>
<td>0.16</td>
<td>0.04</td>
</tr>
<tr>
<td>0.33</td>
<td>0.091</td>
</tr>
<tr>
<td>0.66</td>
<td>0.191</td>
</tr>
<tr>
<td>1.0</td>
<td>0.283</td>
</tr>
<tr>
<td>1.32</td>
<td>0.365</td>
</tr>
<tr>
<td>1.66</td>
<td>0.444</td>
</tr>
</tbody>
</table>
<p><strong>Create a table; lists in a list</strong></p>
<ul>
<li>Empty 1.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
</pre></div>
</td></tr></table>

<ul>
<li>Empty 2.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Encode a 2D list; lists in a list</strong></p>
<p><sub>tabular, table, two dimensions</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">]</span>
    <span class="p">]</span>
</pre></div>
</td></tr></table>

<p><strong>Encode a list of nested tuples; tuples in a list</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span>
    <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">)</span>
    <span class="p">]</span>
</pre></div>
</td></tr></table>

<p><strong>Extract, access rows and cells from a 2D table</strong></p>
<p><sub>tabular, table, two dimensions</sub></p>
<ul>
<li><code class="codehilite">table[1]</code>; extract the 2<sup>nd</sup> row.</li>
<li><code class="codehilite">table[1][2]</code>; extract a single cell (2<sup>nd</sup> row, 3<sup>rd</sup> column).</li>
<li><code class="codehilite">table[1:]</code> or <code class="codehilite">table.pop(0)</code>; slice the 1<sup>st</sup> row, keep the remaining.</li>
<li><code class="codehilite">table.pop(2)</code>; delete the 3<sup>rd</sup> row.</li>
<li><code class="codehilite">table[:2]</code>; slice the 3<sup>rd</sup> column, keep the remaining.</li>
<li><code class="codehilite">table[:2] + table[3:]</code>; slice the 3<sup>rd</sup> column and 4<sup>th</sup> row, keep the remaining.</li>
<li><code class="codehilite">table.insert(2, [0.55, 0.12, 0.12, 0.14])</code>; insert a new row in 3<sup>rd</sup> position</li>
<li><code class="codehilite">table.append([0.55, 0.12, 0.12, 0.14])</code>; insert a new row at the end.</li>
</ul>
<p><strong>Looping to access each row</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">row</span>
</pre></div>
</td></tr></table>

<p><strong>Looping to access each cell</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">cell</span>
</pre></div>
</td></tr></table>

<p><strong>Extract, access columns from a 2D table</strong></p>
<p><sub>tabular, table, two dimensions</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">protein</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># access the 1st, 2nd... column (separate the columns)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
    <span class="n">protein</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># access the 4th column</span>
<span class="n">columns</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">table</span><span class="p">)</span>
<span class="n">fourth</span> <span class="o">=</span> <span class="n">column</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<ul>
<li><code class="codehilite">protein, ex1. ext2, ext3 = zip(*table)</code>; access many columns; now each column is in a separate tuple.</li>
</ul>
<p><strong>Flip a table 90 degrees</strong></p>
<p><sub>convert column to row, row to column</sub></p>
<ul>
<li>Column becomes rows. Easier to extract or insert rows and cells.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">]</span>
<span class="p">]</span>

<span class="n">columns</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">)</span>
<span class="k">print</span> <span class="n">columns</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>[
(0, 10, 20),
(1, 11, 21),
(2, 12, 22),
(3, 13, 23)
]
</pre></div>
</td></tr></table>

<ul>
<li>But rows are now immutable tuples!</li>
<li>You cannot manipulate individual cells.</li>
<li>Convert the rows to lists again in order to extract a cell.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">table</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">table</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p><strong>Insert, access or extract columns from a 2D table</strong></p>
<p><sub>tabular, table, two dimensions</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">table</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s1">&#39;ext4&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">table</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">table</span><span class="p">)</span>

<span class="n">table</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">table</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">table</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">table</span><span class="p">)</span>

<span class="n">table</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">table</span><span class="p">)</span>
<span class="n">table</span>
</pre></div>
</td></tr></table>

<p><strong>The <code class="codehilite">zip()</code> function</strong></p>
<ul>
<li><code class="codehilite">zip()</code>; iterate though lists, tuples, and strings.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="nb">zip</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="p">[</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</td></tr></table>

<ul>
<li>The asterik tells the function to use all the arguments.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">table</span><span class="p">)</span>

<span class="c1"># vs</span>

<span class="nb">zip</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">table</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">table</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">table</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<p><strong>Multi-dimentional tables</strong></p>
<p><sub>tabular, table, two dimensions, three dimensions, 2D, 3D, lists in list</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">cube</span> <span class="o">=</span> <span class="p">[[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]]</span>
</pre></div>
</td></tr></table>

<ul>
<li>Warning: more dimensions means more nested data.</li>
<li>It slows down the calculations!!! </li>
<li>Prefer Numpy, Pandas, parallel computing.</li>
<li>Avoid going over 2D!</li>
</ul>
<p><strong>Create a table; dictionaries in a table, in a list</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="p">[</span>
   <span class="p">{</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">0.16</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">:</span> <span class="mf">0.038</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">:</span> <span class="mf">0.044</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">:</span> <span class="mf">0.040</span><span class="p">},</span>
   <span class="p">{</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">0.33</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">:</span> <span class="mf">0.089</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">:</span> <span class="mf">0.095</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">:</span> <span class="mf">0.091</span><span class="p">},</span>
   <span class="p">{</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">0.66</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">:</span> <span class="mf">0.184</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">:</span> <span class="mf">0.191</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">:</span> <span class="mf">0.191</span><span class="p">},</span>
   <span class="p">{</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">1.00</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">:</span> <span class="mf">0.280</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">:</span> <span class="mf">0.292</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">:</span> <span class="mf">0.283</span><span class="p">},</span>
   <span class="p">{</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">1.32</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">:</span> <span class="mf">0.365</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">:</span> <span class="mf">0.367</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">:</span> <span class="mf">0.365</span><span class="p">},</span>
   <span class="p">{</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">1.66</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">:</span> <span class="mf">0.441</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">:</span> <span class="mf">0.443</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">:</span> <span class="mf">0.444</span><span class="p">}</span>
   <span class="p">]</span>
</pre></div>
</td></tr></table>

<p><strong>Extract, access cells in a table</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># second row, cell &#39;ext2&#39; instead of a number</span>
<span class="n">cell</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;ext2&#39;</span><span class="p">]</span>

<span class="k">print</span> <span class="n">table</span>
<span class="k">print</span> <span class="n">cell</span>
</pre></div>
</td></tr></table>

<p><strong>Create a table; dictionaries in a dictionary</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s1">&#39;row1&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">0.16</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">:</span> <span class="mf">0.038</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">:</span> <span class="mf">0.044</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">:</span> <span class="mf">0.040</span><span class="p">},</span>
   <span class="s1">&#39;row2&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">0.33</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">:</span> <span class="mf">0.089</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">:</span> <span class="mf">0.095</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">:</span> <span class="mf">0.091</span><span class="p">},</span>
   <span class="s1">&#39;row3&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">0.66</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">:</span> <span class="mf">0.184</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">:</span> <span class="mf">0.191</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">:</span> <span class="mf">0.191</span><span class="p">},</span>
   <span class="s1">&#39;row4&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">1.00</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">:</span> <span class="mf">0.280</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">:</span> <span class="mf">0.292</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">:</span> <span class="mf">0.283</span><span class="p">},</span>
   <span class="s1">&#39;row5&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">1.32</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">:</span> <span class="mf">0.365</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">:</span> <span class="mf">0.367</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">:</span> <span class="mf">0.365</span><span class="p">},</span>
   <span class="s1">&#39;row6&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">1.66</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">:</span> <span class="mf">0.441</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">:</span> <span class="mf">0.443</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">:</span> <span class="mf">0.444</span><span class="p">}</span>
   <span class="p">}</span>
</pre></div>
</td></tr></table>

<p><strong>Extract, access cells in a table, in a dictionary</strong></p>
<p>More readable this way; second row, cell <code class="codehilite">&#39;ext2&#39;</code>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">cell</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="s1">&#39;row1&#39;</span><span class="p">][</span><span class="s1">&#39;ext2&#39;</span><span class="p">]</span>

<span class="k">print</span> <span class="n">table</span>
<span class="k">print</span> <span class="n">cell</span>
</pre></div>
</td></tr></table>

<p><strong>Create a table: lists in a dictionaries</strong></p>
<p>Data for each row are in a simpler format.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s1">&#39;1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">0.16</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">:</span> <span class="mf">0.038</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">:</span> <span class="mf">0.044</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">:</span> <span class="mf">0.040</span><span class="err">¸</span><span class="p">],</span>
   <span class="s1">&#39;2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">0.33</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">:</span> <span class="mf">0.089</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">:</span> <span class="mf">0.095</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">:</span> <span class="mf">0.091</span><span class="p">],</span>
   <span class="s1">&#39;3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">0.66</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">:</span> <span class="mf">0.184</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">:</span> <span class="mf">0.191</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">:</span> <span class="mf">0.191</span><span class="p">],</span>
   <span class="s1">&#39;4&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">1.00</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">:</span> <span class="mf">0.280</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">:</span> <span class="mf">0.292</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">:</span> <span class="mf">0.283</span><span class="p">],</span>
   <span class="s1">&#39;5&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">1.32</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">:</span> <span class="mf">0.365</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">:</span> <span class="mf">0.367</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">:</span> <span class="mf">0.365</span><span class="p">],</span>
   <span class="s1">&#39;6&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">1.66</span><span class="p">,</span> <span class="s1">&#39;ext1&#39;</span><span class="p">:</span> <span class="mf">0.441</span><span class="p">,</span> <span class="s1">&#39;ext2&#39;</span><span class="p">:</span> <span class="mf">0.443</span><span class="p">,</span> <span class="s1">&#39;ext3&#39;</span><span class="p">:</span> <span class="mf">0.444</span><span class="p">]</span>
   <span class="p">}</span>
</pre></div>
</td></tr></table>

<p><strong>Create a table; formats</strong></p>
<ul>
<li>Lists in a list: <ul>
<li>Easy to access/add/delete rows, to sort. </li>
<li>Difficult to deal with columns and a specific cell.</li>
</ul>
</li>
<li>Dictionaries in a dictionary:<ul>
<li>Easy to access column entries.</li>
<li>Easy to read (find data).</li>
<li>Unsorted and impossible to sort.</li>
</ul>
</li>
<li>Mixed lists and dictionaries:<ul>
<li>Use the advantage of both types and build the table accordingly (l, d or d, l for rows, columns) depending on the operations (see above).</li>
<li>The code is harder to read or less straightforward.</li>
</ul>
</li>
</ul>
<p><strong>Convert a table from a nested list to a nested dictionary&hellip;</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;protein&#39;</span><span class="p">,</span> <span class="s1">&#39;ext&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.038</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.089</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.66</span><span class="p">,</span> <span class="mf">0.184</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.00</span><span class="p">,</span> <span class="mf">0.280</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.32</span><span class="p">,</span> <span class="mf">0.365</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">1.66</span><span class="p">,</span> <span class="mf">0.441</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># convert nested list to nested dict</span>
<span class="n">nested_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span> <span class="c1"># for row in table[0:]  includes the header</span>
    <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">entry</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
    <span class="n">nested_dict</span><span class="p">[</span><span class="s1">&#39;row&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span> <span class="o">=</span> <span class="n">entry</span>

<span class="k">print</span> <span class="n">nested_dict</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
<span class="s1">&#39;row1&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">0.16</span><span class="p">,</span> <span class="s1">&#39;ext&#39;</span><span class="p">:</span> <span class="mf">0.038</span><span class="p">},</span>
<span class="s1">&#39;row2&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">0.33</span><span class="p">,</span> <span class="s1">&#39;ext&#39;</span><span class="p">:</span> <span class="mf">0.089</span><span class="p">},</span>
<span class="s1">&#39;row3&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">0.66</span><span class="p">,</span> <span class="s1">&#39;ext&#39;</span><span class="p">:</span> <span class="mf">0.184</span><span class="p">},</span>
<span class="s1">&#39;row4&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;ext&#39;</span><span class="p">:</span> <span class="mf">0.28</span><span class="p">},</span>
<span class="s1">&#39;row5&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">1.32</span><span class="p">,</span> <span class="s1">&#39;ext&#39;</span><span class="p">:</span> <span class="mf">0.365</span><span class="p">},</span>
<span class="s1">&#39;row6&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;protein&#39;</span><span class="p">:</span> <span class="mf">1.66</span><span class="p">,</span> <span class="s1">&#39;ext&#39;</span><span class="p">:</span> <span class="mf">0.441</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p><strong>&hellip;and convert a nested dictionary to a table</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># convert nested dict back to nested list</span>
<span class="n">nested_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">nested_dict</span><span class="p">:</span>
    <span class="n">key</span> <span class="o">=</span> <span class="n">nested_dict</span><span class="p">[</span><span class="n">entry</span><span class="p">]</span>
    <span class="n">nested_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">key</span><span class="p">[</span><span class="s1">&#39;protein&#39;</span><span class="p">],</span> <span class="n">key</span><span class="p">[</span><span class="s1">&#39;ext&#39;</span><span class="p">]])</span>

<span class="k">print</span> <span class="n">nested_list</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">[</span>
<span class="p">[</span><span class="mf">0.16</span><span class="p">,</span> <span class="mf">0.038</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.33</span><span class="p">,</span> <span class="mf">0.089</span><span class="p">],</span>
<span class="p">[</span><span class="mf">0.66</span><span class="p">,</span> <span class="mf">0.184</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.28</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1.32</span><span class="p">,</span> <span class="mf">0.365</span><span class="p">],</span>
<span class="p">[</span><span class="mf">1.66</span><span class="p">,</span> <span class="mf">0.441</span><span class="p">]</span>
<span class="p">]</span>
</pre></div>
</td></tr></table>

<h4 id="chapter-8-sorting-data">Chapter 8, Sorting Data<a class="headerlink" href="#chapter-8-sorting-data" title="Permanent link">&para;</a></h4>
<p><strong>Sort a table by one column and write it to a file</strong></p>
<p><sub>add, index, list</sub></p>
<ul>
<li><code class="codehilite">sorted()</code>.</li>
<li><code class="codehilite">itemgetter()</code>; turn elements of each column into a sortable key.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>

<span class="c1"># read table to a nested list of floats</span>
<span class="n">table</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;random_distribution.tsv&quot;</span><span class="p">):</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>
    <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># sort the table by second column</span>
<span class="n">column</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">table_sorted</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">itemgetter</span><span class="p">(</span><span class="n">column</span><span class="p">))</span>

<span class="c1"># format table as strings</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table_sorted</span><span class="p">:</span>
    <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span>
    <span class="k">print</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Output (first 3 lines only):</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>6153.0  58.0    0.00942629611572    40.0    0.00650089387291    260.0   0.0422558101739
6101.0  64.0    0.0104900835929 41.0    0.00672020980167    299.0   0.0490083592854
6101.0  68.0    0.0111457138174 39.0    0.0063923946894 274.0   0.0449106703819
</pre></div>
</td></tr></table>

<p><strong>List are good for sorting</strong></p>
<ul>
<li>ASCII sort order chart (top to bottom, left to right):</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>space</td>
<td>0</td>
<td>:</td>
<td>A</td>
<td>Q</td>
<td>[</td>
<td>a</td>
<td>q</td>
<td>}</td>
</tr>
<tr>
<td>!</td>
<td>1</td>
<td>;</td>
<td>B</td>
<td>R</td>
<td>\</td>
<td>b</td>
<td>r</td>
<td>tick</td>
</tr>
<tr>
<td>&ldquo;</td>
<td>2</td>
<td>&lt;</td>
<td>C</td>
<td>S</td>
<td>]</td>
<td>c</td>
<td>s</td>
<td>{</td>
</tr>
<tr>
<td>#</td>
<td>3</td>
<td>=</td>
<td>D</td>
<td>T</td>
<td>^</td>
<td>d</td>
<td>t</td>
<td><sub></td>
</tr>
<tr>
<td>$</td>
<td>4</td>
<td>&gt;</td>
<td>E</td>
<td>U</td>
<td>_</td>
<td>e</td>
<td>u</td>
<td>DEL</td>
</tr>
<tr>
<td>%</td>
<td>5</td>
<td>?</td>
<td>F</td>
<td>V</td>
<td>`</td>
<td>f</td>
<td>v</td>
<td></td>
</tr>
<tr>
<td>&amp;</td>
<td>6</td>
<td>@</td>
<td>G</td>
<td>W</td>
<td></td>
<td>g</td>
<td>w</td>
<td></td>
</tr>
<tr>
<td>&lsquo;</td>
<td>7</td>
<td></td>
<td>H</td>
<td>X</td>
<td></td>
<td>h</td>
<td>x</td>
<td></td>
</tr>
<tr>
<td>(</td>
<td>8</td>
<td></td>
<td>I</td>
<td>Y</td>
<td></td>
<td>i</td>
<td>y</td>
<td></td>
</tr>
<tr>
<td>)</td>
<td>9</td>
<td></td>
<td>J</td>
<td>Z</td>
<td></td>
<td>j</td>
<td>z</td>
<td></td>
</tr>
<tr>
<td>*</td>
<td></td>
<td></td>
<td>K</td>
<td></td>
<td></td>
<td>k</td>
<td></td>
<td></td>
</tr>
<tr>
<td>+</td>
<td></td>
<td></td>
<td>L</td>
<td></td>
<td></td>
<td>l</td>
<td></td>
<td></td>
</tr>
<tr>
<td>,</td>
<td></td>
<td></td>
<td>M</td>
<td></td>
<td></td>
<td>m</td>
<td></td>
<td></td>
</tr>
<tr>
<td>-</td>
<td></td>
<td></td>
<td>N</td>
<td></td>
<td></td>
<td>n</td>
<td></td>
<td></td>
</tr>
<tr>
<td>.</td>
<td></td>
<td></td>
<td>O</td>
<td></td>
<td></td>
<td>o</td>
<td></td>
<td></td>
</tr>
<tr>
<td>/</td>
<td></td>
<td></td>
<td>P</td>
<td></td>
<td></td>
<td>p</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Difference between <code class="codehilite">sort()</code> and <code class="codehilite">sorted()</code></strong></p>
<ul>
<li><code class="codehilite">sort()</code>; apply to lists</li>
<li><code class="codehilite">sorted()</code>; apply to lists, tuples, and dictionary keys.</li>
<li><code class="codehilite">reverse()</code> sort the other way around.</li>
<li><code class="codehilite">sorted(data, reverse = True)</code>; idem.</li>
<li><code class="codehilite">operator.itemgetter(i)(T)</code> returns the <code class="codehilite">i</code>th element of <code class="codehilite">T</code>, a string, a list, a tuple, or a dictionary.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">data</span><span class="p">)</span>
<span class="s1">&#39;A&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)(</span><span class="n">data</span><span class="p">)</span>
<span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">new_table</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<p><strong>Sort entries in a tabular output file in reverse order</strong></p>
<ul>
<li>Notice the <code class="codehilite">table_sorted = sorted(table, key = itemgetter(2), reverse=True)</code>.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>

<span class="n">input_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;BlastOut.csv&quot;</span><span class="p">)</span>
<span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;BlastOutSorted.csv&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>

<span class="c1"># read BLAST output table</span>
<span class="n">table</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">input_file</span><span class="p">:</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">col</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

<span class="n">table_sorted</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="n">itemgetter</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># write sorted table to an output file</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table_sorted</span><span class="p">:</span>
    <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span>
    <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">input_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><strong>Sort a tuple by converting it to a list</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># sort a tuple</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">list_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">list_data</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">new_tup</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="k">print</span> <span class="n">new_tup</span>

<span class="c1"># sort a tuple using the sorted() built-in function</span>
<span class="n">new_tup</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="k">print</span> <span class="n">new_tup</span>
</pre></div>
</td></tr></table>

<p>Both outputs:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Convert a dictionary to a sorted list</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span>
        <span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="mi">36</span><span class="p">:</span> <span class="s1">&#39;z&#39;</span><span class="p">}</span>

<span class="c1"># create a list of keys and go through them one by one</span>
<span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">keys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>


<span class="c1"># sort keys using the sorted() built-in function</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>1  a
2  b
3  c
4  d
5  t
6  m
36 z
1  a
2  b
3  c
4  d
5  t
6  m
36 z
</pre></div>
</td></tr></table>

<p><strong>Sort strings by their length</strong></p>
<p><sub>lamda, function</sub></p>
<ul>
<li>Use a <code class="codehilite">lambda</code> function and replace <code class="codehilite">itemgetter()</code>.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ASDF&#39;</span><span class="p">,</span> <span class="s1">&#39;SDFSADGSAG&#39;</span><span class="p">,</span> <span class="s1">&#39;SDFSD&#39;</span><span class="p">,</span> <span class="s1">&#39;GSGDGG&#39;</span><span class="p">]</span>

<span class="n">new_data</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="k">print</span> <span class="n">new_data</span>
</pre></div>
</td></tr></table>

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ASDF&#39;</span><span class="p">,</span> <span class="s1">&#39;SDFSADGSAG&#39;</span><span class="p">,</span> <span class="s1">&#39;SDFSD&#39;</span><span class="p">,</span> <span class="s1">&#39;GSGDGG&#39;</span><span class="p">]</span>

<span class="n">new_data</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">col</span><span class="p">:</span> <span class="n">col</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># alternative</span>
<span class="k">print</span> <span class="n">new_data</span>
</pre></div>
</td></tr></table>

<p>Same output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">[</span><span class="s1">&#39;ASDF&#39;</span><span class="p">,</span> <span class="s1">&#39;SDFSD&#39;</span><span class="p">,</span> <span class="s1">&#39;GSGDGG&#39;</span><span class="p">,</span> <span class="s1">&#39;SDFSADGSAG&#39;</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p><strong>Sort a table by seven columns in one operation</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>

<span class="c1"># read table</span>
<span class="n">in_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;random_distribution.tsv&quot;</span><span class="p">)</span>
<span class="n">table</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">in_file</span><span class="p">:</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>
    <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>

<span class="n">table_sorted</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">print</span> <span class="n">table_sorted</span>
</pre></div>
</td></tr></table>

<p>Output (first 3 lines only):</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">[</span>
<span class="p">[</span><span class="mf">6041.0</span><span class="p">,</span> <span class="mf">87.0</span><span class="p">,</span> <span class="mf">0.0144015891409</span><span class="p">,</span> <span class="mf">44.0</span><span class="p">,</span> <span class="mf">0.00728356232412</span><span class="p">,</span> <span class="mf">213.0</span><span class="p">,</span> <span class="mf">0.035259063069</span><span class="p">],</span>
<span class="p">[</span><span class="mf">6042.0</span><span class="p">,</span> <span class="mf">121.0</span><span class="p">,</span> <span class="mf">0.0200264812976</span><span class="p">,</span> <span class="mf">35.0</span><span class="p">,</span> <span class="mf">0.00579278384641</span><span class="p">,</span> <span class="mf">262.0</span><span class="p">,</span> <span class="mf">0.0433631247931</span><span class="p">],</span>
<span class="p">[</span><span class="mf">6044.0</span><span class="p">,</span> <span class="mf">113.0</span><span class="p">,</span> <span class="mf">0.0186962276638</span><span class="p">,</span> <span class="mf">67.0</span><span class="p">,</span> <span class="mf">0.0110853739246</span><span class="p">,</span> <span class="mf">266.0</span><span class="p">,</span> <span class="mf">0.0440105890139</span><span class="p">],</span>
<span class="o">...</span>
<span class="p">]</span>
</pre></div>
</td></tr></table>

<p><strong>Sort entries in a tabular BLAST output file in reverse order</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>

<span class="n">input_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;BlastOut.csv&quot;</span><span class="p">)</span>
<span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;BlastOutSorted.csv&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>

<span class="c1"># read BLAST output table</span>
<span class="n">table</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">input_file</span><span class="p">:</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">col</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

<span class="n">table_sorted</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># write sorted table to an output file</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table_sorted</span><span class="p">:</span>
    <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span>
    <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">input_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><strong>Sort entries in a comma separated file by two columns</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span>

<span class="n">input_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;PDBhaemoglobinReport.csv&quot;</span><span class="p">)</span>
<span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;PDBhaemoglobinSorted.csv&quot;</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>

<span class="n">table</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">header</span> <span class="o">=</span> <span class="n">input_file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">input_file</span><span class="p">:</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="n">col</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">col</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">col</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">table</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>

<span class="n">table_sorted</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">table_sorted</span><span class="p">:</span>
    <span class="n">row</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span>
    <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">input_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<h4 id="chapter-9-pattern-matching-and-text-mining">Chapter 9, Pattern Matching and Text Mining<a class="headerlink" href="#chapter-9-pattern-matching-and-text-mining" title="Permanent link">&para;</a></h4>
<p><strong>Find a sequence pattern in a sequence</strong></p>
<p><sub>regex, regular expression</sub></p>
<ul>
<li><code class="codehilite">re</code> package.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="c1"># define a string with occurrences of regex:</span>
<span class="n">seq</span> <span class="o">=</span> <span class="s1">&#39;VSVLTMFRYAGWLDRLYMLVGTQLAAIIHGVALPLMMLI&#39;</span>

<span class="c1"># compile a pattern and assign it to a variable</span>
<span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;[ST]Q&#39;</span><span class="p">)</span>

<span class="c1"># search for the pattern in the string</span>
<span class="n">match</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
<span class="k">if</span> <span class="n">match</span><span class="p">:</span>
    <span class="c1"># print the first match along the sequence with the group() method</span>
    <span class="c1"># 4 characters before and after the pattern</span>
    <span class="k">print</span> <span class="s1">&#39;</span><span class="si">%10s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="n">seq</span><span class="p">[</span><span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">()</span> <span class="o">-</span> <span class="mi">4</span><span class="p">:</span><span class="n">match</span><span class="o">.</span><span class="n">end</span><span class="p">()</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span>
    <span class="k">print</span> <span class="s1">&#39;</span><span class="si">%6s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span> <span class="s2">&quot;no match&quot;</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>MLVGTQLAAI
    TQ
</pre></div>
</td></tr></table>

<p><strong><code class="codehilite">re</code> methods</strong></p>
<ul>
<li><code class="codehilite">group()</code>; return the matching subgroup.</li>
<li><code class="codehilite">span()</code>; return a tuple containing the starting and ending position of the match.</li>
<li><code class="codehilite">start()</code>; return the starting position.</li>
<li><code class="codehilite">end()</code>; return the ending position.</li>
<li><code class="codehilite">search()</code>; find the <strong>first</strong> occurence within the string.</li>
<li><code class="codehilite">match()</code>; attempt to match a pattern to a string. If the pattern is within the string, it will not match it. It will find &lsquo;S&rsquo; in &lsquo;ST&rsquo;, but not in &lsquo;TST&rsquo;. </li>
<li><code class="codehilite">findall()</code>; return a list containing <strong>all</strong> the matching substrings.</li>
<li><code class="codehilite">finditer()</code>; find <strong>all</strong> the match objects corresponding to the regex matches and returns them in the form of an iterator.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;R.[ST][^P]&#39;</span><span class="p">)</span>
<span class="n">seq</span> <span class="o">=</span> <span class="s1">&#39;RQSAMGSNKSKPKDASQRRRSLEPAENVHGAGGGAFPASQRPSKP&#39;</span>

<span class="c1"># findall returns a list of all matches</span>
<span class="n">matches</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
<span class="k">print</span> <span class="n">matches</span>

<span class="c1"># finditer returns an iterator of match objects</span>
<span class="n">match_iter</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
<span class="k">for</span> <span class="n">match</span> <span class="ow">in</span> <span class="n">match_iter</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(),</span> <span class="n">match</span><span class="o">.</span><span class="n">span</span><span class="p">(),</span> <span class="n">match</span><span class="o">.</span><span class="n">start</span><span class="p">(),</span> <span class="n">match</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p>Ouput:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">[</span><span class="s1">&#39;RQSA&#39;</span><span class="p">,</span> <span class="s1">&#39;RRSL&#39;</span><span class="p">,</span> <span class="s1">&#39;RPSK&#39;</span><span class="p">]</span>
<span class="n">RQSA</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="mi">0</span> <span class="mi">4</span>
<span class="n">RRSL</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">22</span><span class="p">)</span> <span class="mi">18</span> <span class="mi">22</span>
<span class="n">RPSK</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">44</span><span class="p">)</span> <span class="mi">40</span> <span class="mi">44</span>
</pre></div>
</td></tr></table>

<p><strong>More <code class="codehilite">re</code> methods</strong></p>
<ul>
<li>Divide regex in subgroups, each matching a different component of interest.</li>
<li><code class="codehilite">(.)</code>; delimite a group.</li>
<li><code class="codehilite">R(.)[ST][^P]</code>; stand for &lsquo;R&rsquo;, &lsquo;any character&rsquo;, pattern &lsquo;ST&rsquo;, any character different from &lsquo;P&rsquo;.<ul>
<li>The &lsquo;any character&rsquo; is also a subgroup.</li>
<li>What ever is found between <code class="codehilite">R</code> and <code class="codehilite">[ST][^P]</code> is a subgroup.</li>
</ul>
</li>
<li><code class="codehilite">R(.{0,3})[ST][^P]</code>; add a `{0,3}.<ul>
<li>This qualifier or quantifiers means that at least 0 and at most 3 repetitions of &lsquo;R&rsquo;.</li>
</ul>
</li>
<li><code class="codehilite">group()</code>; always return the complete matching substring (0 for no subgroup).</li>
<li><code class="codehilite">group(#)</code>; return subgroups numbered from left to right in increasing order (subgroup #).</li>
</ul>
<p><strong>Find multiple patterns in a search string</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="n">seq</span> <span class="o">=</span> <span class="s1">&#39;QSAMGSNKSKPKDASQRRRSLEPAENVHGAGGGAFPASQRPSKP&#39;</span>

<span class="n">pattern1</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;R(.)[ST][^P]&#39;</span><span class="p">)</span>
<span class="n">match1</span> <span class="o">=</span> <span class="n">pattern1</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
<span class="k">print</span> <span class="n">match1</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
<span class="k">print</span> <span class="n">match1</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">pattern2</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;R(.{0,3})[ST][^P]&#39;</span><span class="p">)</span>
<span class="n">match2</span> <span class="o">=</span> <span class="n">pattern2</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
<span class="k">print</span> <span class="n">match2</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
<span class="k">print</span> <span class="n">match2</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>RRSL
R
RRRSL
RR
</pre></div>
</td></tr></table>

<p><strong>Another example with two subgroups</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="n">seq</span> <span class="o">=</span> <span class="s1">&#39;zzabcdzz&#39;</span>

<span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;(a(b)c)d&#39;</span><span class="p">)</span>
<span class="n">match</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
<span class="k">print</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">print</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">print</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="k">print</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<ul>
<li><code class="codehilite">groups()</code>; return a tuple with the substrings corresponding to all subgroups.</li>
</ul>
<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">abcd</span>
<span class="n">abc</span>
<span class="n">b</span>
<span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Assign  names to subgroup: <code class="codehilite">?P&lt;w1&gt;</code> and <code class="codehilite">?P&lt;w2&gt;</code></strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="n">seq</span> <span class="o">=</span> <span class="s1">&#39;zzabcdzz&#39;</span>

<span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;(?P&lt;w1&gt;a(?P&lt;w2&gt;b)c)d&#39;</span><span class="p">)</span>
<span class="n">match</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
<span class="k">print</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">print</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;w1&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s1">&#39;w2&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Ouput:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>abcd
abc
b
</pre></div>
</td></tr></table>

<p><strong>More <code class="codehilite">re</code> methods</strong></p>
<ul>
<li><code class="codehilite">splits(s)</code>; split the string <code class="codehilite">s</code> at the matches of a regex.</li>
<li><code class="codehilite">sub(r, s, [c])</code>; return a new string <code class="codehilite">s</code> where nonoverlapping occurrences of a given pattern in the string are all replaced with the value of <code class="codehilite">r</code>. <code class="codehilite">c</code>, an optional number, stands for the maximum numbers of occurences.</li>
<li><code class="codehilite">subn(r, s, [c])</code>; do what <code class="codehilite">sub()</code> does, but returns a tuple of two elements; the first element is the new string (as with <code class="codehilite">sub(r, s, [c])</code>) and the second is the number of replacements.</li>
</ul>
<p><strong>Split text and replace separators with a pattern</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="n">separator</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;\|&#39;</span><span class="p">)</span>

<span class="c1"># split</span>
<span class="n">annotation</span> <span class="o">=</span> <span class="s1">&#39;ATOM:CA|RES:ALA|CHAIN:B|NUMRES:166&#39;</span>
<span class="n">columns</span> <span class="o">=</span> <span class="n">separator</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">annotation</span><span class="p">)</span>
<span class="k">print</span> <span class="n">columns</span>

<span class="c1"># replace</span>
<span class="n">new_annotation</span> <span class="o">=</span> <span class="n">separator</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">,</span> <span class="n">annotation</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;replace all |:&quot;</span>
<span class="k">print</span> <span class="n">new_annotation</span>

<span class="n">new_annotation2</span> <span class="o">=</span> <span class="n">separator</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">,</span> <span class="n">annotation</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;replace 2 |:&quot;</span>
<span class="k">print</span> <span class="n">new_annotation2</span>

<span class="n">new_annotation3</span> <span class="o">=</span> <span class="n">separator</span><span class="o">.</span><span class="n">subn</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">,</span> <span class="n">annotation</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;replace all |:&quot;</span>
<span class="k">print</span> <span class="n">new_annotation3</span>

<span class="n">new_annotation4</span> <span class="o">=</span> <span class="n">separator</span><span class="o">.</span><span class="n">subn</span><span class="p">(</span><span class="s1">&#39;@&#39;</span><span class="p">,</span> <span class="n">annotation</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="k">print</span> <span class="s2">&quot;replace 2 |:&quot;</span>
<span class="k">print</span> <span class="n">new_annotation4</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">[</span><span class="s1">&#39;ATOM:CA&#39;</span><span class="p">,</span> <span class="s1">&#39;RES:ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;CHAIN:B&#39;</span><span class="p">,</span> <span class="s1">&#39;NUMRES:166&#39;</span><span class="p">]</span>
<span class="n">replace</span> <span class="nb">all</span> <span class="o">|</span><span class="p">:</span>
<span class="n">ATOM</span><span class="p">:</span><span class="n">CA</span><span class="nd">@RES</span><span class="p">:</span><span class="n">ALA</span><span class="nd">@CHAIN</span><span class="p">:</span><span class="n">B</span><span class="nd">@NUMRES</span><span class="p">:</span><span class="mi">166</span>
<span class="n">replace</span> <span class="mi">2</span> <span class="o">|</span><span class="p">:</span>
<span class="n">ATOM</span><span class="p">:</span><span class="n">CA</span><span class="nd">@RES</span><span class="p">:</span><span class="n">ALA</span><span class="nd">@CHAIN</span><span class="p">:</span><span class="n">B</span><span class="o">|</span><span class="n">NUMRES</span><span class="p">:</span><span class="mi">166</span>
<span class="n">replace</span> <span class="nb">all</span> <span class="o">|</span><span class="p">:</span>
<span class="p">(</span><span class="s1">&#39;ATOM:CA@RES:ALA@CHAIN:B@NUMRES:166&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">replace</span> <span class="mi">2</span> <span class="o">|</span><span class="p">:</span>
<span class="p">(</span><span class="s1">&#39;ATOM:CA@RES:ALA@CHAIN:B|NUMRES:166&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Find transcription factor binding sites</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="n">genome_seq</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;genome.txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="c1"># read transcription factor binding site patterns</span>
<span class="n">sites</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;TFBS.txt&#39;</span><span class="p">):</span>
    <span class="n">fields</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">tf</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">site</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sites</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">tf</span><span class="p">,</span> <span class="n">site</span><span class="p">))</span>

<span class="c1"># match all TF&#39;s to the genome and print matches</span>
<span class="k">for</span> <span class="n">tf</span><span class="p">,</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">sites</span><span class="p">:</span>
    <span class="n">tfbs_regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">site</span><span class="p">)</span>
    <span class="n">all_matches</span> <span class="o">=</span> <span class="n">tfbs_regexp</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">genome_seq</span><span class="p">)</span>
    <span class="n">matches</span> <span class="o">=</span> <span class="n">tfbs_regexp</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">genome_seq</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">all_matches</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">tf</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span>
        <span class="k">for</span> <span class="n">tfbs</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">tfbs</span><span class="o">.</span><span class="n">group</span><span class="p">(),</span> <span class="n">tfbs</span><span class="o">.</span><span class="n">start</span><span class="p">(),</span> <span class="n">tfbs</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><strong>Parse abstracts from PubMed HTML pages</strong></p>
<ul>
<li>The script opens the HTML webpage and parses it in order to selectively fetch some parts of it.</li>
<li>Extract the title and the abstract text.</li>
<li>The title of the paper is enclosed between <code class="codehilite">&lt;h1&gt;</code> and <code class="codehilite">&lt;/h1&gt;</code>.</li>
<li>Whereas the text of the abstract is enclosed between <code class="codehilite"><span class="nt">&lt;h3&gt;</span>Abstract<span class="nt">&lt;/h3&gt;&lt;div</span> <span class="na">class =</span> <span class="s">&quot;&quot;</span><span class="nt">&gt;&lt;p&gt;</span></code> and <code class="codehilite">&lt;/p&gt;</code>.</li>
<li><a href="http://www.ncbi.nlm.nih.gov/pubmed/18235848">The paper.</a></li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">urllib2</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="n">pmid</span> <span class="o">=</span> <span class="s1">&#39;18235848&#39;</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://www.ncbi.nlm.nih.gov/pubmed?term=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">pmid</span>
<span class="n">handler</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">html</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">title_regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;&lt;h1&gt;.{5,400}&lt;/h1&gt;&#39;</span><span class="p">)</span>
<span class="n">title_text</span> <span class="o">=</span> <span class="n">title_regexp</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

<span class="n">abstract_regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;&lt;AbstractText&gt;.{20,3000}&lt;/AbstractText&gt;&#39;</span><span class="p">)</span>
<span class="n">abstract_text</span> <span class="o">=</span> <span class="n">abstract_regexp</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

<span class="k">print</span> <span class="s1">&#39;TITLE:&#39;</span><span class="p">,</span> <span class="n">title_text</span><span class="o">.</span><span class="n">group</span><span class="p">()</span> 
<span class="k">print</span> <span class="s1">&#39;ABSTRACT:&#39;</span><span class="p">,</span> <span class="n">abstract_text</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>TITLE: <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Quantitative high-throughput screen identifies inhibitors of the Schistosoma mansoni redox cascade.<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
ABSTRACT: <span class="p">&lt;</span><span class="nt">AbstractText</span><span class="p">&gt;</span>Schistosomiasis is a tropical disease associated with high morbidity and mortality, currently affecting over 200 million people worldwide. Praziquantel is the only drug used to treat the disease, and with its increased use the probability of developing drug resistance has grown significantly. The Schistosoma parasites can survive for up to decades in the human host due in part to a unique set of antioxidant enzymes that continuously degrade the reactive oxygen species produced by the host&#39;s innate immune response. Two principal components of this defense system have been recently identified in S. mansoni as thioredoxin/glutathione reductase (TGR) and peroxiredoxin (Prx) and as such these enzymes present attractive new targets for anti-schistosomiasis drug development. Inhibition of TGR/Prx activity was screened in a dual-enzyme format with reducing equivalents being transferred from NADPH to glutathione via a TGR-catalyzed reaction and then to hydrogen peroxide via a Prx-catalyzed step. A fully automated quantitative high-throughput (qHTS) experiment was performed against a collection of 71,028 compounds tested as 7- to 15-point concentration series at 5 microL reaction volume in 1536-well plate format. In order to generate a robust data set and to minimize the effect of compound autofluorescence, apparent reaction rates derived from a kinetic read were utilized instead of end-point measurements. Actives identified from the screen, along with previously untested analogues, were subjected to confirmatory experiments using the screening assay and subsequently against the individual targets in secondary assays. Several novel active series were identified which inhibited TGR at a range of potencies, with IC(50)s ranging from micromolar to the assay response limit ( approximately 25 nM). This is, to our knowledge, the first report of a large-scale HTS to identify lead compounds for a helminthic disease, and provides a paradigm that can be used to jump-start development of novel therapeutics for other neglected tropical diseases.<span class="p">&lt;/</span><span class="nt">AbstractText</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p><strong>Search for keywords in a series of PubMed abstracts</strong></p>
<ul>
<li>This example can be applied to perform very simple text mining and can be compared to the &ldquo;find&rdquo; tool in Microsoft Word.</li>
<li>It might stop on the first occurence.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">urllib2</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="c1"># word to be searched</span>
<span class="n">word_regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;schistosoma&#39;</span><span class="p">)</span>

<span class="c1"># list of PMIDs where we want to search the word</span>
<span class="n">pmids</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;18235848&#39;</span><span class="p">,</span> <span class="s1">&#39;22607149&#39;</span><span class="p">,</span> <span class="s1">&#39;22405002&#39;</span><span class="p">,</span> <span class="s1">&#39;21630672&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">pmid</span> <span class="ow">in</span> <span class="n">pmids</span><span class="p">:</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://www.ncbi.nlm.nih.gov/pubmed?term=&#39;</span> <span class="o">+</span> <span class="n">pmid</span>
    <span class="n">handler</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">title_regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;&lt;h1&gt;.{5,400}&lt;/h1&gt;&#39;</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">title_regexp</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">.</span><span class="n">group</span><span class="p">()</span> 
    <span class="n">abstract_regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;&lt;AbstractText&gt;.{20,3000}&lt;/AbstractText&gt;&#39;</span><span class="p">)</span>
    <span class="n">abstract</span> <span class="o">=</span> <span class="n">abstract_regexp</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
    <span class="n">abstract</span> <span class="o">=</span> <span class="n">abstract</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
    <span class="n">word</span> <span class="o">=</span> <span class="n">word_regexp</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">abstract</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">word</span><span class="p">:</span>
        <span class="c1"># display title and where the keyword was found</span>
        <span class="k">print</span> <span class="n">title</span>
        <span class="k">print</span> <span class="n">word</span><span class="o">.</span><span class="n">group</span><span class="p">(),</span> <span class="n">word</span><span class="o">.</span><span class="n">start</span><span class="p">(),</span> <span class="n">word</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<ul>
<li>Circumvent the problem with the <code class="codehilite">finditer()</code> method.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">urllib2</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="c1"># word to be searched</span>
<span class="n">word_regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;schistosoma&#39;</span><span class="p">)</span>

<span class="c1"># list of PMIDs where we want to search the word</span>
<span class="n">pmids</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;18235848&#39;</span><span class="p">,</span> <span class="s1">&#39;22607149&#39;</span><span class="p">,</span> <span class="s1">&#39;22405002&#39;</span><span class="p">,</span> <span class="s1">&#39;21630672&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">pmid</span> <span class="ow">in</span> <span class="n">pmids</span><span class="p">:</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://www.ncbi.nlm.nih.gov/pubmed?term=&#39;</span> <span class="o">+</span> <span class="n">pmid</span>
    <span class="n">handler</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">handler</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">title_regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;&lt;h1&gt;.{5,400}&lt;/h1&gt;&#39;</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">title_regexp</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="o">.</span><span class="n">group</span><span class="p">()</span> 
    <span class="n">abstract_regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;&lt;AbstractText&gt;.{20,3000}&lt;/AbstractText&gt;&#39;</span><span class="p">)</span>
    <span class="n">abstract</span> <span class="o">=</span> <span class="n">abstract_regexp</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
    <span class="n">abstract</span> <span class="o">=</span> <span class="n">abstract</span><span class="o">.</span><span class="n">group</span><span class="p">()</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">word_regexp</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">abstract</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">words</span><span class="p">:</span>
        <span class="c1"># display title and where the keyword was found</span>
        <span class="k">print</span> <span class="n">title</span>
        <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
            <span class="k">print</span> <span class="n">word</span><span class="o">.</span><span class="n">group</span><span class="p">(),</span> <span class="n">word</span><span class="o">.</span><span class="n">start</span><span class="p">(),</span> <span class="n">word</span><span class="o">.</span><span class="n">end</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Quantitative high-throughput screen identifies inhibitors of the Schistosoma mansoni redox cascade.<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>The redox biology of schistosome parasites and applications for drug development.<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Moonlighting by different stressors: crystal structure of the chaperone species of a 2-Cys peroxiredoxin.<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Investigations of the catalytic mechanism of thioredoxin glutathione reductase from Schistosoma mansoni.<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p><strong>More <code class="codehilite">re</code> methods</strong></p>
<ul>
<li><code class="codehilite">findall()</code>; look for all (non-overlapping) occurrences of pattern in string; return a list of matches.</li>
<li><code class="codehilite">finditer()</code>; same as above except returns an iterator instead of a list; for each match, the iterator returns a match object; it is adapted for loops!</li>
<li><code class="codehilite">|</code>;  &lsquo;OR&rsquo;.</li>
<li><code class="codehilite">$</code>; indicate that a match exists in the string only if the pattern is in the last position of the string.</li>
<li><code class="codehilite">^</code>; indicate that a match exists in the string only if the pattern is in the first position of the string.</li>
</ul>
<p><strong>Python Regex, Characters and Metacharaters</strong></p>
<p><img alt="Regex" src="../img/managing_your_biological/regex.png" /></p>
<h4 id="part-3-modular-programming">Part 3, Modular Programming<a class="headerlink" href="#part-3-modular-programming" title="Permanent link">&para;</a></h4>
<h4 id="chapter-10-divide-a-program-into-functions">Chapter 10, Divide a Program into Functions<a class="headerlink" href="#chapter-10-divide-a-program-into-functions" title="Permanent link">&para;</a></h4>
<p><strong>Built-in functions</strong></p>
<p><sub>length, total, sum, range</sub></p>
<ul>
<li><code class="codehilite">len()</code>.</li>
<li><code class="codehilite">sum()</code>.</li>
<li><code class="codehilite">range(n, m, step)</code>; from n to m-1, n = 0 by default.</li>
<li><code class="codehilite">xrange(n, m, step)</code>; better suited for big numbers.</li>
</ul>
<p><strong>Define functions</strong></p>
<p><sub>docstring, docstrings</sub></p>
<ul>
<li>The documentation is retrieved with the <code class="codehilite">__doc__</code> attribute: type <code class="codehilite">addition.__doc__</code>.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">addition</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    documentation: calculates the sum of two numbers</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">arg1</span> <span class="o">+</span> <span class="n">arg2</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="k">print</span> <span class="n">addition</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Lambda functions</strong></p>
<ul>
<li>Small anonymous functions; they are not declared using <code class="codehilite">def</code>.</li>
<li>They do not contain return statement.</li>
<li>They can be defined in an argument in a function (useful).</li>
<li>There are nameless.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span>

<span class="k">print</span> <span class="n">f</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>vs</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span>

<span class="k">print</span> <span class="n">g</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>or</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<ul>
<li>Use a <code class="codehilite">lambda</code> function as an argument of a built-in function:</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ASDF&#39;</span><span class="p">,</span> <span class="s1">&#39;SDFSADGSAG&#39;</span><span class="p">,</span> <span class="s1">&#39;SDFSD&#39;</span><span class="p">,</span> <span class="s1">&#39;GSGDGG&#39;</span><span class="p">]</span>

<span class="n">new_data</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="k">print</span> <span class="n">new_data</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">[</span><span class="s1">&#39;ASDF&#39;</span><span class="p">,</span> <span class="s1">&#39;SDFSD&#39;</span><span class="p">,</span> <span class="s1">&#39;GSGDGG&#39;</span><span class="p">,</span> <span class="s1">&#39;SDFSADGSAG&#39;</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p><strong>Function Arguments</strong></p>
<ol>
<li>required arguments.</li>
<li>keyword arguments.</li>
<li>default arguments.</li>
<li>variable-length arguments.</li>
</ol>
<p><strong>1. Required Arguments</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">print_funct</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">seq</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">num</span><span class="p">,</span> <span class="n">seq</span>

<span class="n">print_funct</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;ABC&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">10</span> <span class="n">ABC</span>
</pre></div>
</td></tr></table>

<p><strong>2. Keyword Arguments</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">print_funct</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">seq</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">num</span><span class="p">,</span> <span class="n">seq</span>

<span class="n">print_funct</span><span class="p">(</span><span class="n">seq</span> <span class="o">=</span> <span class="s2">&quot;ABC&quot;</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">10</span> <span class="n">ABC</span>
</pre></div>
</td></tr></table>

<p><strong>3. Default Arguments</strong></p>
<p><sub>sequence</sub></p>
<ul>
<li>The argument is given by default; but can be overwritten!</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">print_funct</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">seq</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">num</span><span class="p">,</span> <span class="n">seq</span>

<span class="n">print_funct</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;ABC&quot;</span><span class="p">)</span>
<span class="n">print_funct</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">10</span> <span class="n">ABC</span>
<span class="mi">10</span> <span class="n">A</span>
</pre></div>
</td></tr></table>

<p><strong>4. Variable-Length Arguments</strong></p>
<p><sub>argument, list, tuple, dictionary</sub></p>
<ul>
<li>Flexibility of providing any tuple.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">print_args</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">args</span>

<span class="n">print_args</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">print_args</span><span class="p">(</span><span class="s1">&#39;Hi&#39;</span><span class="p">)</span>
<span class="n">print_args</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s2">&quot;ABC&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="p">(</span><span class="s1">&#39;Hi&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;ABC&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<ul>
<li>Provide both the keys and values for a returned dictionary.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">print_args2</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">args</span>

<span class="n">print_args2</span><span class="p">(</span><span class="n">num</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">num2</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">seq</span> <span class="o">=</span> <span class="s2">&quot;ABC&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span><span class="s1">&#39;num&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;seq&#39;</span><span class="p">:</span> <span class="s1">&#39;ABC, &#39;</span><span class="n">num2</span><span class="s1">&#39;: 200}</span>
</pre></div>
</td></tr></table>

<p><strong>Convert a string into a tuple or vice-versa</strong></p>
<ul>
<li><code class="codehilite">struct</code> package.</li>
<li>In the format, <code class="codehilite">s</code> stands for string, <code class="codehilite">3s</code> stands for a three-character string.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">struct</span>

<span class="c1"># pack() method; creates a string</span>
<span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;2s1s1s1s1s&#39;</span>
<span class="n">group</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">format</span><span class="p">,</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">group</span>

<span class="c1"># unpack() method; parses the string to a tuple</span>
<span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;1s2s1s1s&#39;</span>
<span class="n">line</span> <span class="o">=</span> <span class="s1">&#39;12345&#39;</span>
<span class="n">col</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">format</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span>
<span class="k">print</span> <span class="n">col</span>

<span class="c1"># calcsize() returns the number of characters</span>
<span class="c1"># in a given format string</span>
<span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;30s30s20s1s&#39;</span>
<span class="k">print</span> <span class="n">struct</span><span class="o">.</span><span class="n">calcsize</span><span class="p">(</span><span class="n">format</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mi">102345</span>
<span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;23&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">)</span>
<span class="mi">81</span>
</pre></div>
</td></tr></table>

<ul>
<li>Then, convert the tuple to a list if needed.</li>
</ul>
<p><strong>Function to calculate distance between two coordinates</strong></p>
<p><sub>power</sub></p>
<ul>
<li><code class="codehilite">math</code> package.<ul>
<li><code class="codehilite">pow(x, y)</code> replaces <code class="codehilite">x ** y</code>.</li>
</ul>
</li>
<li><code class="codehilite">distance</code> package; geometric calculations.<ul>
<li><code class="codehilite">calc-dist()</code>.</li>
</ul>
</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>

<span class="k">def</span> <span class="nf">calc_dist</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;returns the pythagorian distance between two 3D points&#39;&#39;&#39;</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dy</span> <span class="o">=</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dz</span> <span class="o">=</span> <span class="n">p1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">p2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">distsq</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">pow</span><span class="p">(</span><span class="n">dy</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">pow</span><span class="p">(</span><span class="n">dz</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">distance</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">distsq</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">distance</span>

<span class="k">print</span> <span class="n">calc_dist</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">9.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="mf">10.3923048454</span>
</pre></div>
</td></tr></table>

<h4 id="chapter-11-managing-complexity-with-classes">Chapter 11 Managing Complexity with Classes<a class="headerlink" href="#chapter-11-managing-complexity-with-classes" title="Permanent link">&para;</a></h4>
<p><strong>Classes</strong></p>
<ul>
<li>Define a Class: <code class="codehilite"><span class="kr">class</span> <span class="nx">Protein</span></code>.</li>
<li>Add docstrings.</li>
<li>The constructor <code class="codehilite">__init__()</code> is a special function that defines what kinds of data your class should contain and enables the creation of instances. Add a docstring.</li>
<li>One class can have many instances. <code class="codehilite">lys = Protein(&#39;lysozyme&#39;)</code> is an instance of <code class="codehilite"><span class="kr">class</span> <span class="nx">Protein</span></code>.</li>
<li>Create a class function; a class function works like a method.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Protein</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Class storing protein names&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Sets the name of a protein&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Writes protein name to the screen.&#39;&#39;&#39;</span>
        <span class="k">print</span> <span class="s1">&#39;I am &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

<span class="n">lys</span> <span class="o">=</span> <span class="n">Protein</span><span class="p">(</span><span class="s1">&#39;lysozyme&#39;</span><span class="p">)</span>
<span class="n">myo</span> <span class="o">=</span> <span class="n">Protein</span><span class="p">(</span><span class="s1">&#39;myoglobin&#39;</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">&quot;Docstrings:&quot;</span>
<span class="k">print</span> <span class="n">Protein</span><span class="o">.</span><span class="vm">__doc__</span>
<span class="k">print</span> <span class="n">Protein</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__doc__</span>
<span class="k">print</span> <span class="n">Protein</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="vm">__doc__</span>

<span class="k">print</span> <span class="s2">&quot;&quot;</span>

<span class="k">print</span> <span class="n">lys</span><span class="o">.</span><span class="n">name</span>
<span class="k">print</span> <span class="n">myo</span><span class="o">.</span><span class="n">name</span>

<span class="n">lys</span><span class="o">.</span><span class="n">write</span><span class="p">()</span> <span class="c1"># a class function works like a method</span>
<span class="n">myo</span><span class="o">.</span><span class="n">write</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">Docstrings</span><span class="p">:</span>
<span class="n">Class</span> <span class="n">storing</span> <span class="n">protein</span> <span class="n">names</span>
<span class="n">Sets</span> <span class="n">the</span> <span class="n">name</span> <span class="n">of</span> <span class="n">a</span> <span class="n">protein</span>
<span class="n">Writes</span> <span class="n">protein</span> <span class="n">name</span> <span class="n">to</span> <span class="n">the</span> <span class="n">screen</span><span class="o">.</span>

<span class="n">lysozyme</span>
<span class="n">myoglobin</span>
<span class="n">I</span> <span class="n">am</span> <span class="n">lysozyme</span>
<span class="n">I</span> <span class="n">am</span> <span class="n">myoglobin</span>
</pre></div>
</td></tr></table>

<p><strong>Printing a object created from a class</strong></p>
<ul>
<li>Printing an object from a class is not very informative.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Pea</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genotype</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">genotype</span> <span class="o">=</span> <span class="n">genotype</span>

<span class="k">class</span> <span class="nc">PeaStrain</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">peas</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peas</span> <span class="o">=</span> <span class="n">peas</span>

<span class="n">yellow</span> <span class="o">=</span> <span class="n">Pea</span><span class="p">(</span><span class="s1">&#39;GG&#39;</span><span class="p">)</span>
<span class="n">green</span> <span class="o">=</span> <span class="n">Pea</span><span class="p">(</span><span class="s1">&#39;gg&#39;</span><span class="p">)</span>
<span class="n">strain</span> <span class="o">=</span> <span class="n">PeaStrain</span><span class="p">([</span><span class="n">yellow</span><span class="p">,</span> <span class="n">green</span><span class="p">])</span>

<span class="k">print</span> <span class="n">Pea</span>
<span class="k">print</span> <span class="n">PeaStrain</span>
<span class="k">print</span> <span class="n">Pea</span><span class="o">.</span><span class="fm">__init__</span>
<span class="k">print</span> <span class="n">PeaStrain</span><span class="o">.</span><span class="fm">__init__</span>

<span class="k">print</span> <span class="n">yellow</span>
<span class="k">print</span> <span class="n">green</span>
<span class="k">print</span> <span class="n">strain</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">__main__</span><span class="o">.</span><span class="n">Pea</span>
<span class="n">__main__</span><span class="o">.</span><span class="n">PeaStrain</span>
<span class="o">&lt;</span><span class="n">unbound</span> <span class="n">method</span> <span class="n">Pea</span><span class="o">.</span><span class="fm">__init__</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">unbound</span> <span class="n">method</span> <span class="n">PeaStrain</span><span class="o">.</span><span class="fm">__init__</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">__main__</span><span class="o">.</span><span class="n">Pea</span> <span class="n">instance</span> <span class="n">at</span> <span class="mh">0x0000000001DC6748</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">__main__</span><span class="o">.</span><span class="n">Pea</span> <span class="n">instance</span> <span class="n">at</span> <span class="mh">0x0000000001DC6748</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">__main__</span><span class="o">.</span><span class="n">Pea</span> <span class="n">instance</span> <span class="n">at</span> <span class="mh">0x000000000216BE08</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">__main__</span><span class="o">.</span><span class="n">PeaStrain</span> <span class="n">instance</span> <span class="n">at</span> <span class="mh">0x000000000216BE48</span><span class="o">&gt;</span>
</pre></div>
</td></tr></table>

<ul>
<li><code class="codehilite">__repr__</code> fixes this problem. The <code class="codehilite">__repr__</code> method takes no parameters except self.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Pea</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genotype</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">genotype</span> <span class="o">=</span> <span class="n">genotype</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;genotype: [</span><span class="si">%s</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">genotype</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">PeaStrain</span><span class="p">:</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">peas</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">peas</span> <span class="o">=</span> <span class="n">peas</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;strain with </span><span class="si">%i</span><span class="s1"> peas&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">peas</span><span class="p">))</span>

<span class="n">yellow</span> <span class="o">=</span> <span class="n">Pea</span><span class="p">(</span><span class="s1">&#39;GG&#39;</span><span class="p">)</span>
<span class="n">green</span> <span class="o">=</span> <span class="n">Pea</span><span class="p">(</span><span class="s1">&#39;gg&#39;</span><span class="p">)</span>
<span class="n">strain</span> <span class="o">=</span> <span class="n">PeaStrain</span><span class="p">([</span><span class="n">yellow</span><span class="p">,</span> <span class="n">green</span><span class="p">])</span>

<span class="k">print</span> <span class="n">Pea</span>
<span class="k">print</span> <span class="n">PeaStrain</span>
<span class="k">print</span> <span class="n">Pea</span><span class="o">.</span><span class="fm">__init__</span>
<span class="k">print</span> <span class="n">PeaStrain</span><span class="o">.</span><span class="fm">__init__</span>

<span class="k">print</span> <span class="n">yellow</span>
<span class="k">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">yellow</span><span class="p">)</span>
<span class="k">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">green</span><span class="p">)</span>
<span class="k">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">strain</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>New output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">__main__</span><span class="o">.</span><span class="n">Pea</span>
<span class="n">__main__</span><span class="o">.</span><span class="n">PeaStrain</span>
<span class="o">&lt;</span><span class="n">unbound</span> <span class="n">method</span> <span class="n">Pea</span><span class="o">.</span><span class="fm">__init__</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">unbound</span> <span class="n">method</span> <span class="n">PeaStrain</span><span class="o">.</span><span class="fm">__init__</span><span class="o">&gt;</span>
<span class="n">genotype</span><span class="p">:</span> <span class="p">[</span><span class="n">GG</span><span class="p">]</span>
<span class="n">genotype</span><span class="p">:</span> <span class="p">[</span><span class="n">GG</span><span class="p">]</span>
<span class="n">genotype</span><span class="p">:</span> <span class="p">[</span><span class="n">gg</span><span class="p">]</span>
<span class="n">strain</span> <span class="k">with</span> <span class="mi">2</span> <span class="n">peas</span>
</pre></div>
</td></tr></table>

<ul>
<li>
<p>No difference between <code class="codehilite">print yellow</code> and <code class="codehilite">print repr(yellow)</code>.</p>
</li>
<li>
<p>Objects&rsquo; predefined class attributes:</p>
<ul>
<li><code class="codehilite">__doc__</code>: the docstring.</li>
<li><code class="codehilite">__dict__</code>: a list of attributes.</li>
<li><code class="codehilite">__name__</code>: the name of the object.</li>
<li><code class="codehilite">__bases__</code>: the object inherits from what object. For example, above, the PeaStrain class inherits from the Pea class. Classes (subclasses) can inherit from other classes<br />
and extend their functionality.</li>
<li><code class="codehilite">__module__</code>: the name of the module in which this class was defined. <code class="codehilite">__main__</code> means the object is in the current module. </li>
</ul>
</li>
<li>
<p>A python script can be imported just like a package:</p>
<ul>
<li><code class="codehilite"><span class="kn">import</span> <span class="nn">Protein</span></code>.</li>
<li><code class="codehilite"><span class="kn">from</span> <span class="nn">Protein</span> <span class="kn">import</span> <span class="n">write</span></code>.</li>
<li><code class="codehilite"><span class="kn">import</span> <span class="nn">math</span></code>.</li>
<li><code class="codehilite"><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span></code>.</li>
</ul>
</li>
<li>Synonyms: packages, library, module, script, etc.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Pea</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;docstring 1&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">genotype</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">genotype</span> <span class="o">=</span> <span class="n">genotype</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;genotype: [</span><span class="si">%s</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">genotype</span><span class="p">)</span>

<span class="n">yellow</span> <span class="o">=</span> <span class="n">Pea</span><span class="p">(</span><span class="s1">&#39;GG&#39;</span><span class="p">)</span>

<span class="k">print</span> <span class="n">yellow</span>
<span class="k">print</span> <span class="n">Pea</span><span class="o">.</span><span class="vm">__doc__</span>
<span class="k">print</span> <span class="n">Pea</span><span class="o">.</span><span class="vm">__dict__</span>
<span class="k">print</span> <span class="n">Pea</span><span class="o">.</span><span class="vm">__name__</span>
<span class="k">print</span> <span class="n">Pea</span><span class="o">.</span><span class="vm">__bases__</span>
<span class="k">print</span> <span class="n">Pea</span><span class="o">.</span><span class="vm">__module__</span>

<span class="k">print</span> <span class="s2">&quot;&quot;</span>

<span class="k">class</span> <span class="nc">Peaclone</span><span class="p">(</span><span class="n">Pea</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;docstring 2&#39;&#39;&#39;</span>

<span class="n">blue</span> <span class="o">=</span> <span class="n">Peaclone</span><span class="p">(</span><span class="s1">&#39;AA&#39;</span><span class="p">)</span>

<span class="k">print</span> <span class="n">blue</span>
<span class="k">print</span> <span class="n">Peaclone</span><span class="o">.</span><span class="vm">__doc__</span>
<span class="k">print</span> <span class="n">Peaclone</span><span class="o">.</span><span class="vm">__dict__</span>
<span class="k">print</span> <span class="n">Peaclone</span><span class="o">.</span><span class="vm">__name__</span>
<span class="k">print</span> <span class="n">Peaclone</span><span class="o">.</span><span class="vm">__bases__</span>
<span class="k">print</span> <span class="n">Peaclone</span><span class="o">.</span><span class="vm">__module__</span>
</pre></div>
</td></tr></table>

<p>Output:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">genotype</span><span class="p">:</span> <span class="p">[</span><span class="n">GG</span><span class="p">]</span>
<span class="n">docstring</span> <span class="mi">1</span>
<span class="p">{</span><span class="s1">&#39;__module__&#39;</span><span class="p">:</span> <span class="s1">&#39;__main__&#39;</span><span class="p">,</span> <span class="s1">&#39;__doc__&#39;</span><span class="p">:</span> <span class="s1">&#39;docstring 1&#39;</span><span class="p">,</span> <span class="s1">&#39;__init__&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">function</span> <span class="fm">__init__</span> <span class="n">at</span> <span class="mh">0x000000000229FC18</span><span class="o">&gt;</span><span class="p">,</span> <span class="s1">&#39;__repr__&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">function</span> <span class="fm">__repr__</span> <span class="n">at</span> <span class="mh">0x000000000229FC88</span><span class="o">&gt;</span><span class="p">}</span>
<span class="n">Pea</span>
<span class="p">()</span>
<span class="n">__main__</span>

<span class="n">genotype</span><span class="p">:</span> <span class="p">[</span><span class="n">AA</span><span class="p">]</span>
<span class="n">docstring</span> <span class="mi">2</span>
<span class="p">{</span><span class="s1">&#39;__module__&#39;</span><span class="p">:</span> <span class="s1">&#39;__main__&#39;</span><span class="p">,</span> <span class="s1">&#39;__doc__&#39;</span><span class="p">:</span> <span class="s1">&#39;docstring 2&#39;</span><span class="p">}</span>
<span class="n">Peaclone</span>
<span class="p">(</span><span class="o">&lt;</span><span class="k">class</span> <span class="nc">__main__</span><span class="o">.</span><span class="n">Pea</span> <span class="n">at</span> <span class="mh">0x0000000001D3C828</span><span class="o">&gt;</span><span class="p">,)</span>
<span class="n">__main__</span>
</pre></div>
</td></tr></table>

<ul>
<li>More attributes:<ul>
<li><code class="codehilite">__del__</code>.</li>
<li><code class="codehilite">__getattr__</code>.</li>
<li><code class="codehilite">__setattr__</code>.</li>
<li><code class="codehilite">__delattr__</code>.</li>
</ul>
</li>
</ul>
<h4 id="chapter-12-debugging">Chapter 12 Debugging<a class="headerlink" href="#chapter-12-debugging" title="Permanent link">&para;</a></h4>
<p><sub>bug</sub></p>
<ul>
<li>Kinds of errors:<ol>
<li>Logical errors.</li>
<li>Syntax errors.</li>
<li>Runtime errors.</li>
</ol>
</li>
</ul>
<p>IDE (Eric, PyCharm, etc.) automate debugging.</p>
<p><strong>1. Logical (semantic) errors</strong></p>
<ul>
<li>Results are wrong because the program does something different from what you had in mind.</li>
</ul>
<p><strong>2. Syntax errors</strong></p>
<ul>
<li>Wrong symbol, mispelling, wrong position in the code, etc..</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lower</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="mi">300</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Analyze a two-column table. Counts data points in three bins.&quot;&quot;&quot;</span>

    <span class="n">smaller</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">between</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">bigger</span>  <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">length</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">length</span> <span class="o">&lt;</span> <span class="n">lower</span><span class="p">:</span>
            <span class="n">smaller</span> <span class="o">=</span> <span class="n">smaller</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">lower</span> <span class="o">&lt;</span> <span class="n">length</span> <span class="o">&lt;</span> <span class="n">upper</span><span class="p">:</span>
            <span class="n">between</span> <span class="o">=</span> <span class="n">between</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">length</span> <span class="o">&gt;</span> <span class="n">upper</span><span class="p">:</span>
            <span class="n">bigger</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">smaller</span><span class="p">,</span> <span class="n">between</span><span class="p">,</span> <span class="n">bigger</span>

<span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Reads neuron lengths from a text file.&quot;&quot;&quot;</span>

    <span class="n">primary</span><span class="p">,</span> <span class="n">secondry</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="n">category</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;Primary&quot;</span>
            <span class="n">primary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;Secondary&quot;</span><span class="p">:</span>
            <span class="n">secondary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">primary</span><span class="p">,</span> <span class="n">secondary</span>

<span class="k">def</span> <span class="nf">write_output</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">count_pri</span><span class="p">,</span> <span class="n">count_sec</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Writes counted values to a file.&quot;&quot;&quot;</span>

    <span class="n">output</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
    <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;category      &lt;100  100-300   &gt;300</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Primary  :  </span><span class="si">%5i</span><span class="s2">   </span><span class="si">%5i</span><span class="s2">   </span><span class="si">%5i</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">count_pri</span><span class="p">)</span>
    <span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Secondary:  </span><span class="si">%5i</span><span class="s2">   </span><span class="si">%5i</span><span class="s2">   </span><span class="si">%5i</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">count_sec</span><span class="p">)</span>
    <span class="n">output</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">primary</span><span class="p">,</span> <span class="n">secondary</span> <span class="o">=</span> <span class="n">read_data</span><span class="p">(</span><span class="s1">&#39;neuron_data.xls&#39;</span><span class="p">)</span>
<span class="n">count_pri</span> <span class="o">=</span> <span class="n">evaluate_data</span><span class="p">(</span><span class="n">primary</span><span class="p">)</span>
<span class="n">count_sec</span> <span class="o">=</span> <span class="n">evaluate_data</span><span class="p">(</span><span class="n">secondary</span><span class="p">)</span>
<span class="n">write_output_file</span><span class="p">(</span><span class="s1">&#39;results.txt&#39;</span> <span class="p">,</span> <span class="n">count_pri</span><span class="p">,</span><span class="n">count_sec</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Bug 1</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">if</span> <span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;Primary&quot;</span>
</pre></div>
</td></tr></table>

<ul>
<li>Cause: <code class="codehilite"><span class="n">SyntaxError</span><span class="o">:</span> <span class="n">invalid</span> <span class="n">syntax</span></code>.</li>
<li>Fix:</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">if</span> <span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;Primary&quot;</span><span class="p">:</span>
</pre></div>
</td></tr></table>

<ul>
<li>Other common <code class="codehilite">SyntaxErrors</code>:<ul>
<li><code class="codehilite">EOL</code>or End Of Line; an open quote somewhere without a matching closing quote.</li>
<li><code class="codehilite">TokenError</code>; an open parenthesis, but not a matching closing parenthesis.</li>
<li>etc.</li>
</ul>
</li>
</ul>
<p><strong>Bug 2</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">write_output_file</span><span class="p">(</span><span class="s1">&#39;results.txt&#39;</span> <span class="p">,</span> <span class="n">count_pri</span><span class="p">,</span><span class="n">count_sec</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<ul>
<li>Cause: <code class="codehilite"><span class="n">NameError</span><span class="o">:</span> <span class="n">name</span> <span class="s1">&#39;write_output_file&#39;</span> <span class="k">is</span> <span class="n">not</span> <span class="n">defined</span></code>.</li>
<li>Fix:</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nb">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;results.txt&#39;</span> <span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="nb">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">count_pri</span><span class="p">))</span>
<span class="nb">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">count_sec</span><span class="p">))</span>
<span class="nb">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><strong>3. Runtime Error</strong></p>
<p><strong><code class="codehilite">IOError</code></strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">primary</span><span class="p">,</span> <span class="n">secondary</span> <span class="o">=</span> <span class="n">read_data</span><span class="p">(</span><span class="s1">&#39;neuron_data.xls&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<ul>
<li>Cause: <code class="codehilite">IOError: [Errno21] No such file or directory: &#39;neuron_data.xls&#39;</code></li>
<li>Fix: the file extention is .txt.</li>
<li>Other common bugs and causes:<ul>
<li>Mispelled files, directory name.</li>
<li>Wrong website URL.</li>
<li>User without the permission or access.</li>
<li>The file is already opened.</li>
<li>Problem with the Internet connection.</li>
<li>Whitespace, uppercase, lowercase letters.</li>
<li>File in a different directory.</li>
<li>Expected date format.</li>
<li>etc.</li>
</ul>
</li>
</ul>
<p><strong><code class="codehilite">NameError</code></strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">primary</span><span class="p">,</span> <span class="n">secondry</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
<span class="o">...</span>
<span class="o">...</span>
<span class="k">elif</span> <span class="n">category</span> <span class="o">==</span> <span class="s2">&quot;Secondary&quot;</span><span class="p">:</span>
</pre></div>
</td></tr></table>

<ul>
<li>Cause: <code class="codehilite">NameError: &#39;secondary&#39; is not defined</code>. The &lsquo;name&rsquo; was misspelled when called.</li>
<li>Fix: add the line <code class="codehilite">print dir()</code> before the errors occurs. It shows the list of variables that are known. In the above case, only <code class="codehilite">secondry</code> exits while <code class="codehilite">secondary</code> is called. Choose one.</li>
<li>Other common bugs and causes:<ul>
<li>Unknown object name:<ul>
<li>a name was not imported (<code class="codehilite"><span class="kn">import</span> <span class="o">*</span></code>).</li>
<li>a name was not initialized (as in <code class="codehilite">counter = 0</code> for <code class="codehilite">counter += 1</code>).</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong><code class="codehilite">IndexError</code></strong></p>
<ul>
<li>Cause and fix: when <code class="codehilite">print data[3]</code> looks into <code class="codehilite">data = [1, 2, 3]</code>, the list index is out of range.</li>
</ul>
<p><strong><code class="codehilite">KeyError</code></strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">spam</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cat&#39;</span><span class="p">:</span> <span class="s1">&#39;Zophie&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">:</span> <span class="s1">&#39;Basil&#39;</span><span class="p">,</span> <span class="s1">&#39;mouse&#39;</span><span class="p">:</span> <span class="s1">&#39;Whiskers&#39;</span><span class="p">}</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;The name of my pet zebra is &#39;</span> <span class="o">+</span> <span class="n">spam</span><span class="p">[</span><span class="s1">&#39;zebra&#39;</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<ul>
<li>Cause and fix: the key does not exist!</li>
</ul>
<p><strong><code class="codehilite">ImportError</code></strong></p>
<ul>
<li>Causes and fixes:<ul>
<li>The imported module name is mispelled.</li>
<li>The imported module is located in a subdirectory without an <code class="codehilite">__init__.py</code> file.</li>
<li>Try adding import sys and print sys.path; you need to add the directory to the PYTHONPATH variable or to append it to the sys.path.</li>
<li>The imported module has a duplicate name (two functions with the same name; try working with classes to avoir that).</li>
</ul>
</li>
</ul>
<p><strong><code class="codehilite">ValueError</code></strong></p>
<ul>
<li>Cause and fix: when an object is loaded with a wrong type to perform another operation; variable <code class="codehilite">range_a</code> should be a number for the loop <code class="codehilite">for a in range(range_a):</code>, but a string is given instead.</li>
<li>Other common bugs and causes: <code class="codehilite"><span class="n">IndentationError</span><span class="o">:</span> <span class="n">unexpected</span> <span class="n">indent</span></code>, <code class="codehilite"><span class="n">IndentationError</span><span class="o">:</span> <span class="n">unindent</span> <span class="n">does</span> <span class="n">not</span> <span class="n">match</span> <span class="n">any</span> <span class="n">outer</span> <span class="n">indentation</span> <span class="n">level</span></code>, and <code class="codehilite"><span class="n">IndentationError</span><span class="o">:</span> <span class="n">expected</span> <span class="n">an</span> <span class="n">indented</span> <span class="n">block</span></code>.</li>
</ul>
<p><strong><code class="codehilite">TypeError</code></strong></p>
<ul>
<li>Cause and fix: an object does not support item assignment.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">spam</span> <span class="o">=</span> <span class="s1">&#39;I have a pet cat.&#39;</span>
<span class="n">spam</span><span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span>
</pre></div>
</td></tr></table>

<ul>
<li>Cause:  cannot convert implicitly an object.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">numEggs</span> <span class="o">=</span> <span class="mi">12</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;I have &#39;</span> <span class="o">+</span> <span class="n">numEggs</span> <span class="o">+</span> <span class="s1">&#39; eggs.&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<ul>
<li>Fix:</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">numEggs</span> <span class="o">=</span> <span class="mi">12</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;I have &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">numEggs</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; eggs.&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<ul>
<li>Cause:  an object is misinterpreted (for another object).</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">spam</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;dog&#39;</span><span class="p">,</span> <span class="s1">&#39;mouse&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">spam</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">spam</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<ul>
<li>Fix: <code class="codehilite">for i in spam:</code>.</li>
</ul>
<p><strong><code class="codehilite">AttributeError</code></strong></p>
<ul>
<li>Cause and fix: apply the right method.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">spam</span> <span class="o">=</span> <span class="s1">&#39;THIS IS IN LOWERCASE.&#39;</span>
<span class="n">spam</span> <span class="o">=</span> <span class="n">spam</span><span class="o">.</span><span class="n">lowerr</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><strong><code class="codehilite">UnboundLocalError</code></strong></p>
<ul>
<li>Cause and fix: a variable is referenced before assignment.</li>
</ul>
<p><strong>Countermeasures to prevent errors</strong></p>
<ul>
<li>Break down the code in parts; print to a file using <code class="codehilite">python code.py &gt; output.txt</code>.</li>
<li>Compare the input and output (print the input data, print the output data, create control points).</li>
<li>Add lots of <code class="codehilite">print</code> statements within the code as control points,</li>
<li>Use descriptive and explicit object names (<code class="codehilite">sequence_file</code> is better than <code class="codehilite">s_file</code>).</li>
<li>Start function with verbs (<code class="codehilite">read_sequence_file</code> is better than <code class="codehilite">seq_file</code>).</li>
<li>Add comments.</li>
<li>Avoid <code class="codehilite"><span class="kn">import</span> <span class="o">*</span></code>, but rather <code class="codehilite"><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span></code>.</li>
<li>Follow PEP8 and PEP20! <code class="codehilite">pylint</code> and <code class="codehilite">flake8</code> packages.</li>
<li>IDE (Eric, PyCharm, Spyder, etc.) automate debugging and easily execute <code class="codehilite">pylint</code> and <code class="codehilite">flake8</code>.</li>
</ul>
<p><strong>A note on <code class="codehilite">raw_input()</code> and <code class="codehilite">input()</code></strong></p>
<p><sub>python2, python3, py2, py3</sub></p>
<ul>
<li>In Python 2, <code class="codehilite">raw_input()</code> takes exactly what the user typed and passes it back as a string. <code class="codehilite">input()</code> takes the <code class="codehilite">raw_input()</code> and performs an <code class="codehilite">eval()</code> on it as well. <code class="codehilite">input()</code> expects a syntactically correct python statement where <code class="codehilite">raw_input()</code> does not.</li>
<li>The <code class="codehilite">eval()</code> function run the code within itself:</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;x + 1&#39;</span><span class="p">)</span>
<span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">eval</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="mi">1</span>
</pre></div>
</td></tr></table>

<ul>
<li>In Python 3, <code class="codehilite">raw_input()</code> is renamed to <code class="codehilite">input()</code> and the old <code class="codehilite">input()</code> is removed. If you want to use the old <code class="codehilite">input()</code>, you can do <code class="codehilite">eval(input())</code>.</li>
</ul>
<p><strong>Countermeasures to prevent errors: the Python debugger or <code class="codehilite">pdb</code></strong></p>
<ul>
<li><code class="codehilite">pdb</code> package.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># on top of the code</span>
<span class="kn">import</span> <span class="nn">pdb</span>

<span class="n">pdb</span><span class="o">.</span><span class="n">set_trace</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<ul>
<li>The code is executed line by line:<ul>
<li>&lsquo;n&rsquo; execute the next line.</li>
<li>&lsquo;s&rsquo; execute the next line but does not descend into functions.</li>
<li>&lsquo;l&rsquo; shows where in the code the program currently is.</li>
<li>&lsquo;c&rsquo; continues execution normally.</li>
</ul>
</li>
</ul>
<p><strong>Countermeasurea to prevent errors: <code class="codehilite">try, except</code></strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">raw_input</span><span class="p">(</span><span class="s2">&quot;Insert a number:&quot;</span><span class="p">))</span>
    <span class="k">print</span> <span class="n">a</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
    <span class="k">print</span> <span class="s2">&quot;You haven&#39;t inserted a number. Please retry.&quot;</span>
    <span class="k">raise</span> <span class="ne">SystemExit</span>
</pre></div>
</td></tr></table>

<ul>
<li><code class="codehilite">else</code> is optional and only executed if no exception was generated.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s2">&quot;Insert a filename:&quot;</span><span class="p">)</span>
    <span class="n">in_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">IOError</span><span class="p">:</span>
    <span class="k">print</span> <span class="s2">&quot;The filename </span><span class="si">%s</span><span class="s2"> has not been found.&quot;</span> <span class="o">%</span> <span class="n">filename</span>
    <span class="k">raise</span> <span class="ne">SystemExit</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">in_file</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">line</span>
        <span class="n">in_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<ul>
<li>Usually, exceptions are typos and wrong entries:<ul>
<li><code class="codehilite">SyntaxError</code>.</li>
<li><code class="codehilite">IOError</code>.</li>
<li><code class="codehilite">NameError</code>.</li>
<li><code class="codehilite">ValueError</code>.</li>
</ul>
</li>
<li>Rarely will we see:<ul>
<li><code class="codehilite">IndexError</code>.</li>
<li><code class="codehilite">KeyError</code>.</li>
<li><code class="codehilite">ImportError</code>.</li>
<li><code class="codehilite">TypeError</code>.</li>
<li><code class="codehilite">AttributeError</code>.</li>
<li><code class="codehilite">UnbounLocalError</code>.</li>
</ul>
</li>
</ul>
<h4 id="chapter-13-using-external-modules-the-python-interface-to-r">Chapter 13, Using External Modules, The Python Interface to R<a class="headerlink" href="#chapter-13-using-external-modules-the-python-interface-to-r" title="Permanent link">&para;</a></h4>
<ul>
<li><code class="codehilite">RPy2</code> package; bridge Python with R.</li>
</ul>
<p>The R code:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>p <span class="o">=</span> <span class="kc">pi</span>
x <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">6</span><span class="p">)</span>
y <span class="o">=</span> <span class="kp">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span>
m <span class="o">=</span> <span class="kt">matrix</span><span class="p">(</span>y<span class="p">,</span> nrow <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
n <span class="o">=</span> <span class="kt">matrix</span><span class="p">(</span>y<span class="p">,</span> ncol <span class="o">=</span> <span class="m">5</span><span class="p">)</span>
f <span class="o">=</span> read.table<span class="p">(</span><span class="s">&#39;RandomDistribution.tsv&#39;</span><span class="p">,</span> sep <span class="o">=</span> <span class="s">&#39;\t&#39;</span><span class="p">)</span>
f_matrix <span class="o">=</span> <span class="kt">matrix</span><span class="p">(</span>f<span class="p">,</span> ncol <span class="o">=</span> <span class="m">7</span><span class="p">)</span>
mean_first_col <span class="o">=</span> <span class="kp">mean</span><span class="p">(</span>f_mean<span class="p">[</span><span class="m">0</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<p>The Python code:</p>
<p><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">rpy2.reobjects</span> <span class="kn">as</span> <span class="nn">robjects</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">robjects</span><span class="o">.</span><span class="n">r</span>

<span class="n">pi</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">pi</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">seq</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">nrow</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="s2">&quot;read.table(&#39;RandomDistribution.tsv&#39;, sep = &#39;</span><span class="se">\t</span><span class="s2">&#39;)&quot;</span><span class="p">)</span>
<span class="n">f_matrix</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">mean_first_col</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">f_mean</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</td></tr></table><br />
- Python is better suited to implement solutions by building GUIs or freezing the code.<br />
- Rpy2 is the best of both worlds: <br />
    - R statistical analyses and data visualization.<br />
    - Python computation power with SciPy/NumPy/Pandas.</p>
<p><strong>Calculate a mean value from a table file</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">rpy2.robjects</span> <span class="kn">as</span> <span class="nn">robjects</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">robjects</span><span class="o">.</span><span class="n">r</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="s2">&quot;read.table(&#39;RandomDistribution.tsv&#39;, sep = &#39;</span><span class="se">\t</span><span class="s2">&#39;)&quot;</span><span class="p">)</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">mean_first_col</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">print</span> <span class="n">mean_first_col</span>
</pre></div>
</td></tr></table>

<p><strong>Draw a histogram</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">rpy2.robjects</span> <span class="kn">as</span> <span class="nn">ro</span>
<span class="kn">from</span> <span class="nn">rpy2.robjects.packages</span> <span class="kn">import</span> <span class="n">importr</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">r</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="s2">&quot;read.table(&#39;RandomDistribution.tsv&#39;,sep = &#39;</span><span class="se">\t</span><span class="s2">&#39;)&quot;</span><span class="p">)</span>
<span class="n">grdevices</span> <span class="o">=</span> <span class="n">importr</span><span class="p">(</span><span class="s1">&#39;grDevices&#39;</span><span class="p">)</span>
<span class="n">grdevices</span><span class="o">.</span><span class="n">png</span><span class="p">(</span><span class="nb">file</span> <span class="o">=</span> <span class="s2">&quot;Plot.png&quot;</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">512</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">512</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">table</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">grdevices</span><span class="o">.</span><span class="n">dev_off</span><span class="p">()</span>

<span class="n">grdevices</span><span class="o">.</span><span class="n">png</span><span class="p">(</span><span class="nb">file</span><span class="o">=</span><span class="s2">&quot;Histogram.png&quot;</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">512</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">512</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s1">&#39;Distribution of values&#39;</span><span class="p">)</span>
<span class="n">grdevices</span><span class="o">.</span><span class="n">dev_off</span><span class="p">()</span>
</pre></div>
</td></tr></table>

<p><strong>Calculate a z-score and a p-value</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">rpy2.robjects</span> <span class="kn">as</span> <span class="nn">ro</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">r</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="s2">&quot;read.table(&#39;RandomDistribution.tsv&#39;,sep = &#39;</span><span class="se">\t</span><span class="s2">&#39;)&quot;</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">trim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">na_rm</span> <span class="o">=</span> <span class="s1">&#39;FALSE&#39;</span><span class="p">)</span>
<span class="n">sdev</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">sd</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">na_rm</span> <span class="o">=</span> <span class="s1">&#39;FALSE&#39;</span><span class="p">)</span>
<span class="n">value</span> <span class="o">=</span> <span class="mf">0.01844</span>
<span class="n">zscore</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">value</span><span class="p">)</span> <span class="o">/</span> <span class="n">sdev</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span> <span class="n">zscore</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">zscore</span><span class="p">)</span>
<span class="n">pvalue</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">pnorm</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="k">print</span> <span class="n">pvalue</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p><strong>Create an interactive plot and histogram from data in a file</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">rpy2.robjects</span> <span class="kn">as</span> <span class="nn">robjects</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">robjects</span><span class="o">.</span><span class="n">r</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="s2">&quot;read.table(&#39;RandomDistribution.tsv&#39;, sep = &#39;</span><span class="se">\t</span><span class="s2">&#39;)&quot;</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">table</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">r</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">main</span> <span class="o">=</span> <span class="s1">&#39;Distribution of values&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Create an interactive plot</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">rpy2.robjects</span> <span class="kn">as</span> <span class="nn">ro</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">r</span>
<span class="n">r</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">pnorm</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">xlab</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">ylab</span> <span class="o">=</span> <span class="s2">&quot;y&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Conduct a chi-square test on data from a text file</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">rpy2.robjects</span> <span class="kn">as</span> <span class="nn">ro</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">ro</span><span class="o">.</span><span class="n">r</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="s2">&quot;read.table(&#39;Chi-square_input.txt&#39;, header = TRUE, sep = &#39;</span><span class="se">\t</span><span class="s2">&#39;)&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="n">r</span><span class="o">.</span><span class="n">names</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>

<span class="n">cont_table</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">table</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">chitest</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s1">&#39;chisq.test&#39;</span><span class="p">]</span>
<span class="k">print</span> <span class="n">chitest</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">table</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</td></tr></table>

<h4 id="chapter-14-building-program-pipelines">Chapter 14, Building Program Pipelines<a class="headerlink" href="#chapter-14-building-program-pipelines" title="Permanent link">&para;</a></h4>
<ul>
<li><code class="codehilite">os</code> package.</li>
<li><code class="codehilite">sys</code> package.</li>
</ul>
<p><strong>Programs can work together with Python</strong></p>
<ul>
<li>Create path and file variables.</li>
<li>Create command line.</li>
<li>Execute commands from the command line (as if you did it with a mouse and keyboard) with <code class="codehilite">os.system</code>.</li>
</ul>
<p><em>REF: Appendix D.</em></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;/home/RNA-seq/tophat_dir/&#39;</span>
<span class="n">output_file</span> <span class="o">=</span> <span class="s1">&#39;accepted_hits.txt&#39;</span>

<span class="n">command_line</span> <span class="o">=</span> <span class="s1">&#39;pgm -o </span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">output_file</span><span class="p">)</span>

<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">command_line</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Command lines in Python</strong></p>
<ul>
<li>UNIX to Python:<ul>
<li>UNIX <code class="codehilite">pwd</code>; <code class="codehilite">print os.getcwd()</code>.</li>
<li>UNIX <code class="codehilite">ls</code>; <code class="codehilite">print os.listdir(&#39;.&#39;)</code>.</li>
<li>UNIX <code class="codehilite">cd</code>; <code class="codehilite">os.chdir(&#39;../data/&#39;)</code>.</li>
<li>UNIX <code class="codehilite">mkdir</code>; <code class="codehilite">os.mkdir()</code>.</li>
<li>UNIX <code class="codehilite">rmdir</code>; <code class="codehilite">os.rmdir()</code>.</li>
<li>and many more.</li>
</ul>
</li>
</ul>
<p><strong>Pipelines</strong></p>
<ul>
<li>Pipeline are scripts connecting programs to each other (run two or more external programs from command lines).</li>
<li>A program that runs another program is a <em>wrapper</em>.</li>
<li>Exchange filenames and data between programs.</li>
<li><code class="codehilite">sys.argv</code>; Python program sorted parameters.</li>
<li><code class="codehilite"><span class="kn">import</span> <span class="nn">sys</span></code>; access or print them.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;/home/RNA-seq/&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">pathvariables</span> <span class="kn">import</span> <span class="n">tophat_dir</span><span class="p">,</span> <span class="n">index_dir</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tophat_dir</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">index_dir</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;tophat -o &#39;</span> <span class="o">+</span> <span class="n">tophat_dir</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">index_dir</span> <span class="o">+</span> <span class="s1">&#39;sample.txt&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span> <span class="s2">&quot;You have to create tophat and/or index directories before running your wrapper&quot;</span>
</pre></div>
</td></tr></table>

<ul>
<li>One problem with pipelines is lagging. </li>
<li>The system call of the second program should occur when the execution of the first program has finished, especially if the second one uses as input the output of the first one.</li>
<li>Use subprocesses, such as <code class="codehilite">os.popen()</code> or <code class="codehilite">subprocess.call()</code>, to wait for the command to complete and return a value corresponding to the program exit status (0 for success, 256 for failure)</li>
<li>A more robust trick is to insert an action and verify its success after a system call and before the subsequent system call.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">pathvariables</span> <span class="kn">import</span> <span class="n">tophat_dir</span><span class="p">,</span> <span class="n">index_dir</span><span class="p">,</span> <span class="n">cufflinks_dir</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;/home/RNA-seq/&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pathvariables</span> <span class="kn">import</span> <span class="n">tophat_dir</span><span class="p">,</span> <span class="n">index_dir</span><span class="p">,</span> <span class="n">cufflinks_dir</span>

<span class="c1"># the tophat program crates an output file</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;tophat -o &#39;</span> <span class="o">+</span> <span class="n">tophat_dir</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">index_dir</span> <span class="o">+</span> <span class="s1">&#39;sample.txt&#39;</span><span class="p">)</span>

<span class="c1"># here we don&#39;t know whether the tophat output file is comleted and available</span>
<span class="c1"># we open and close a dummy file, so the operating system catches up</span>
<span class="n">lag_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;dummy.txt, &#39;</span><span class="n">w</span><span class="s1">&#39;)</span>
<span class="n">lag_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;tophat completed&#39;</span><span class="p">)</span>
<span class="n">lag_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># read the output file</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;/home/RNA-seq/dummy.txt&#39;</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;cufflinks -o &#39;</span> <span class="o">+</span> <span class="n">cufflinks_dir</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">tophat_dir</span> <span class="o">+</span> <span class="s1">&#39;/accepted_hits.txt&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><strong>Attributes</strong></p>
<ul>
<li><code class="codehilite">print dir()</code>; Visualize attributes.</li>
<li>Some attributes are module-specific, such as locatime, whereas others refer to modules in general:<ul>
<li><code class="codehilite">__file__</code>; return the path of the module.</li>
<li><code class="codehilite">__doc__</code>; return the module documentation, if present.</li>
<li><code class="codehilite">__name__</code>; return the name of the imported file without the .py suffix if the module is imported and the string <code class="codehilite">&#39;__main__&#39;</code> is executed.<ul>
<li>Execute <code class="codehilite">&lt;statements&gt;</code> only if the module is run from the command line and not imported by means of an import statement:</li>
</ul>
</li>
</ul>
</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="o">&lt;</span><span class="n">statements</span><span class="o">&gt;</span>
</pre></div>
</td></tr></table>

<p><strong>Working with files and directories</strong></p>
<ul>
<li><code class="codehilite">os.path</code> package.</li>
<li><code class="codehilite">os.path.split(filename)</code>; split a filename from the directory names.</li>
<li><code class="codehilite">os.path.exists(filename)</code>; verify if the file exists, return True or False.</li>
</ul>
<p><strong>Export the path</strong></p>
<ul>
<li>In Windows, add the path to the PATH environment variables.<ul>
<li>In PowerShell: <code class="codehilite"><span class="o">$</span><span class="nt">env</span><span class="p">:</span><span class="nd">PYTHONPATH</span> <span class="o">=</span> <span class="s2">&quot;$env:PYTHONPATH;.&quot;</span></code></li>
</ul>
</li>
<li>In UNIX, enter in the bash: <code class="codehilite">export PYTHONPATH=.</code> or <code class="codehilite">add PYTHONPATH=.</code>.</li>
<li>In a Python code, add to the beginning of the script:</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="c1"># &#39;/var/www/&#39;</span>
</pre></div>
</td></tr></table>

<ul>
<li>Or with <code class="codehilite">sys.path.append(&#39;pathmodules/&#39;)</code>.</li>
</ul>
<p><strong>Read files from directories</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="k">for</span> <span class="n">filename</span> <span class="ow">is</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;data/&#39;</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;&lt;my_program&gt;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filename</span><span class="p">))</span>
</pre></div>
</td></tr></table>

<ul>
<li>
<p><code class="codehilite">os.remove(&#39;log.txt&#39;)</code>; remove files.</p>
</li>
<li>
<p><code class="codehilite">tempfile</code> package;  create temporary files. </p>
</li>
</ul>
<h4 id="chapter-15-writing-good-programs">Chapter 15, Writing Good Programs<a class="headerlink" href="#chapter-15-writing-good-programs" title="Permanent link">&para;</a></h4>
<p><strong>Priorities</strong></p>
<ol>
<li>Make it work.</li>
<li>Make it nice.</li>
<li>Make if fast.</li>
</ol>
<p><strong>Tips</strong></p>
<ol>
<li>Divide a programming project into smaller tasks.</li>
<li>What are the inputs?</li>
<li>What are the outputs?</li>
<li>What is between them?</li>
<li>Write smaller programs; split a program into functions and classes.</li>
<li>Analyze and run tests.</li>
<li>Adopt PEP.</li>
<li>Scaffold before writing a functional program:</li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">read_files</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Reads a...</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="n">sequences</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Removes all...</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">pass</span>

<span class="o">...</span>

<span class="k">if</span> <span class="n">__name</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">INPUT_DIR</span> <span class="o">=</span> <span class="s1">&#39;aaa/&#39;</span>
    <span class="n">OUTPUT_FILE</span> <span class="o">=</span> <span class="s1">&#39;filtered.txt&#39;</span>
    <span class="n">seq</span> <span class="o">=</span> <span class="n">read_files</span><span class="p">(</span><span class="n">INPUT_DIR</span><span class="p">)</span>
    <span class="nb">filter</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</td></tr></table>

<p><strong>Adopt PEP</strong></p>
<ul>
<li>Variables in functions in lowercase.</li>
<li>Constants in modules in uppercase.</li>
<li>A function name starts with a verb.</li>
<li>After each function, two empty lines.</li>
<li>After each logical chunks of long functions, one empty line.</li>
<li>Comment.</li>
<li>Keep lines shorter than 80 characters long.</li>
<li>Each class, function, and variable has a docstring; docstrings can be read with <code class="codehilite">print object.__doc__</code>.</li>
</ul>
<p><strong>Enforce PEP</strong></p>
<ul>
<li><code class="codehilite">pylint</code> package.<ul>
<li><code class="codehilite">pylint</code> is a Python source code analyzer which looks for programming errors, helps enforcing a coding standard and sniffs for some code smells.</li>
<li><a href="https://www.pylint.org/">Download</a> an install pylint.</li>
<li>Or install it with <code class="codehilite">pip</code>.</li>
<li><a href="https://www.pylint.org/">Doc</a></li>
<li>Run <code class="codehilite">pylint python_file.py</code>.</li>
</ul>
</li>
<li><code class="codehilite">flake8</code> package.<ul>
<li><code class="codehilite">flake8</code> is a modular source code checker (a <em>wrapper</em>).</li>
<li>It works with <code class="codehilite">pep8</code>, <code class="codehilite">pyflakes</code>, <code class="codehilite">pycodestyle</code>, and so on.</li>
</ul>
</li>
</ul>
<p><strong>Version controls</strong></p>
<ul>
<li>Use version control programs (Mercurial, git, SVN).</li>
<li>Use repository (GitHub, Bitbucket) to control program versions.<ul>
<li>GitHub</li>
<li>Bitbucket</li>
<li>SourceForce</li>
<li>Gitlab</li>
<li>and others.</li>
</ul>
</li>
</ul>
<p><strong>Before releasing (to a repository)</strong></p>
<ol>
<li>Create a directory with a concise name containing all the project.</li>
<li>Set a version number (0.1 or 1.0).</li>
<li>Write a README.TXT file with the name of the program, the author, contacts, numbers, emails, a version number, the program purpose in 50-100 words, how to use the program, simple command-line examples, the license (&ldquo;All rights reserved&rdquo;, MIT, etc.)</li>
<li>Create a zip file out of the directory including the README.TXT file in addition to the unzipped directory.</li>
<li>Release the project on a repository (for example, with git, push the project to the repository).</li>
</ol>
<p><strong>Releasing a distribution</strong></p>
<ul>
<li>Release a distribution to a repository for others to download and install. </li>
</ul>
<p><strong>Freezing a program</strong></p>
<ul>
<li>Non-programmer would rather want an execuble program they can unzip and run.</li>
<li>Compile the code or freeze it!<ol>
<li><code class="codehilite">cx_freeze</code> is a set of utilities that create standalone executables from python scripts for any platform or OS.<br />
    i. There are alternatives to &lsquo;cx_freeze&rsquo; such as <code class="codehilite">bbfreeze</code>.</li>
<li><code class="codehilite">pyinstaller</code> is a simpler alternative (it is not as flexible as <code class="codehilite">cx_freeze</code> but it can create single files).</li>
<li><code class="codehilite">distutils</code> is a Python package that provides support for building and installing additional modules (libraries or packages) into a Python installation. The new modules may be either 100%-pure Python, written in C, or coded in both Python and C. <code class="codehilite">distutils</code> autogenerates an install script.<br />
    i. Such distribution needs a <code class="codehilite">setup.py</code> file with the group of subdirectories and program files.<br />
    i. <code class="codehilite">py2exe</code> is an extension to the <code class="codehilite">distutils</code> package to create executable files on Windows.<br />
    i. <code class="codehilite">py2app</code> is an extension to the <code class="codehilite">distutils</code> packages to create executable files on OS X.</li>
<li><code class="codehilite">nuitka</code> is a Python compiler, compatible with CPython.<br />
    i. CPython is a source code interpreter with an interface with several languages, including C, in which one must explicitly write bindings in a language other than Python.</li>
<li><code class="codehilite">pypy</code> is an alternative to <code class="codehilite">nuitka</code>.</li>
<li>Cython is a compiled language that generates CPython extension modules.</li>
<li>Jython does the same, but in Java.</li>
</ol>
</li>
</ul>
<p><strong>Continuous improvement</strong></p>
<ul>
<li>A good program is never finished:<ol>
<li>Create a baseline release.</li>
<li>Update and release new versions. Tell the users what is new.</li>
<li>Listen to users, improve on it.</li>
<li>Go on programming.</li>
</ol>
</li>
</ul>
<p><strong>Software development</strong></p>
<ul>
<li>The Agile Manifesto.</li>
<li>Methodologies: Scrum, eXtreme Programming, etc.</li>
</ul>
<h4 id="part-4-data-visualization">Part 4, Data Visualization<a class="headerlink" href="#part-4-data-visualization" title="Permanent link">&para;</a></h4>
<h4 id="chapter-16-creating-scientific-diagrams">Chapter 16, Creating Scientific Diagrams<a class="headerlink" href="#chapter-16-creating-scientific-diagrams" title="Permanent link">&para;</a></h4>
<ul>
<li><code class="codehilite">matplotlib</code> package.</li>
<li><code class="codehilite">Pillow</code> or <code class="codehilite">PIL</code> package.</li>
<li>Tip: install the entire SciPy Stack: (Python (2.x &gt;= 2.6 or 3.x &gt;= 3.2), NumPy (&gt;= 1.6), SciPy library (&gt;= 0.10), Matplotlib (&gt;= 1.1) with dateutil and pytz, IPython (&gt;= 0.13) with pyzmq and tornado, pandas (&gt;= 0.8), Sympy (&gt;= 0.7), nose (&gt;= 1.1).</li>
<li><code class="codehilite">Matplotlib</code> depends on <code class="codehilite">Pillow</code> for reading and saving JPEG, BMP, and TIFF image files. <code class="codehilite">Matplotlib</code> requires MiKTeX and GhostScript for rendering text with LaTeX. FFmpeg, avconv, mencoder, or ImageMagick are required for the animation module. Add <code class="codehilite">nose</code>, <code class="codehilite">mock</code>, and Inkscape.</li>
</ul>
<p><strong>Draw a simple line plot</strong></p>
<ul>
<li>Provide <code class="codehilite">(x, y)</code> points.</li>
<li><code class="codehilite">figure()</code>; main function is</li>
<li><code class="codehilite">plot()</code>.</li>
<li><code class="codehilite">savefig()</code>; save the plot in a file.</li>
<li><code class="codehilite">show()</code>; show the plot in a window.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">savefig</span>

<span class="n">xdata</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">ydata</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span>

<span class="n">figure</span><span class="p">()</span>
<span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">)</span>

<span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;figure1.png&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Result:</p>
<p><img alt="Figure 1" src="../img/managing_your_biological/figure1.png" /></p>
<p><strong>Plot a sine function</strong></p>
<ul>
<li>Generate <code class="codehilite">(x, y)</code> points; first the <code class="codehilite">x</code>; then generate the <code class="codehilite">y</code> with the <code class="codehilite">x</code>.</li>
<li><code class="codehilite">plot()</code> with a line type <code class="codehilite">&#39;kd&#39;</code> and <code class="codehilite">linewidth = 1</code>.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">plot</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">savefig</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">figure</span><span class="p">()</span>

<span class="n">xdata</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
<span class="n">ydata</span> <span class="o">=</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">xdata</span><span class="p">]</span>

<span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="s1">&#39;kd&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="mf">4.8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;$y = sin(x)$&quot;</span><span class="p">,</span> <span class="n">horizontalalignment</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>

<span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;sinfunc.png&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Result:</p>
<p><img alt="Sin Function" src="../img/managing_your_biological/sinfunc.png" /></p>
<p><strong>Draw a histogram</strong></p>
<ul>
<li>Provide the <code class="codehilite">(x, y)</code> points in lists, and the number of bins.</li>
<li><code class="codehilite">hist()</code> needs <code class="codehilite">data</code> points and <code class="codehilite">n_bins</code>.</li>
<li><code class="codehilite">alpha</code> stands for the graph color transparency.</li>
<li>Add a title, labels, axes, and gridlines.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">hist</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">savefig</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">n_bins</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">figure</span><span class="p">()</span>
<span class="n">num</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n_bins</span><span class="p">,</span> <span class="n">normed</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">histtype</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>

<span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histogram&#39;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>
<span class="n">axis</span><span class="p">()</span>
<span class="n">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

<span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;histogram.png&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Result:</p>
<p><img alt="Histogram" src="../img/managing_your_biological/histogram.png" /></p>
<p><strong>Draw a bar plot</strong></p>
<ul>
<li><code class="codehilite">count</code>: two series, <code class="codehilite">x1</code> and <code class="codehilite">x2</code> with each four categories, <code class="codehilite">nucleotides</code>. </li>
<li>Add a title, labels, axes and ticks to the axes, and a legend.</li>
<li><code class="codehilite">xticks(x1, nucleotides)</code>,  where the first element is the list of <code class="codehilite">x</code> points and the second element is the label variable.</li>
<li><code class="codehilite">legend()</code> takes the labels of all data sets that are plotted.</li>
<li><code class="codehilite">axis()</code> is set with a list [from left to right, bottom,  and top].</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">xticks</span><span class="p">,</span> <span class="n">bar</span><span class="p">,</span> <span class="n">legend</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">savefig</span>

<span class="n">nucleotides</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;U&quot;</span><span class="p">]</span>

<span class="n">counts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">606</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">759</span><span class="p">,</span> <span class="mi">398</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">762</span><span class="p">,</span> <span class="mi">912</span><span class="p">,</span> <span class="mi">639</span><span class="p">,</span> <span class="mi">591</span><span class="p">],</span>
    <span class="p">]</span>

<span class="n">figure</span><span class="p">()</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;RNA nucleotides in the ribosome&#39;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;RNA&#39;</span><span class="p">)</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;base count&#39;</span><span class="p">)</span>

<span class="n">x1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">]</span>
<span class="n">x2</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x1</span><span class="p">]</span>

<span class="n">xticks</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">nucleotides</span><span class="p">)</span>

<span class="n">bar</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">counts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">width</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#cccccc&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;E.coli 23S&quot;</span><span class="p">)</span>
<span class="n">bar</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">counts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">width</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;#808080&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;T.thermophilus 23S&quot;</span><span class="p">)</span>

<span class="n">legend</span><span class="p">()</span>
<span class="n">axis</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1200</span><span class="p">])</span>

<span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;barplot.png&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Result:</p>
<p><img alt="Bar Plot" src="../img/managing_your_biological/barplot.png" /></p>
<p><strong>Add error bars to a scatterplot or a bar chart</strong></p>
<ul>
<li><code class="codehilite">errorbar()</code>.</li>
<li><code class="codehilite">bar()</code>.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">errorbar</span><span class="p">,</span> <span class="n">bar</span><span class="p">,</span> <span class="n">savefig</span>

<span class="n">figure</span><span class="p">()</span>

<span class="c1"># scatterplot with error bars</span>
<span class="n">x1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>
<span class="n">y1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">err1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
<span class="n">errorbar</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">err1</span> <span class="p">,</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;ro&#39;</span><span class="p">)</span>

<span class="c1"># barplot with error bars</span>
<span class="n">x2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]</span>
<span class="n">y2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">17</span><span class="p">]</span>
<span class="n">err2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">bar</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">yerr</span> <span class="o">=</span> <span class="n">err2</span><span class="p">,</span> <span class="n">ecolor</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">)</span>

<span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;errorbars.png&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Result:</p>
<p><img alt="Error Bars" src="../img/managing_your_biological/errorbars.png" /></p>
<p><strong>Draw a pie chart with protruding slices</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">figure</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">pie</span><span class="p">,</span> <span class="n">savefig</span>

<span class="n">nucleotides</span> <span class="o">=</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;U&#39;</span>
<span class="n">count</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">759</span><span class="p">,</span> <span class="mi">606</span><span class="p">,</span> <span class="mi">398</span><span class="p">]</span>
<span class="n">explode</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]</span>

<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#f0f0f0&quot;</span><span class="p">,</span> <span class="s2">&quot;#dddddd&quot;</span><span class="p">,</span> <span class="s2">&quot;#bbbbbb&quot;</span><span class="p">,</span> <span class="s2">&quot;#999999&quot;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">get_percent</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Formats float values in pie slices to percent.&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%4.1f%%</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="s1">&#39;nucleotides in 23S RNA from T.thermophilus&#39;</span><span class="p">)</span>

<span class="n">pie</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">explode</span> <span class="o">=</span> <span class="n">explode</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">nucleotides</span><span class="p">,</span> <span class="n">shadow</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">colors</span><span class="p">,</span> <span class="n">autopct</span> <span class="o">=</span> <span class="n">get_percent</span><span class="p">)</span>

<span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;piechart.png&#39;</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="mi">150</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Result:</p>
<p><img alt="Pie Chart" src="../img/managing_your_biological/piechart.png" /></p>
<ul>
<li>It is possible to use math symbols, subscripts, and superscripts in the strings:<ul>
<li><code class="codehilite">xlabel(&#39;protein concentration [mM]&#39;)</code>.</li>
<li><code class="codehilite">xlabel(&#39;protein concentration [$\muM$]&#39;)</code>.</li>
</ul>
</li>
<li>It is possible to use placeholder for variables such as:<ul>
<li><code class="codehilite">&quot;4.1f%%&quot; % (variable)</code>.</li>
<li><code class="codehilite">&quot;2i%&quot; % (variable)</code>.</li>
<li>etc. </li>
<li>The <code class="codehilite"><span class="c">%%</span></code> stands for percentage.</li>
</ul>
</li>
<li>Change the image file resolution (dpi = 100 or 150 or 300 or 600) as in <code class="codehilite">savefig(&#39;chart.png&#39;, dpi=150)</code>.</li>
<li>Colors are based on the PIL library.</li>
<li>PIL has 140 colors (X11 color names) such as:<ul>
<li><code class="codehilite">&#39;red&#39;</code>, <code class="codehilite">&#39;lightred&#39;</code>, <code class="codehilite">&#39;magenta&#39;</code>, etc.</li>
<li>in RGB, red is <code class="codehilite">(255, 0, 0)</code>.</li>
<li>white is <code class="codehilite">(255, 255, 255)</code> or <code class="codehilite">&#39;#ffffff&#39;</code>.</li>
<li>&lsquo;black&rsquo; is <code class="codehilite">(0, 0, 0)</code> or <code class="codehilite">&#39;#000000&#39;</code>.</li>
<li>etc.</li>
</ul>
</li>
<li>The <a href="http://en.wikipedia.org/wiki/X11_color_names">X11 color names</a>.</li>
</ul>
<h4 id="chapter-18-manipulating-images">Chapter 18, Manipulating Images<a class="headerlink" href="#chapter-18-manipulating-images" title="Permanent link">&para;</a></h4>
<ul>
<li><code class="codehilite">Pillow</code> or <code class="codehilite">PIL</code> package.</li>
</ul>
<p><strong>Paste a small image into a big one</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;color.png&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;label.png&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="c1"># small legend</span>
<span class="n">image</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">460</span><span class="p">))</span>

<span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;combined.png&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Result:</p>
<p><img alt="Combined" src="../img/managing_your_biological/combined.png" /></p>
<p><strong>Resizes a big image to a small one</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;big.png&#39;</span><span class="p">)</span>
<span class="n">small</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>

<span class="n">small</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;small.png&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Result:</p>
<p><img alt="Small" src="../img/managing_your_biological/small.png" /></p>
<p><strong>Converts a color to a black/white image</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;color.png&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">bw_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;LA&#39;</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span>
<span class="n">bw_image</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

<span class="n">bw_image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;black_white.png&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Result:</p>
<p><img alt="Black &amp; White" src="../img/managing_your_biological/black_white.png" /></p>
<p><strong>Diminishes the size of all .png files by half</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.png&#39;</span><span class="p">):</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">small</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="n">small</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;small_&#39;</span><span class="o">+</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>For <code class="codehilite">os.listdir(&#39;.&#39;)</code>, consult <a href="#chapter-14,-building-program-pipelines,-command-line-in-python">Chapter 14, Building Program Pipelines, Command lines in Python</a>.</p>
<p><strong>Draw an image of a plasmid</strong></p>
<ul>
<li>Use constant variable: <code class="codehilite">PLASMID_LENGTH = 4361</code> is the total number of base pairs in the entire plastmid, <code class="codehilite">SIZE = (500, 500)</code> is the size of the entire image, <code class="codehilite">CENTER = (250, 250)</code> is the center point of the plasmid circle, the center of the image.</li>
<li>Create an image: <code class="codehilite">pBR322 = Image.new(&#39;RGB&#39;, SIZE, &#39;white&#39;)</code>. <code class="codehilite">&#39;RGB&#39;</code> color scheme, <code class="codehilite">SIZE = (x, y)</code> size in pixels, <code class="codehilite">&#39;white&#39;</code> set the background color.</li>
<li>Draw object <code class="codehilite">pBR322</code>: <code class="codehilite">DRAW = ImageDraw.Draw(pBR322)</code>.</li>
<li>The image object is now in object <code class="codehilite">DRAW</code>.</li>
<li>Finally, save the object: <code class="codehilite">pBR322.save(&#39;plasmid_pBR322.png&#39;)</code>.</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageDraw</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">PLASMID_LENGTH</span> <span class="o">=</span> <span class="mi">4361</span>
<span class="n">SIZE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">CENTER</span> <span class="o">=</span> <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>

<span class="n">pBR322</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="n">SIZE</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">DRAW</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">pBR322</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_angle</span><span class="p">(</span><span class="n">bp</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">PLASMID_LENGTH</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts base position into an angle.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">bp</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">/</span> <span class="n">length</span>

<span class="k">def</span> <span class="nf">coord</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return (x, y) coordinates of a point in a circle.&quot;&quot;&quot;</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="n">angle</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rad</span><span class="p">)</span> <span class="o">*</span> <span class="n">radius</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rad</span><span class="p">)</span> <span class="o">*</span> <span class="n">radius</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

<span class="k">def</span> <span class="nf">draw_arrow_tip</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Draws a triangle at the given start angle.&quot;&quot;&quot;</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">coord</span><span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">direction</span><span class="p">,</span> <span class="n">CENTER</span><span class="p">,</span> <span class="mi">185</span><span class="p">)</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">coord</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">CENTER</span><span class="p">,</span> <span class="mi">160</span><span class="p">)</span>
    <span class="n">p3</span> <span class="o">=</span> <span class="n">coord</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">CENTER</span><span class="p">,</span> <span class="mi">210</span><span class="p">)</span>
    <span class="n">DRAW</span><span class="o">.</span><span class="n">polygon</span><span class="p">((</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">),</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">color</span><span class="p">)</span>


<span class="n">TET_START</span><span class="p">,</span> <span class="n">TET_END</span> <span class="o">=</span> <span class="n">get_angle</span><span class="p">(</span><span class="mi">88</span><span class="p">),</span> <span class="n">get_angle</span><span class="p">(</span><span class="mi">1276</span><span class="p">)</span>
<span class="n">AMP_START</span><span class="p">,</span> <span class="n">AMP_END</span> <span class="o">=</span> <span class="n">get_angle</span><span class="p">(</span><span class="mi">3293</span><span class="p">),</span> <span class="n">get_angle</span><span class="p">(</span><span class="mi">4153</span><span class="p">)</span>
<span class="n">ORI_START</span><span class="p">,</span> <span class="n">ORI_END</span> <span class="o">=</span> <span class="n">get_angle</span><span class="p">(</span><span class="mi">2519</span><span class="p">),</span> <span class="n">get_angle</span><span class="p">(</span><span class="mi">3133</span><span class="p">)</span>

<span class="c1"># drawing the plasmid</span>
<span class="n">BOX</span> <span class="o">=</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="mi">450</span><span class="p">)</span>
<span class="n">DRAW</span><span class="o">.</span><span class="n">pieslice</span><span class="p">(</span><span class="n">BOX</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">DRAW</span><span class="o">.</span><span class="n">pieslice</span><span class="p">(</span><span class="n">BOX</span><span class="p">,</span> <span class="n">TET_START</span><span class="p">,</span> <span class="n">TET_END</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">DRAW</span><span class="o">.</span><span class="n">pieslice</span><span class="p">(</span><span class="n">BOX</span><span class="p">,</span> <span class="n">AMP_START</span><span class="p">,</span> <span class="n">AMP_END</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">DRAW</span><span class="o">.</span><span class="n">pieslice</span><span class="p">(</span><span class="n">BOX</span><span class="p">,</span> <span class="n">ORI_START</span><span class="p">,</span> <span class="n">ORI_END</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;darkmagenta&#39;</span><span class="p">)</span>
<span class="n">DRAW</span><span class="o">.</span><span class="n">pieslice</span><span class="p">((</span><span class="mi">80</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">420</span><span class="p">,</span> <span class="mi">420</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>

<span class="n">draw_arrow_tip</span><span class="p">(</span><span class="n">TET_END</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">draw_arrow_tip</span><span class="p">(</span><span class="n">AMP_START</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">draw_arrow_tip</span><span class="p">(</span><span class="n">ORI_START</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;darkmagenta&#39;</span><span class="p">)</span>

<span class="n">pBR322</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;plasmid_pBR322.png&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Result:</p>
<p><img alt="Plasmid" src="../img/managing_your_biological/plasmid_pBR322.png" /></p>
<p><strong>Drawings</strong></p>
<ul>
<li>Image extensions:<ul>
<li>BMP; simple table of pixels.</li>
<li>PNG; preserves the color of every single pixel; can be partially transparent.</li>
<li>GIF; can be animated; similar to PNG.</li>
<li>JPG; compressed format, blurred.</li>
<li>TIF; bigger and more precise than PNG.</li>
</ul>
</li>
<li><code class="codehilite">image = Image.open(&#39;color.png&#39;, &#39;r&#39;)</code>; read the object.</li>
<li>Write points:<ul>
<li><code class="codehilite">point = (100, 100)</code>; with tuples (x, y); x pixels from the left border, y pixels from the top of the image.</li>
</ul>
</li>
<li>Write rectangles<ul>
<li><code class="codehilite">BOX = (100, 100, 150, 150)</code>; with tuple (x, y, x&rsquo;, y&rsquo;); <code class="codehilite">BOX</code> becomes a constant.</li>
<li><code class="codehilite">DRAW.rectangle(BOX, fill = &#39;lightblue&#39;, outline = &#39;black&#39;)</code></li>
</ul>
</li>
<li>Draw circles inside &lsquo;guidelines&rsquo; or a rectangle:<ul>
<li><code class="codehilite">DRAW.pieslice((50, 50, 450, 450), 0, 360, fill = &#39;grey&#39;)</code>.</li>
<li><code class="codehilite">DRAW.pieslice((50, 50, 450, 450), 0, 360, fill = (0, 0, 0))</code>.</li>
<li><code class="codehilite">DRAW.pieslice((50, 50, 450, 450), 0, 360, fill = &#39;#ffffff&#39;)</code>.</li>
<li><code class="codehilite">BOX = (50, 50, 450, 450)</code><ul>
<li><code class="codehilite">DRAW.pieslice(BOX, 0, 360, fill = &#39;grey&#39;, outline = &#39;black&#39;)</code></li>
<li><code class="codehilite">DRAW.pieslice(BOX, 7, 106, fill = &#39;blue&#39;)</code></li>
</ul>
</li>
</ul>
</li>
<li>Draw an arc:<ul>
<li><code class="codehilite">DRAW.arc(BOX, 0, 360, fill = &#39;black&#39;)</code></li>
</ul>
</li>
<li>Draw a polygon:<ul>
<li><code class="codehilite">DRAW.polygon((point1, point2, point3) fill = &#39;lightblue&#39;, outline = &#39;blue&#39;)</code></li>
</ul>
</li>
<li>Draw a line:<ul>
<li><code class="codehilite">ECOR1 = angle(4359)</code></li>
<li><code class="codehilite">p1 = coord(ECOR1, CENTER, 160)</code></li>
<li><code class="codehilite">p1 = coord(ECOR1, CENTER, 210)</code></li>
<li><code class="codehilite">DRAW.line((p1, p2), fill = &#39;black&#39;, width = 3)</code></li>
</ul>
</li>
<li>Rotate the image:<ul>
<li><code class="codehilite">pBR322 = pBR322.rotate(45)</code></li>
</ul>
</li>
<li>Add text:<ul>
<li><code class="codehilite">DRAW.text((370, 240), &quot;EcoR1&quot;, fill = &quot;black&quot;)</code></li>
</ul>
</li>
</ul>
<p><strong>Draw an image of a plasmid and label it</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageDraw</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">PLASMID_LENGTH</span> <span class="o">=</span> <span class="mi">4361</span>
<span class="n">SIZE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">CENTER</span> <span class="o">=</span> <span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>

<span class="n">pBR322</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="n">SIZE</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">DRAW</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">pBR322</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_angle</span><span class="p">(</span><span class="n">bp</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">PLASMID_LENGTH</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Converts base position into an angle.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">bp</span> <span class="o">*</span> <span class="mi">360</span> <span class="o">/</span> <span class="n">length</span>

<span class="k">def</span> <span class="nf">coord</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return (x, y) coordinates of a point in a circle.&quot;&quot;&quot;</span>
    <span class="n">rad</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="n">angle</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">rad</span><span class="p">)</span> <span class="o">*</span> <span class="n">radius</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">rad</span><span class="p">)</span> <span class="o">*</span> <span class="n">radius</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>

<span class="k">def</span> <span class="nf">draw_arrow_tip</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">direction</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Draws a triangle at the given start angle.&quot;&quot;&quot;</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">coord</span><span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="n">direction</span><span class="p">,</span> <span class="n">CENTER</span><span class="p">,</span> <span class="mi">185</span><span class="p">)</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">coord</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">CENTER</span><span class="p">,</span> <span class="mi">160</span><span class="p">)</span>
    <span class="n">p3</span> <span class="o">=</span> <span class="n">coord</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">CENTER</span><span class="p">,</span> <span class="mi">210</span><span class="p">)</span>
    <span class="n">DRAW</span><span class="o">.</span><span class="n">polygon</span><span class="p">((</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">),</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">color</span><span class="p">)</span>


<span class="n">TET_START</span><span class="p">,</span> <span class="n">TET_END</span> <span class="o">=</span> <span class="n">get_angle</span><span class="p">(</span><span class="mi">88</span><span class="p">),</span> <span class="n">get_angle</span><span class="p">(</span><span class="mi">1276</span><span class="p">)</span>
<span class="n">AMP_START</span><span class="p">,</span> <span class="n">AMP_END</span> <span class="o">=</span> <span class="n">get_angle</span><span class="p">(</span><span class="mi">3293</span><span class="p">),</span> <span class="n">get_angle</span><span class="p">(</span><span class="mi">4153</span><span class="p">)</span>
<span class="n">ORI_START</span><span class="p">,</span> <span class="n">ORI_END</span> <span class="o">=</span> <span class="n">get_angle</span><span class="p">(</span><span class="mi">2519</span><span class="p">),</span> <span class="n">get_angle</span><span class="p">(</span><span class="mi">3133</span><span class="p">)</span>

<span class="c1"># drawing the plasmid</span>
<span class="n">BOX</span> <span class="o">=</span> <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="mi">450</span><span class="p">)</span>
<span class="n">DRAW</span><span class="o">.</span><span class="n">pieslice</span><span class="p">(</span><span class="n">BOX</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">DRAW</span><span class="o">.</span><span class="n">pieslice</span><span class="p">(</span><span class="n">BOX</span><span class="p">,</span> <span class="n">TET_START</span><span class="p">,</span> <span class="n">TET_END</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">DRAW</span><span class="o">.</span><span class="n">pieslice</span><span class="p">(</span><span class="n">BOX</span><span class="p">,</span> <span class="n">AMP_START</span><span class="p">,</span> <span class="n">AMP_END</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">DRAW</span><span class="o">.</span><span class="n">pieslice</span><span class="p">(</span><span class="n">BOX</span><span class="p">,</span> <span class="n">ORI_START</span><span class="p">,</span> <span class="n">ORI_END</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;darkmagenta&#39;</span><span class="p">)</span>
<span class="n">DRAW</span><span class="o">.</span><span class="n">pieslice</span><span class="p">((</span><span class="mi">80</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">420</span><span class="p">,</span> <span class="mi">420</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">)</span>

<span class="n">draw_arrow_tip</span><span class="p">(</span><span class="n">TET_END</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">draw_arrow_tip</span><span class="p">(</span><span class="n">AMP_START</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">draw_arrow_tip</span><span class="p">(</span><span class="n">ORI_START</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;darkmagenta&#39;</span><span class="p">)</span>

<span class="n">DRAW</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="mi">150</span><span class="p">,</span> <span class="mi">130</span><span class="p">),</span> <span class="s2">&quot;ori&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">DRAW</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="mi">340</span><span class="p">,</span> <span class="mi">130</span><span class="p">),</span> <span class="s2">&quot;amp&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">DRAW</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="mi">300</span><span class="p">,</span> <span class="mi">380</span><span class="p">),</span> <span class="s2">&quot;tet&quot;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

<span class="n">pBR322</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;plasmid_pBR322.png&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Result:</p>
<p><img alt="Plasmid" src="../img/managing_your_biological/plasmid_pBR322.png" /></p>
<h4 id="part-6-cookbook">Part 6, Cookbook<a class="headerlink" href="#part-6-cookbook" title="Permanent link">&para;</a></h4>
<h4 id="recipe-2-reversing-and-randomizing-a-sequence">Recipe 2, Reversing and Randomizing a Sequence<a class="headerlink" href="#recipe-2-reversing-and-randomizing-a-sequence" title="Permanent link">&para;</a></h4>
<p><sub>sort, reverse, random, probability, list, loop<sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">seq</span> <span class="o">=</span> <span class="s1">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span>
<span class="k">print</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>

<span class="n">seq_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
<span class="n">seq_list</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="n">rev_seq</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seq_list</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">rev_seq</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>

<span class="c1"># reverse a sequence, using a loop</span>
<span class="c1"># rev_seq = &#39;&#39;</span>
<span class="n">rev_seq</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
    <span class="n">rev_seq</span> <span class="o">=</span> <span class="n">rev_seq</span> <span class="o">+</span> <span class="n">s</span>
<span class="k">print</span><span class="p">(</span><span class="n">rev_seq</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>

<span class="c1"># reverse a sequence, using seq[start:end:step]</span>
<span class="n">rev_seq</span> <span class="o">=</span> <span class="n">seq</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">rev_seq</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>

<span class="c1"># mixing a sequence</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="n">ran_seq</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">ran_seq</span><span class="p">)</span>
<span class="n">ran_seq</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="n">ran_seq</span><span class="p">)</span>
<span class="n">ran_seq</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span><span class="o">-</span><span class="mi">10</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">ran_seq</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>

<span class="c1"># mixing a sequence (using random again)</span>
<span class="n">ran_seq</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span> \
 <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">))])</span>
<span class="k">print</span><span class="p">(</span><span class="n">ran_seq</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>

<span class="c1"># shuffle a sequence (using random again)</span>
<span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>
<span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">shuffled_seq</span> <span class="o">=</span> <span class="n">data</span>
<span class="k">print</span><span class="p">(</span><span class="n">shuffled_seq</span><span class="p">)</span>

<span class="n">shuffled_seq</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">shuffled_seq</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>Ouput:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>ABCDEFGHIJKLMNOPQRSTUVWXYZ
ZYXWVUTSRQPONMLKJIHGFEDCBA
=========================
ZYXWVUTSRQPONMLKJIHGFEDCBA
=========================
ABCDEFGHIJKLMNOPQRSTUVWXY
=========================
[&#39;F&#39;, &#39;J&#39;, &#39;I&#39;, &#39;L&#39;, &#39;O&#39;, &#39;R&#39;, &#39;U&#39;, &#39;C&#39;, &#39;A&#39;, &#39;V&#39;, &#39;Q&#39;, &#39;M&#39;, &#39;T&#39;, &#39;N&#39;, &#39;B&#39;, &#39;G&#39;, &#39;W&#39;, &#39;P&#39;, &#39;Y&#39;, &#39;H&#39;, &#39;D&#39;, &#39;S&#39;, &#39;Z&#39;, &#39;E&#39;, &#39;X&#39;, &#39;K&#39;]
LKAZHTVFGQROUXIMYWESDPCBJN
LXRDUVFHKGJZMIAB
=========================
RYYEYKWUGMYFYMUWWBOSZWSRMJ
=========================
[&#39;R&#39;, &#39;N&#39;, &#39;S&#39;, &#39;E&#39;, &#39;M&#39;, &#39;H&#39;, &#39;A&#39;, &#39;P&#39;, &#39;X&#39;, &#39;F&#39;, &#39;W&#39;, &#39;K&#39;, &#39;J&#39;, &#39;I&#39;, &#39;Y&#39;, &#39;T&#39;, &#39;Z&#39;, &#39;G&#39;, &#39;V&#39;, &#39;O&#39;, &#39;C&#39;, &#39;B&#39;, &#39;Q&#39;, &#39;D&#39;, &#39;L&#39;, &#39;U&#39;]
RNSEMHAPXFWKJIYTZGVOCBQDLU
</pre></div>
</td></tr></table>

<h4 id="recipe-3-creating-a-random-sequence-with-probabilities">Recipe 3, Creating a Random Sequence with Probabilities<a class="headerlink" href="#recipe-3-creating-a-random-sequence-with-probabilities" title="Permanent link">&para;</a></h4>
<p><sub>random, list, generate, probability</sub></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>

<span class="n">nucleotides</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ACGT&#39;</span><span class="p">)</span>
<span class="n">dna</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">dna</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
    <span class="n">dna</span> <span class="o">+=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">nucleotides</span><span class="p">)</span> <span class="c1"># choose amoung the list, fetch 1 item</span>
<span class="k">print</span><span class="p">(</span><span class="n">dna</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>

<span class="n">nucleotides</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ACGT&#39;</span><span class="p">)</span>
<span class="n">probs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">}</span> <span class="c1"># sum of 1.0</span>
<span class="k">assert</span> <span class="nb">sum</span><span class="p">(</span><span class="n">probs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">==</span> <span class="mf">1.0</span>
<span class="c1"># or</span>
<span class="c1"># if sum(probs.values()) != 1.0:</span>
<span class="c1">#   raise Exception(&#39;Sum of probabilites is not 1.0!&#39;)</span>

<span class="n">dna</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">dna</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
    <span class="n">nuc</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choi</span>
</pre></div>
</td></tr></table>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../Real_Python/" title="Real Python" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Real Python
              </span>
            </div>
          </a>
        
        
          <a href="../Python for Education/" title="Python for Education" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Python for Education
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            © Ugo Sparks
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.8eb9be28.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-93008985-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>